\documentclass[a4paper,10pt,twoside,openany]{book}

\usepackage[lang=hebrew]{maths}
\usepackage{hebrewdoc}
\usepackage{stylish}
\usepackage{lipsum}
\let\bs\blacksquare

\setlength{\parindent}{0pt}

%%%%%%%%%%%%
% Styling %
%%%%%%%%%%%%

\usepackage{enumitem}

%%%%%%%%%%%%%
% Counters  %
%%%%%%%%%%%%%

\setcounter{section}{1}     
            
%BIBLIOGRAPHY
\usepackage[
backend=biber,
style=alphabetic,
]{biblatex}
\addbibresource{bibliography.bib} %Imports bibliography file

\title{
\includegraphics[width=6in]{images/front.png}\\
\vspace{30pt}
\Huge
אלגברה ב' (104168)
\\
אביב 2024
\\
רשימות תרגולים
\vspace{30pt}
\\
\huge
אלן סורני
\vspace{30pt}
\\
\Large
הרשימות עודכנו לאחרונה בתאריך ה־%
\today
}
\date{}

\begin{document}
\frontmatter
\maketitle
\tableofcontents

\mainmatter

\section*{סימונים}

\begin{itemize}
\item[-]
$\brs{n} = \set{1, \ldots, n}$.
\item[-]
$\sum_{i \in \brs{n}} a_i = \sum_{i=1}^n a_i = a_1 + a_2 + \ldots + a_n$
\item[-] $\Mat_{m \times n}\prs{\mbb{F}}$ הוא מרחב המטריצות עם
$m$
שורות ו־%
$n$
עמודות, עם מקדמים בשדה
$\mbb{F}$.
\item[-]
$\mbb{F}^n = \Mat_{n \times 1}\prs{\mbb{F}}$
\item[-]
$\Mat_{n}\prs{\mbb{F}} = \Mat_{n \times n}\prs{\mbb{F}}$
\item[-]
$\hom_{\mbb{F}}\prs{V,W}$
הוא מרחב ההעתקות הלינאריות
$V \to W$
כאשר
$V,W$
מרחבים וקטוריים מעל
$\mbb{F}$.
\item[-]
$\End_{\mbb{F}}\prs{V} = \hom_{\mbb{F}}\prs{V,V}$
\end{itemize}

\part{חלק ראשון - מרחבים שמורים}

\chapter{מטריצות מייצגות}

\section{הגדרות בסיסיות}

\begin{definition}[וקטור קואורדינטות]
יהי
$V$
מרחב וקטורי סוף־מימדי מעל שדה
$\mbb{F}$,
יהי
$B = \prs{v_1, \ldots, v_n}$
בסיס של
$V$
ויהי
$v \in V$.
\emph{וקטור הקואורדינטות של
$v$
לפי הבסיס
$B$}
הוא הוקטור
$\brs{v}_B = \pmat{\alpha_1 \\ \vdots \\ \alpha_n}$
כאשר
$\alpha_1, \ldots, \alpha_n \in \mbb{F}$
היחידים עבורם
\[\text{.}v = \sum_{i \in [n]} \alpha_i v_i \coloneqq \alpha_1 v_1 + \ldots + \alpha_n v_n\]
\end{definition}

\begin{remark}
ההעתקה
\begin{align*}
\rho_B \colon V &\to \mbb{F}^n \\
v &\mapsto \brs{v}_B
\end{align*}
היא איזומורפיזם לינארי.
\end{remark}

\begin{definition}[מטריצה מייצגת]
יהיו
$V,W$
מרחבים וקטורים סוף־מימדיים מעל אותו שדה
$\mbb{F}$
עם בסיסים
$B,C$
בהתאמה, ונסמן
\[\text{.} B = \prs{v_1, \ldots, v_n}\]
נסמן גם
$n \coloneqq \dim\prs{V}$
ו־%
$m \coloneqq \dim\prs{W}$.
עבור
$T \in \Hom_{\mbb{F}}\prs{V,W}$
נגדיר
\[\text{.} \brs{T}^B_C = \pmat{\vert & & \vert \\ \brs{T\prs{v_1}}_C & \cdots & \brs{T\prs{v_n}}_C \\ \vert & & \vert} \in \Mat_{m \times n}\prs{\mbb{F}}\]
\end{definition}

\begin{theorem}[כפל מטריצות]
תהי
$A \in \Mat_{m \times n}\prs{\mbb{F}}$
ויהי
$E = \prs{e_1, \ldots, e_m}$
הבסיס הסטנדרטי של
$\mbb{F}^n$.
אז:
\begin{enumerate}[label = (\roman*)]
\item
לכל
$i \in [m]$
מתקיים כי
$A e_i$
העמודה ה־%
$i$
של
$A$.
\item
לכל
$B = \pmat{\vert & & \vert \\ b_1 & \cdots & b_\ell \\ \vert & & \vert} \in \Mat_{n \times \ell}\prs{\mbb{F}}$
מתקיים
$AB = \pmat{\vert & & \vert \\ A b_1 & \cdots & A b_\ell \\ \vert & & \vert}$.
\end{enumerate}
\end{theorem}

\begin{exercisechap}
הראו שניתן לשחזר את ההגדרה של כפל מטריצות משתי התכונות במשפט.
\end{exercisechap}

\begin{remark}
ההעתקה
\begin{align*}
\eta^B_C \colon \Hom_{\mbb{F}}\prs{V,B} &\to \Mat_{m \times n}\prs{\mbb{F}} \\
T &\mapsto \brs{T}^B_C
\end{align*}
היא איזומורפיזם לינארי.
\end{remark}

\begin{proposition}
תהי
$T \in \Hom_{\mbb{F}}\prs{V,W}$
ויהיו
$B = \prs{v_1, \ldots, v_n}$
בסיס של
$V$
ו־%
$C$
בסיס של
$W$.
אז
\[\brs{T}^B_C \brs{v}_B = \brs{T\prs{v}}_C\]
לכל
$v \in V$.
\end{proposition}

\pagebreak
\begin{proof}
עבור
$v = v_i$
מתקיים
$\brs{T}^B_C \brs{v_i}_B = \brs{T}^B_C e_i$
וזאת העמודה ה־%
$i$
של
$\brs{T}^B_C$,
שהינה
$\brs{T\prs{v_i}}_C$
לפי ההגדרה.

אם
$v = \sum_{i \in [n]} \alpha_i v_i$
נקבל מלינאריות של
$T$
ושל
$\rho_B$
כי
\begin{align*}
\brs{T\prs{v}}_C &= \brs{T\prs{\sum_{i \in [n]} \alpha_i v_i}}_C
\\&= \brs{\sum_{i \in [n]} \alpha_i T\prs{v_i}}_C
\\&= \sum_{i \in [n]} \alpha_i \brs{T\prs{v_i}}_C
\\&= \sum_{i \in [n]} \alpha_i \brs{T}^B_C \brs{v_i}_B
\\&= \brs{T}^B_C \prs{\sum_{i \in [n]} \alpha_i \brs{v_i}_B}
\\&= \brs{T}^B_C \brs{\sum_{i \in [n]} \alpha_i v_i}_B
\\\text{,} \hphantom{\brs{T\prs{v}}_C} &= \brs{T}^B_C \brs{v}_B
\end{align*}
כנדרש.
\end{proof}

\begin{notation}
אם
$B$
בסיס של מרחב וקטורי סוף־מימדי
$V$
ואם
$T \in \End\prs{V}$,
נסמן
$\brs{T}_B \coloneqq \brs{T}^B_B$
ונקרא למטריצה זאת
\emph{המטריצה המייצגת של
$T$
לפי הבסיס
$B$}.
\end{notation}

\begin{notation}
יהי
$V$
מרחב וקטורי סוף־מימדי עם בסיסים
$B,C$.
נסמן
$M^B_C \coloneqq \brs{\id_V}^B_C$.
\end{notation}

\begin{notation}
אם
$A \in \Mat_{n\times n}\prs{\mbb{F}}$,
נסמן
\begin{align*}
T_A \colon \mbb{F}^n &\to \mbb{F}^n \\
\text{.} \hphantom{lalala} v &\mapsto Av
\end{align*}
\end{notation}

\begin{exercisechap}\label{ex:p(x+1)}
יהי
$V = \mbb{R}_3\brs{x}$
מרחב הפולינום הממשיים ממעלה לכל היותר
$3$,
תהי
\begin{align*}
T \colon \mbb{R}_3\brs{x} &\to \mbb{R}_3\brs{x} \\
p\prs{x} &\mapsto p\prs{x+1}
\end{align*}
ויהי
$B = \prs{1,x,x^2,x^3}$
בסיס של
$V$.
כיתבו את
$\brs{T}_B$.
\end{exercisechap}

\begin{solution}
לפי הגדרת המטריצה המייצגת,
עמודות
$\brs{T}_B$
הן
$\brs{T\prs{x^i}}_B$
עבור
$i \in \set{0,1,2,3}$.
מתקיים
\begin{align*}
T\prs{1} &= 1 \\
T\prs{x} &= x+1 = 1 + x \\
T\prs{x^2} &= \prs{x+1}^2 = 1 + 2x + x^2 \\
T\prs{x^3} &= \prs{x+1}^3 = 1 + 3x + 3x^2 + x^3
\end{align*}
ולכן
\begin{align*}
\brs{T\prs{1}}_B &= e_1 \\
\brs{T\prs{x}}_B &= e_1 + e_2 \\
\brs{T\prs{x^2}}_B &= e_1 + 2 e_2 + e_3 \\
\brs{T\prs{x^3}}_B &= e_1 + 3 e_2 + 3 e_3 + e_4
\end{align*}
ואז
\begin{align*}
\text{.} \brs{T}_B &= \pmat{1 & 1 & 1 & 1 \\ 0 & 1 & 2 & 3 \\ 0 & 0 & 1 & 3 \\ 0 & 0 & 0 & 1}
\end{align*}
\end{solution}

\begin{exercisechap}
יהי
$V = \Mat_{2 \times 2}\prs{\mbb{C}}$,
תהי
\begin{align*}
T \colon V &\to V \\
A &\mapsto \frac{1}{2} \prs{A - A^t}
\end{align*}
ויהי
\[E = \prs{E_{1,1}, E_{1,2}, E_{2,1}, E_{2,2}} \coloneqq \pmat{\pmat{1 & 0 \\ 0 & 0}, \pmat{0 & 1 \\ 0 & 0}, \pmat{0 & 0 \\ 1 & 0}, \pmat{0 & 0 \\ 0 & 1}}\]
\emph{הבסיס הסטנדרטי של
$V$}.
כיתבו את
$\brs{T}_E$.
\end{exercisechap}

\begin{proof}
כמו מקודם, נחשב את
$\brs{T\prs{E_{i,j}}}_E$
כיוון שאלו עמודות
$\brs{T}_E$.
מתקיים
\begin{align*}
T\prs{E_{1,1}} &= \frac{1}{2} \prs{E_{1,1} - E_{1,1}} = 0 \\
T\prs{E_{1,2}} &= \frac{1}{2} \prs{\pmat{0 & 1 \\ 0 & 0} - \pmat{0 & 0 \\ 1 & 0}} = \frac{1}{2} E_{1,2} - \frac{1}{2} E_{2,1} \\
T\prs{E_{2,1}} &= \frac{1}{2} \prs{E_{2,1} - E_{1,2}} = \frac{1}{2} E_{2,1} - \frac{1}{2} E_{1,2} \\
\text{,} T\prs{E_{2,2}} &= \frac{1}{2} \prs{E_{2,2} - E_{2,2}} = 0 \\
\end{align*}
לכן
\begin{align*}
\brs{T\prs{E_{1,1}}}_E &= 0 \\
\brs{T\prs{E_{1,2}}}_E &= \frac{1}{2} e_2 - \frac{1}{2} e_3 \\
\brs{T\prs{E_{2,1}}}_E &= -\frac{1}{2} e_2 + \frac{1}{2} e_3 \\
\brs{T\prs{E_{2,2}}}_E &= 0
\end{align*}
ואז
\begin{align*}
\text{,} \brs{T}_E &= \pmat{0 & 0 & 0 & 0 \\ 0 & \frac{1}{2} & -\frac{1}{2} & 0 \\ 0 & -\frac{1}{2} & \frac{1}{2} & 0 \\ 0 & 0 & 0 & 0}
\end{align*}
כנדרש.
\end{proof}

\begin{exercisechap}
יהי
$V = \Hom_{\mbb{R}}\prs{\mbb{R}^2, \mbb{R}}$
עם הבסיס
$B = \prs{f_1, f_2}$
כאשר
\begin{align*}
f_1\prs{\pmat{x \\ y}} &= x \\
\text{,} f_2\prs{\pmat{x \\ y}} &= y
\end{align*}
ותהי
\begin{align*}
\text{.} A &= \pmat{1 & 2 \\ 3 & 4} \in \Mat_{2 \times 2}\prs{\mbb{R}}
\end{align*}
מיצאו
$T \in \End_{\mbb{R}}\prs{V}$
עבורו
$\brs{T}_B = A$.
\end{exercisechap}

\begin{solution}
עבור
$T \in \End_{\mbb{R}}\prs{V}$
מתקיים
\[\text{.} \brs{T}_B = \pmat{\vert & \vert \\ \brs{T\prs{f_1}}_B & \brs{T\prs{f_2}}_B \\ \vert & \vert}\]
לכן נדרוש
\begin{align*}
\brs{T\prs{f_1}}_B &= \pmat{1 \\ 2} \\
\text{.} \brs{T\prs{f_2}}_B &= \pmat{3 \\ 4}
\end{align*}
אז
\begin{align*}
T\prs{f_1} &= f_1 + 2 f_2 \\
\text{.} T\prs{f_2} &= 3 f_1 + 4 f_2
\end{align*}
לכן, אם
$f \in V$
איבר כללי, נכתוב
\[f\pmat{x\\y} = \alpha x + \beta y = \alpha f_1 \pmat{x \\ y} + \beta f_2\pmat{x \\ y}\]
ונקבל כי
\begin{align*}
\prs{T\prs{f}}\pmat{x\\y} &= \prs{T\prs{\alpha f_1 + \beta f_2}}\pmat{x\\y}
\\&= \alpha T\prs{f_1}\pmat{x\\y} + \beta T\prs{f_2} \pmat{x\\y}
\\&= \alpha \prs{f_1 + 2 f_2}\pmat{x\\y} + \beta \prs{3 f_1 + 4 f_2} \pmat{x\\y}
\\ \text{.} \hphantom{\prs{T\prs{f}}\pmat{x\\y}} &= \alpha \prs{x + 2 y} + \beta \prs{3 x + 4y}
\end{align*}
\end{solution}

\begin{proposition}
תהיינה
$A,B \in \Mat_{m \times n}\prs{\mbb{F}}$
ונניח כי לכל
$v \in \mbb{F}^n$
מתקיים
$Av = Bv$.
אז
$A = B$.
\end{proposition}

\begin{proof}
מהנתון, מתקיים
$\prs{A - B}v = 0$
לכל
$v \in \mbb{F}^n$.
בפרט העמודה ה־%
$i$
של
$A-B$,
שהינה
$\prs{A - B}e_i$,
שווה ל־%
$0$.
לכן
$A - B = 0$.
\end{proof}

\begin{proposition}
יהיו
$U,V,W$
מרחבים וקטוריים סוף־מימדיים מעל אותו שדה
$\mbb{F}$
עם בסיסים
$B,C,D$
בהתאמה,
ותהיינה
\begin{align*}
S \in \Hom_{\mbb{F}}\prs{U,V} \\
\text{.} T \in \Hom_{\mbb{F}}\prs{V,W}
\end{align*}
אז
\[\text{.} \brs{T \circ S}^B_D = \brs{T}^C_D \brs{S}^B_C\]
\end{proposition}

\begin{proof}
לכל
$u \in U$
מתקיים
\begin{align*}
\brs{T}^C_D \brs{S}^B_C \brs{u}_B &= \brs{T}^C_D \brs{S\prs{u}}_C
\\&= \brs{T \circ S \prs{u}}_D
\\&= \brs{T \circ S}^B_D \brs{u}_B
\end{align*}
לכן
\[\text{,} \brs{T}^C_D \brs{S}^B_C = \brs{T \circ S}^B_D\]
כנדרש.
\end{proof}

\begin{proposition} \label{proposition:change-of-basis-through-isomorphism}
יהיו
$V,W$
מרחבים וקטוריים סוף־מימדיים מעל שדה
$\mbb{F}$
ותהי
$T \in \Hom_{\mbb{F}}\prs{V,W}$
חד־חד ערכית.

יהיו
\begin{align*}
B &= \prs{v_1, \ldots, v_n} \\
C &= \prs{u_1, \ldots, u_n}
\end{align*}
בסיסים של
$V$
ויהיו
\begin{align*}
B' &= \prs{T\prs{v_1}, \ldots, T\prs{v_n}} \\
\text{.} C' &= \prs{T\prs{u_1}, \ldots, T\prs{u_n}}
\end{align*}
אז
$B',C'$
בסיסים של
$\im\prs{T} = \set{T\prs{v}}{v \in V}$
וגם
$M^B_C = M^{B'}_{C'}$.
\end{proposition}

\begin{solution}
כיוון ש־%
$T$
חד־חד ערכית ועל התמונה, צמצום הטווח נותן איזומורפיזם
$T \colon V \riso \im\prs{T}$.
איזומורפיזם שולח בסיס לבסיס, לכן
$B',C'$
בסיסים.

כעת, לכל
$i \in [n]$
נכתוב
\begin{align*}
v_i &= \sum_{j \in \brs{n}} \alpha_{i,j} u_i
\end{align*}
ואז
\begin{align*}
\text{.} M^B_C e_i = \brs{v_i}_C = \pmat{\alpha_{i,1} \\ \vdots \\ \alpha_{i,n}}
\end{align*}
כמו כן,
\begin{align*}
T\prs{v_i}
&=
T\prs{\sum_{i \in [n]} \alpha_{i,j} u_j}
\\&=
\sum_{i \in [n]} \alpha_{i,j} T\prs{u_j}
\end{align*}
ולכן גם
\[\text{.} M^{B'}_{C'} e_i = \brs{T\prs{v_i}}_{C'} = \pmat{\alpha_{i,1} \\ \vdots \\ \alpha_{i,n}}\]
קיבלנו כי כל עמודות המטריצות שוות, ולכן יש שוויון.
\end{solution}

\begin{exercisechap}
תהי
$A \in \Mat_{n \times n}\prs{\mbb{F}}$
הפיכה.
\begin{enumerate}
\item יהי
$E$
הבסיס הסטנדרטי של
$\mbb{F}^n$.
מיצאו בסיס
$B$
של
$\mbb{F}^n$
עבורו
$A = M^B_E$.

\item
מיצאו בסיס
$C$
של
$\mbb{F}^n$
עבורו
$A = M^E_C$.

\item
יהי
$B$
בסיס של
$\mbb{F}^n$.
מיצאו בסיס
$C$
של
$\mbb{F}^n$
עבורו
$A = M^B_C$.

\item
יהי
$V$
מרחב וקטורי ממימד
$n \in \mbb{N}_+$
מעל
$\mbb{F}$,
יהי
$T \in \End_{\mbb{F}}\prs{V}$
איזומורפיזם
ויהי
$B = \prs{v_1, \ldots, v_n}$
בסיס של
$V$.
מיצאו בסיס
$C$
של
$V$
עבורו
$\brs{T}^B_C = A$.
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
\item
אם
$B = \prs{v_1, \ldots, v_n}$,
מתקיים מההגדרה כי
\[\text{.} M^B_E = \pmat{\vert & & \vert \\ \brs{v_1}_E & \cdots & \brs{v_n}_E \\ \vert & & \vert} = \pmat{\vert & & \vert \\ v_1 & \cdots & v_n \\ \vert & & \vert}\]
לכן ניקח את
$\prs{v_1, \ldots, v_n}$
להיות עמודות
$A$,
לפי הסדר.

\item
לכל
$v \in \mbb{F}^n$
מתקיים
\[M^C_E M^E_C v = M^C_E \brs{v}_C = \brs{v}_E = v\]
ולכן
$M^E_C = \prs{M^C_E}^{-1}$.
אם ניקח
$C = \prs{u_1, \ldots, u_n}$
כאשר
$u_i$
העמודה ה־%
$i$
של
$A^{-1}$
נקבל מהסעיף הקודם כי
$M^C_E = A^{-1}$
ולכן
$M^E_C = \prs{A^{-1}}^{-1} = A$.
כלומר ניקח,
$u_i = A^{-1} e_i$.

\item
מתקיים
$M^B_C = M^E_C M^B_E$
לכן נרצה שיתקיים
$M^E_C M^B_E = A$
או במילים אחרות
$M^E_C = A \prs{M^B_E}^{-1} = A M^E_B$.
מהסעיף הקודם, נרצה
$C = \prs{u_1, \ldots, u_n}$
כאשר
$u_i$
העמודה ה־%
$i$
של
$\prs{A M^E_B}^{-1} = M^B_E A^{-1}$,
כלומר
\[\text{.} u_i = M^B_E A^{-1} e_i\]

\item
עבור כל בסיס
$C'$
מתקיים
$\brs{T}^B_{C'} = M^B_{C'} \brs{T}^B_B$
לכן נרצה
$M^B_C \brs{T}^B_B = A$.
כיוון ש־%
$T$
איזומורפיזם, המטריצה
$\brs{T}^B_B$
הפיכה, ולכן נרצה
$M^B_C = A \prs{\brs{T}^B_B}^{-1}$.
כעת, אם
$C = \prs{v_1, \ldots, v_n}$
נקבל לפי
\ref{proposition:change-of-basis-through-isomorphism}
עבור האיזומורפיזם
$\rho_B$
כי
$M^B_C = M^E_{\hat{C}}$
כאשר
$\hat{C} = \prs{\brs{v_1}_B, \ldots, \brs{v_n}_B}$.
לכן נחפש
$\hat{C}$
עבורו
$M^E_{\hat{C}} = A \brs{T}_B^{-1}$.
לפי הסעיף השני, נרצה
$\hat{C} = \prs{u_1, \ldots, u_n}$
עבור
\[\text{.} u_i = \prs{A \brs{T}_B^{-1}}^{-1} e_i = \brs{T}_B A^{-1} e_i\]
לכן
\[\text{.} v_i = \rho_B^{-1} \prs{\brs{T}_B A^{-1} e_i}\]
\end{enumerate}
\end{solution}

\begin{exercisechap}
יהי
$V = \mbb{C}_3\brs{x}$,
תהי
\begin{align*}
T \colon V &\to V \\
\text{,} \hphantom{lalala} p\prs{x} &\mapsto p\prs{x+1}
\end{align*}
יהי
$E = \pmat{1,x,x^2,x^3}$,
\emph{הבסיס הסטנדרטי}
ותהי
$A = \pmat{0 & 1 & 0 & 0 \\ 1 & 0 & 0 & 0 \\ 0 & 0 & 0 & 1 \\ 0 & 0 & 1 & 0}$.
כיתבו מפורשות בסיס
$C$
של
$V$
עבורו
$A = \brs{T}^E_C$.
\end{exercisechap}

\begin{solution}
לפי התרגיל הקודם, נרצה קודם
$\hat{C} = \prs{u_1, \ldots, u_4}$
כאשר
$u_i = \brs{T}_E A^{-1} e_i$.
חישבנו ב־%
\ref{ex:p(x+1)}
כי
\[\brs{T}_E = \pmat{1 & 1 & 1 & 1 \\ 0 & 1 & 2 & 3 \\ 0 & 0 & 1 & 3 \\ 0 & 0 & 0 & 1}\]
וניתן לראות כי
$A^2 = I$
כלומר
$A^{-1} = A$.
נשים לב כי
\begin{align*}
A e_1 &= e_2 \\
A e_2 &= e_1 \\
A e_3 &= e_4 \\
A e_4 &= e_3
\end{align*}
ואז נקבל
\begin{align*}
u_1 &= \brs{T}_E A^{-1} e_1 = \brs{T}_E e_2 = \pmat{1 \\ 1 \\ 0 \\ 0} \\
u_2 &= \brs{T}_E A^{-1} e_2 = \brs{T}_E e_1 = \pmat{1 \\ 0 \\ 0 \\ 0} \\
u_3 &= \brs{T}_E A^{-1} e_3 = \brs{T}_E e_4 = \pmat{1 \\ 3 \\ 3 \\ 1} \\
\text{,} u_4 &= \brs{T}_E A^{-1} e_4 = \brs{T}_E e_3 = \pmat{1 \\ 2 \\ 1 \\ 0}
\end{align*}
כלומר
\[\text{,} \hat{C} = \prs{\pmat{1 \\ 1 \\ 0 \\ 0}, \pmat{1 \\ 0 \\ 0 \\ 0}, \pmat{1 \\ 3 \\ 3 \\ 1}, \pmat{1 \\ 2 \\ 1 \\ 0}}\]
ולבסוף
\[\text{.} C = \prs{v_1, v_2, v_3, v_4} \coloneqq \prs{1+x, 1, 1+3x+3x^2+x^3, 1+2x+x^2}\]

ליתר ביטחון, נבדוק שהמטריצה המייצגת היא אכן
$A$.
מתקיים
\begin{align*}
T\prs{1} &= 1 = v_2 \\
T\prs{x} &= x+1 = v_1 \\
T\prs{x^2} &= \prs{x+1}^2 = 1+2x+x^2 = v_4 \\
T\prs{x^3} &= \prs{x+1}^3 = 1+3x+3x^2+x^3 = v_3
\end{align*}
ולכן
\begin{align*}
\brs{T}^E_C &= \pmat{\vert & \vert & \vert & \vert \\ \brs{T\prs{1}}_C & \brs{T\prs{x}}_C & \brs{T\prs{x^2}}_C & \brs{T\prs{x^3}}_C \\ \vert & \vert & \vert & \vert}
\\&= \pmat{\vert & \vert & \vert & \vert \\ \brs{v_2}_C & \brs{v_1}_C & \brs{v_4}_C & \brs{v_3}_C \\ \vert & \vert & \vert & \vert}
\\&= \pmat{\vert & \vert & \vert & \vert \\ e_2 & e_1 & e_4 & e_3 \\ \vert & \vert & \vert & \vert}
\\&= A
\end{align*}
כנדרש.
\end{solution}

\section{גרעין ותמונה}

\begin{definition}[גרעין של העתקה לינארית]
יהיו
$V,W$
מרחבים וקטורים מעל אותו שדה ותהי
$T \in \Hom\prs{V,W}$.
\emph{הגרעין של
$T$}
הוא
\[\text{.} \ker\prs{T} \coloneqq \set{v \in V}{T\prs{v} = 0}\]
\end{definition}

\begin{definition}[תמונה של העתקה לינארית]
יהיו
$V,W$
מרחבים וקטורים מעל אותו שדה ותהי
$T \in \Hom\prs{V,W}$.
\emph{התמונה של
$T$}
היא
\[\text{.} \im\prs{T} \coloneqq \set{T\prs{v}}{v \in V}\]
\end{definition}

\begin{definition}[דרגה של אופרטור לינארי]
יהיו
$V,W$
מרחבים וקטורים מעל אותו שדה ותהי
$T \in \Hom\prs{V,W}$.
\emph{הדרגה של
$T$}
היא
\[\text{.} \rank\prs{T} \coloneqq \dim \prs{\im\prs{T}}\]
\end{definition}

\begin{remark}
אם
$V,W$
סוף־מימדיים עם בסיסים
$B,C$
בהתאמה, אז
\[\text{.} \rank\prs{T} = \rank\prs{\brs{T}^B_C}\]
\end{remark}

\begin{theorem}[משפט המימדים]
יהי
$V$
מרחב וקטורי סוף־מימדי ויהי
$T \in \End\prs{V}$.
אז
\[\text{.} \dim V = \dim \im\prs{T} + \dim \ker\prs{T}\]
\end{theorem}

\begin{exercisechap}
יהי
$V$
מרחב וקטורי סוף־מימדי ויהי
$v \in V$.
מיצאו בסיס
$B$
של
$V$
עבורו
$\brs{v}_B = \pmat{1 \\ \vdots \\ 1}$.
\end{exercisechap}

\begin{solution}
נשלים את
$\prs{v}$
לבסיס
$B_0 = \prs{v_1, \ldots, v_n}$
של
$V$
כאשר
$v_1 = v$.
תהי
\begin{align*}
\text{.} A \ceq \pmat{1 & & & & \\
1 & 1 & & 0 & \\
\vdots & & \ddots & & \\
1 & & & 1 & \\
1 & 0 & \cdots & 0 & 1} \in \Mat_n\prs{\mbb{F}}
\end{align*}
$A$
הפיכה, ולכן מתרגיל קודם קיים בסיס
$B = \prs{u_1, \ldots, u_n}$
של
$V$
עבורו
$M^{B_0}_B = A$.
נקבל
\begin{align*}
\brs{v}_B &= \brs{\id_V v}_B
\\&=
\brs{\id_V}^{B_0}_{B} \brs{v}_{B_0}
\\&= A \pmat{1 \\ 0 \\ \vdots \\ 0}
\\ \text{.} \hphantom{\brs{v}_B} &= \pmat{1 \\ \vdots \\ 1}
\end{align*}
מפורשות, ראינו כי ניתן לקחת
\[\text{.} u_i = \rho_{B_0}^{-1}\prs{\brs{\id}_B A^{-1} e_i} = \rho_{B_0}^{-1}\prs{A^{-1}e_i}\]
\end{solution}

\begin{exercisechap}
יהי
$V$
מרחב וקטורי סוף־מימדי מעל שדה
$\mbb{F}$,
ותהי
$T \in \End_{\mbb{F}}\prs{V}$.
הראו כי
$\rank T = 1$
אם ורק אם יש בסיסים
$B,C$
ל־%
$V$
כך שכל מקדמי
$\brs{T}^B_C$
הם
$1$.
\end{exercisechap}

\begin{solution}
נניח כי יש בסיסים
$B,C$
כמתואר. אז
$\rank T = \rank \brs{T}^B_C = 1$.

בכיוון השני, נניח כי
$\rank T = 1$.
כלומר,
$\dim \im T = 1$.
ממשפט המימדים מתקיים
$\dim V = \dim \ker T + \dim \im T$,
לכן
\[\text{.} \dim \ker T = \dim V - \dim \im T = \dim V - 1\]
יהי
$n \ceq \dim V$
ויהי
\[\tilde{B} \ceq \prs{u_1, \ldots, u_{n-1}}\]
בסיס של
$\ker T$.

יהי
$w$
וקטור פורש של
$\im T$
ויהי
$C$
בסיס של
$V$
כך שמתקיים
$\brs{w}_C = \pmat{1 \\ \vdots \\ 1}$,
שקיים לפי התרגיל הקודם.
יהי
$v \ceq T^{-1}\prs{w}$,
ואז
$\prs{v, u_1, \ldots, u_{n-1}}$
בלתי־תלויים לינארית, כי
$v \notin \ker T$.
לכן זה בסיס של
$V$.
אז גם
$B \ceq \prs{v, v + u_1, \ldots, v + u_{n-1}}$
בסיס של
$V$
כי
המטריצה
\[\pmat{\vert & & \vert \\ \brs{v}_{\tilde{B}} & \cdots & \brs{v + u_{n-1}}_{\tilde{B}} \\ \vert & & \vert} = \pmat{1 & 1 & \cdots & 1 & 1 \\ 0 & 1 & & 0 & 0 \\ \vdots & & \ddots & & \vdots \\& 0 & & 1 & 0 \\
0 & & \cdots & 0 & 1}\]
הפיכה.

נסמן
$C = \prs{w_1, \ldots, w_m}$.
מתקיים
\[T\prs{v} = w = w_1 + \ldots + w_m\]
ולכל
$i \in [n-1]$
מתקיים
\begin{align*}
T \prs{v + u_i} &= T\prs{v} + T\prs{u_i}
\\&= T\prs{v} + 0
\\&= T\prs{v}
\\&= w_1 + \ldots + w_m
\end{align*}
לכן
$
\brs{T}^B_C
$
מטריצה שכל מקדמיה הם
$1$.
\end{solution}

\begin{exercisechap}
תהי
\begin{align*}
T \colon \mbb{R}_3\brs{x} &\to \mbb{R}_3\brs{x} \\
\text{.} p\prs{x} &\mapsto p\prs{-1}
\end{align*}
מיצאו בסיסים
$B,C$
של
$\mbb{R}_3\brs{x}$
עבורם
\[\text{.} \brs{T}^B_C = A \coloneqq \pmat{1 & 1 & 1 & 1 \\ 1 & 1 & 1 & 1 \\ 1 & 1 & 1 & 1 \\ 1 & 1 & 1 & 1}\]
\end{exercisechap}

\begin{solution}
ניקח בסיס
$\tilde{B} = \prs{b_1, b_2, b_3} \coloneqq \prs{x + 1, x^2 - 1, x^3 + 1}$
של
$\ker\prs{T}$,
כאשר זהו בסיס כי זאת קבוצה בלתי־תלוייה לינארית מגודל מקסימלי (הגרעין לכל היותר $3$ מימדי כי
$T \neq 0$).
מתקיים
$w \coloneqq -1 = T\prs{x}$
ואז
$\im\prs{T} = \Span_{\mbb{R}}\prs{w}$.
נחשב בסיס
$C$
עבורו
$\brs{w}_C = \pmat{1 \\ 1 \\ 1 \\ 1}$.
נשלים את
$\prs{v}$
לבסיס
\[\text{.} C_0 = \prs{v_1,v_2,v_3,v_4} \coloneqq \prs{-1,x,x^2,x^3}\]
המטריצה
\[X = \pmat{1 & 0 & 0 & 0 \\ 1 & 1 & 0 & 0 \\ 1 & 0 & 1 & 0 \\ 1 & 0 & 0 & 1}\]
הפיכה ולכן קיים בסיס
$C = \prs{u_1, u_2, u_3, u_4}$
עבורו
$M^{C_0}_C = X$,
כשראינו שאז
$\brs{w}_C = \pmat{1\\1\\1\\1}$.
כפי שראינו, ניתן לחשב את
$C$
לפי
$u_i = \rho_{C_0}^{-1}\prs{X^{-1} e_i}$.
מתקיים
\[X^{-1} = \pmat{1 & 0 & 0 & 0 \\ -1 & 1 & 0 & 0 \\ -1 & 0 & 1 & 0 \\ -1 & 0 & 0 & 1}\]
ולכן
\begin{align*}
u_1 &= \rho_{C_0}^{-1} \prs{\pmat{1 \\ -1 \\ -1 \\ -1}} = -1 -x - x^2 - x^3 \\
u_2 &= \rho_{C_0}^{-1} \prs{\pmat{0\\1\\0\\0}} = x \\
u_3 &= \rho_{C_0}^{-1} \prs{\pmat{0\\0\\1\\0}} = x^2 \\
\text{.} u_4 &= \rho_{C_0}^{-1} \prs{\pmat{0\\0\\0\\1}} = x^3
\end{align*}
כלומר,
$C = \prs{-1-x-x^2-x^3, x, x^2, x^3}$.

ניקח
$v = x \in V$
כך שיתקיים
$T\prs{v} = -1 = w$
ואז
\[B = \prs{v, v+b_1, v+b_2, v+b_3} = \prs{x, 2x+1, x^2+x-1, x^3 + x + 1}\]
כמו בתרגיל הקודם.

אכן, מתקיים
\begin{align*}
T\prs{x} &= -1 \\
T\prs{2x+1} &= -2 + 1 = -1 \\
T\prs{x^2 + x - 1} &= \prs{-1}^2 -1 - 1 = 1 - 2 = -1 \\
T\prs{x^3 + x + 1} &= \prs{-1}^3 -1 +1 = -1
\end{align*}
וגם
$\brs{-1}_C = \pmat{1 \\ 1 \\ 1 \\ 1}$,
לכן
\[\text{,} \brs{T}^B_C = \pmat{1 & 1 & 1 & 1 \\ 1 & 1 & 1 & 1 \\ 1 & 1 & 1 & 1 \\ 1 & 1 & 1 & 1}\]
כפי שרצינו.
\end{solution}

\chapter{סכומים ישרים, הדטרמיננטה ולכסינות}

\section{סכומים ישרים}

\begin{definition}[סכום ישר]
יהי
$V$
מרחב וקטורי סוף־מימדי מעל
$\mbb{F}$
ויהיו
$V_1, \ldots, V_k \leq V$
תת־מרחבים.
נזכיר כי
\begin{align*}
\text{.} V_1 + \ldots + V_k \coloneqq \set{v_1 + \ldots + v_k}{\forall i \in [k] \colon v_i \in V_i}
\end{align*}
נגיד שהסכום הזה הוא
\emph{סכום ישר}
אם כל
$v \in V_1 + \ldots + V_k$
ניתן לכתיבה
$v = v_1 + \ldots + v_k$
\emph{בצורה יחידה}
עבור
$v_i \in V_i$.
במקרה זה נסמן את הסכום
$\bigoplus_{i \in [k]} V_i = V_1 \oplus \ldots \oplus V_k$.
\end{definition}

\begin{remark}
באופן שקול, הסכום
$V_1 + \ldots + V_k$
ישר אם ורק אם
$v_1 + \ldots + v_k = 0$
עבור
$v_i \in V_i$
גורר
$v_i = 0$
לכל
$i \in [k]$.
\end{remark}

\begin{proposition}
הסכום
$\sum_{i \in [k]} V_i \coloneqq V_1 + \ldots + V_k$
ישר אם ורק אם
\[V_i \cap \prs{\sum_{j \neq i} V_j} = \set{0}\]
לכל
$i \in [k]$.

את המקרה
$k = 2$
ראינו בהרצאה, והטענה הכללית נובעת באינדוקציה.
\end{proposition}

\begin{definition}[שרשור קבוצות סדורות]
תהיינה
\begin{align*}
A_1 &= \prs{v_{1,1}, \ldots, v_{1, \ell_1}} \\
A_2 &= \prs{v_{2,1}, \ldots, v_{2, \ell_2}} \\
&\vdots \\
A_k &= \prs{v_{k,1}, \ldots, v_{k, \ell_k}}
\end{align*}
קבוצות סדורות.
נגדיר את
\emph{השרשור שלהן}
\begin{align*}
\text{.} A_1 \cup \ldots \cup A_k \coloneqq \prs{v_{1,1}, \ldots, v_{1,\ell_1}, v_{2,1}, \ldots, v_{2,\ell_2}, \ldots, v_{k,1}, \ldots, v_{k,\ell_k}}
\end{align*}
זאת הקבוצה הסדורה שהיא שרשור איברי הקבוצות הסדורות
$A_1, \ldots, A_k$
לפי הסדר.
\end{definition}

\begin{proposition}
יהי
$V$
מרחב וקטורי סוף־מימדי ויהיו
$V_1, \ldots, V_k$
תת־מרחבים של
$V$.
התנאים הבאים שקולים.
\begin{enumerate}
\item $V = V_1 \oplus \ldots \oplus V_k$.
\item לכל בחירת בסיסים
$B_i$
של
$V_i$
הקבוצה הסדורה
$B_1 \cup \ldots \cup B_k$
היא בסיס של
$V$.
\item קיימים בסיסים
$B_i$
של
$V_i$
כך שהקבוצה הסדורה
$B_1 \cup \ldots \cup B_k$
היא בסיס של
$V$.
\item $V = \sum_{i \in [k]} V_i$
וגם
\[\text{.} \dim V = \sum_{i \in [k]} \dim\prs{V_i}\]
\end{enumerate}
\end{proposition}

\newpage

\begin{exercisechap}
יהי
$V$
מרחב וקטורי סוף־מימדי מעל שדה
$\mbb{F}$,
ונזכיר כי
$P \in \End_{\mbb{F}}\prs{V}$
נקראת
\emph{הטלה}
אם
$P^2 = P$.

\begin{enumerate}
\item תהי
$P \in \End_{\mbb{F}}\prs{V}$
הטלה. הראו כי
$V = \ker\prs{P} \oplus \im\prs{P}$.

\item הראו כי
$T \in \End_{\mbb{F}}\prs{V}$
הטלה אם ורק אם קיים בסיס
$B$
של
$V$
עבורו
\[\text{.} \brs{T}_B = \pmat{0 & & & & & \\ & \ddots & & & & \\ & & 0 & & & \\ & & & 1 & & \\ & & & & \ddots & \\ & & & & & 1}\] 
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
\item יהי
$v \in V$.
מתקיים
$v = \prs{v - P\prs{v}} + P\prs{v}$
כאשר
$P\prs{v} \in \im\prs{P}$.
כמו כן,
\[P\prs{v - P\prs{v}} = P\prs{v} - P^2\prs{v} = P\prs{v} - P\prs{v} = 0\]
ולכן
$v- P\prs{v} \in \ker\prs{P}$
ונקבל כי
$V = \ker\prs{P} + \im\prs{P}$.

כעת, אם
$v \in \ker\prs{P} \cap \im\prs{P}$
בפרט
$v \in \im\prs{P}$
ולכן יש
$u \in V$
עבורו
$P\prs{u} = v$.
אז
\[v = P\prs{u} = P^2\prs{u} = P\prs{P\prs{u}} = P\prs{v} = 0\]
ולכן
$\ker\prs{P} \cap \im\prs{P} = 0$
ונקבל כי הסכום ישר.

\item
נניח כי
$T$
הטלה. במקרה זה
$V = \ker\prs{T} \oplus \im\prs{T}$.
עבור בסיסים
\begin{align*}
C &= \prs{c_1, \ldots, c_m} \\
D &= \prs{d_{m+1}, \ldots, d_\ell}
\end{align*}
של
$\ker\prs{T}, \im\prs{T}$
בהתאמה, נקבל כי
$C \cup D$
בסיס של
$V$.
לכל
$c_i \in C $
מתקיים
$T\prs{c_i} = 0$,
לכן
$\dim\prs{\ker\prs{T}}$
העמודות הראשונות של
$\brs{T}_{C \cup D}$
הן עמודות אפסים.
לכל
$d_i \in D$
יש
$u_i \in V$
עבורו
\[\text{,} d_i = T\prs{u_i} = T^2\prs{u_i} = T\prs{T\prs{u_i}} = T\prs{d_i}\]
לכן
\[\brs{T\prs{d_i}}_{C \cup D} = \brs{d_i}_{C \cup D} = e_i\]
ולכן העמודה ה־%
$i$
עבור
$i \geq m$
היא
$e_i$,
ונקבל את הנדרש.

להיפך, נניח שקיים בסיס
$B = \prs{v_1, \ldots, v_n}$
כנ"ל. אז
$\brs{T^2}_B = \brs{T}_B^2 = \brs{T}_B$
ולכן
$T^2 = T$
ונקבל כי
$T$
הטלה.
\end{enumerate}
\end{solution}

\begin{definition}[משלים ישר]
יהי
$V$
מרחב וקטורי ויהי
$U \leq V$
תת־מרחב.
\emph{משלים ישר}
$W$
של
$U$
הוא תת־מרחב של
$V$
עבורו
$V = U \oplus W$.
\end{definition}

\begin{exercisechap}
יהי
$V$
מרחב וקטורי סוף־מימדי מעל שדה
$\mbb{F}$
ויהי
$U \leq V$
תת־מרחב עם בסיס
$B$.
יהי
$C$
בסיס של
$V$.
\begin{enumerate}
\item הראו שניתן להשלים את
$B$
לבסיס של
$V$
על ידי הוספת וקטורים מ־%
$C$.

\item הסיקו שקיים משלים ישר
$W$
של
$U$
עם בסיס של וקטורים מ־%
$C$.
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
\item נסמן
$n \coloneqq \dim_{\mbb{F}}\prs{V}$
ונוכיח את הטענה באינדוקציה על
$m = n - \abs{B}$.

עבור
$m = 0$
מתקיים
$\abs{B} = n$
ולכן
$U = V$.
נניח שהטענה נכונה לכל
$k < m$
ונוכיח אותה עבור
$m$.

אם
$C \subseteq U$,
מתקיים
\[V = \Span_{\mbb{F}}\prs{C} \subseteq \Span_{\mbb{F}}\prs{U} = U\]
ולכן
$V = U$
בסתירה לכך שהמימדים שונים.
לכן, קיים
$c \in C \setminus U$.
אז
$B \cup \prs{c}$
קבוצה בלתי־תלויה לינארית, כי
$c$
אינו צירוף לינארי של הוקטורים הקודמים. נגדיר
$U' = \Span_{\mbb{F}}\prs{B \cup \prs{c}}$.
אז
\[n - \dim\prs{U'} = n - \abs{B} - 1 = m-1 < m\]
ולכן ניתן להשתמש בהנחת האינדוקציה ולקבל שניתן להשלים את
$B \cup \prs{c}$
לבסיס
$\prs{B \cup \prs{c}} \cup \prs{c_2, \ldots, c_m}$
של
$V$,
כאשר
$c_i \in C$.
אז
$c, c_2, \ldots, c_m \in C$
משלימים את
$B$
לבסיס של
$V$.

\item בסימונים של הסעיף הקודם,
$B \cup \prs{c, \ldots, c_m}$
בסיס של
$V$.
נסמן
$D = \prs{c, c_2, \ldots, c_m}$
וגם
$W = \Span_{\mbb{F}}\prs{D}$.
אז
$B \cup D$
בסיס של
$V$
ולכן
\[\text{,} V = \Span_{\mbb{F}}\prs{B} \oplus \Span_{\mbb{F}}\prs{D} = U \oplus W\]
כנדרש.
\end{enumerate}
\end{solution}

\begin{exercisechap}
יהי
$V = \mbb{R}_3\brs{x}$
ותהיינה
\begin{align*}
B &= \prs{1+x, x+x^2} \\
C &= \prs{1, x, x^2, x^3}
\end{align*}
קבוצות סדורות של וקטורים מ־%
$V$.
יהי
$U = \Span\prs{B}$.

\begin{enumerate}
\item מיצאו משלים ישר
$W$
של
$U$
ובסיס עבור
$W$
שמורכב מוקטורים ב־%
$C$.
\item
האם
$W$
שמצאתם יחיד? הוכיחו או הפריכו.
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
\item נשלים את
$B$
לבסיס של
$V$
על ידי הוספת וקטורים מ־%
$C$.
נוסיף את
$1 \notin U$
כדי לקבל
$B' = \pmat{1 + x, x + x^2, 1}$
ואז את
$x^3 \notin \Span\prs{B'}$
כדי לקבל בסיס
$B'' = \pmat{1 + x, x + x^2, 1, x^3}$
של
$V$.

נסמן
$D = \prs{1, x^3}$
וניקח
$W = \Span\prs{D}$.
אז
$B'' = B \cup D$
בסיס,
ולכן
$V = U \oplus W$,
כנדרש.

\item לא.
למשל, יכולנו לקחת
$B' = \pmat{1 + x, x + x^2, x^2}$
ואז
$B'' = \pmat{1 + x, x + x^2, x^2, x^3}$.
במקרה זה היינו מקבלות משלים ישר
$\Span\prs{x^2, x^3}$,
ששונה מ־%
$W$.
\end{enumerate}
\end{solution}

\section{הדטרמיננטה}

\begin{definition}[דטרמיננטה]
תהי
$A \in \Mat_{n \times n}\prs{\mbb{F}}$
מטריצה עם מקדמים בשדה
$\mbb{F}$.
נגדיר את
\emph{הדטרמיננטה}
$\det\prs{A}$
של
$A$
באופן הרקורסיבי הבא.

תהי
$M_{i,j}$
הדטרמיננטה של המטריצה המתקבלת מ־$A$ לאחר הוצאת השורה ה־$i$ והעמודה ה־$j$ של $A$.
נקרא למספר זה
\emph{המינור}
ה־$\prs{i,j}$ של
$A$.
הדטרמיננטה של
$A$
שווה
\begin{align*}
\det\prs{A} &= \sum_{i \in \brs{n}} \prs{-1}^{i+j} a_{i,j} M_{i,j}
\end{align*}
עבור
$j \in \brs{n}$
קבוע, ושווה
\begin{align*}
\det\prs{A} &= \sum_{j \in \brs{n}} \prs{-1}^{i+j} a_{i,j} M_{i,j}
\end{align*}
עבור
$i \in \brs{n}$
קבוע.
\end{definition}

\begin{theorem}
תהיינה
$A, B, C \in \Mat_{n \times n}\prs{\mbb{F}}$
ונניח כי
$C$
הפיכה.
מתקיימות התכונות הבאות.
\begin{enumerate}
\item $\det\prs{AB} = \det\prs{A} \cdot \det\prs{B}$
\item $\det\prs{C^{-1}} = \prs{\det\prs{C}}^{-1}$
\end{enumerate}
\end{theorem}

\begin{theorem}
\begin{enumerate}
\item החלפת שתי שורות או עמודות במטריצה כופלת את הדטרמיננטה ב־%
$\prs{-1}$.
\item כפל שורה או עמודה במטריצה בסקלר
$\alpha$
כופל את הדטרמיננטה ב־%
$\alpha$.
\item הוספת כפולה שורה או עמודה לשורה או עמודה במטריצה אינה משנה את הדטרמיננטה.
\end{enumerate}
\end{theorem}

\begin{exercisechap}
חשבו את הדטרמיננטות של המטריצות הבאות.

\begin{enumerate}
\item \[\pmat{1 & 2 & 3 \\ 4 & 5 & 6 \\ 7 & 8 & 9} \in \Mat_{3}\prs{\mbb{R}}\]
\item \[\pmat{0 & 0 & 0 & 1 \\ 0 & 0 & 1 & 0 \\ 0 & 1 & 0 & 0 \\ 1 & 0 & 0 & 0} \in \Mat_{4}\prs{\mbb{R}}\]
\item \[\pmat{1 & 0 & 0 \\ 0 & 1 & 0 \\ 1 & 1 & 1} \in \Mat_{3}\prs{\mbb{R}}\]
\item \[\pmat{1 & 0 & 1 \\ 0 & 1 & 0 \\ 1 & 1 & 1} \in \Mat_{3}\prs{\mbb{R}}\]
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
\item
נחשב לפי השורה הראשונה.
\begin{align*}
\det \pmat{1 & 2 & 3 \\ 4 & 5 & 6 \\ 7 & 8 & 9} &= 1 \cdot \det\pmat{5 & 6 \\ 8 & 9} - 2 \cdot \det \pmat{4 & 6 \\ 7 & 9} + 3 \cdot \det \pmat{4 & 5 \\ 7 & 8}
\\&=
1 \cdot \prs{5 \cdot 9 - 6 \cdot 8} - 2 \cdot \prs{4 \cdot 9 - 6 \cdot 7} + 3 \cdot \prs{4 \cdot 8 - 5 \cdot 7}
\\&=
1 \cdot \prs{-3} -2 \cdot \prs{-6} + 3 \cdot \prs{-3}
\\&=
-3 + 12 - 9
\\&= 0
\end{align*}
\item החלפת שורות כופלת את הדטרמיננטה ב־%
$\prs{-1}$.
כיוון שניתן לקבל את המטריצה ממטריצת היחידה על ידי החלפת השורות
$1,4$
והשורות
$2,3$,
נקבל כי הדטרמיננטה שווה לזאת של היחידה. לכן
\[\text{.} \det \pmat{0 & 0 & 0 & 1 \\ 0 & 0 & 1 & 0 \\ 0 & 1 & 0 & 0 \\ 1 & 0 & 0 & 0} = 1\]
\item
הוספת כפולה של השורות הראשונה והשנייה ב־%
$\prs{-1}$
לשורה השלישית לא משנה את הדרמיננטה. לכן הדטמיננטה של המטריצה שווה לזאת של היחידה, ולכן
\[\text{.} \det \pmat{1 & 0 & 0 \\ 0 & 1 & 0 \\ 1 & 1 & 1} = 1\]
\item
הוספת כפולה של השורות הראשונה והשנייה ב־%
$\prs{-1}$
לשורה השלישית לא משנה את הדרמיננטה. לכן הדטמיננטה של המטריצה שווה לזאת של
\begin{align*}
\text{.} \pmat{1 & 0 & 1 \\ 0 & 1 & 0 \\ 0 & 0 & 0}
\end{align*}
כיוון שהשורה השלישית היא שורת אפסים, אם נפתח את הדטרמיננטה לפיה נקבל שהדטרמיננטה שווה
$0$.
זה נכון באופן כללי יותר אם השורות תלויות לינארית, כי נוכל לקבל שורת אפסים מצירוף לינארי של השורות.
\end{enumerate}
\end{solution}

\begin{exercisechap}
תהי
$T \in \End_{\mbb{F}}\prs{V}$
העתקה לינארית ויהי
$B$
בסיס של
$V$.
הראו כי ניתן להגדיר
$\det\prs{T} = \det\prs{\brs{T}_B}$.
כלומר, הראו שאם
$C$
בסיס נוסף של
$V$
מתקיים
$\det\prs{\brs{T}_B} = \det\prs{\brs{T}_C}$.
\end{exercisechap}

\begin{solution}
מתקיים
\begin{align*}
\brs{T}_B = \prs{M^B_C}^{-1} \brs{T}_C M^B_C
\end{align*}
ולכן
\begin{align*}
\text{.} \det\prs{\brs{T}_B} &= \det\prs{\prs{M^B_C}^{-1}} \det\prs{\brs{T}_C} \det\prs{M^B_C}
\end{align*}
כיוון ש־%
$\det\prs{A^{-1}} = \frac{1}{\det\prs{A}}$
 לכל מטריצה
 $A$,
 מתקיים
 $\det\prs{\prs{M^B_C}^{-1}} = \frac{1}{\det\prs{M^B_C}}$.
 לכן, נקבל בסה"כ כי
 \[\text{,} \det\prs{\brs{T}_B} = \det\prs{\brs{T}_C}\]
 כנדרש.
\end{solution}

\section{לכסינות}

\begin{definition}[אופרטור לכסין]
אופרטור
$T \in \End_{\mbb{F}}\prs{V}$
נקרא
\emph{לכסין}
אם קיים בסיס
$B$
של
$V$
וקיימים
$\alpha_1, \ldots, \alpha_n \in \mbb{F}$
עבורם
\begin{align*}
\text{.} \brs{T}_B &= \pmat{\alpha_1 & & \\ & \ddots &  \\  &  & \alpha_n}
\end{align*}
בסיס
$B$
כזה נקרא
\emph{בסיס מלכסן}
עבור
$T$,
והמטריצה
$\brs{T}_B$
נקראת
\emph{מטריצה אלכסונית}.
\end{definition}

\begin{definition}
יהי
$T \in \End_{\mbb{F}}\prs{V}$.
וקטור
$v \in V \setminus \set{0}$
נקרא
\emph{וקטור עצמי של
$T$}
אם קיים
$\lambda \in \mbb{F}$
עבורו
$T\prs{v} = \lambda v$.

במקרה זה
$\lambda$
נקרא
\emph{ערך עצמי}
של
$T$.
\end{definition}

\begin{remark}
$v$
וקטור עצמי של
$T$
אם ורק אם קיים
$\lambda \in \mbb{F}$
עבורו
$T\prs{v} = \lambda v$.
מתקיים
$\Span_{\mbb{F}}\prs{v} = \set{\lambda v}{\lambda \in \mbb{F}}$
ולכן באופן שקול
$T\prs{v} \in \Span_{\mbb{F}}\prs{v}$
ובאופן שקול
$T\prs{\alpha v} = \alpha T\prs{v} \in \Span_{\mbb{F}}\prs{v}$
לכל
$\alpha \in \mbb{F}$.

לכן,
$v$
וקטור עצמי של
$T$
אם ורק אם
$\Span_{\mbb{F}}\prs{v}$
הינו
$T$%
־שמור.
\end{remark}

\begin{remark}
אופרטור
$T \in \End_{\mbb{F}}\prs{V}$
הינו לכסין אם ורק אם קיים בסיס של
$V$
שמורכב מוקטורים עצמיים של
$T$.
\end{remark}

\begin{definition}[מרחב עצמי]
יהי
$T \in \End_{\mbb{F}}\prs{V}$
ויהי
$\lambda$
ערך עצמי של
$T$.
\emph{המרחב העצמי}
של
$T$
עם הערך
$\lambda$
הוא
\begin{align*}
\text{.} V_{\lambda} &\coloneqq \set{v \in V}{T\prs{v} = \lambda v} = \ker\prs{\lambda \id_V - T}
\end{align*}
\end{definition}

\begin{definition}[פולינום אופייני]
יהי
$T \in \End_{\mbb{F}}\prs{V}$.
\emph{הפולינום האופייני של
$T$}
הוא
\[\text{.} p_T\prs{x} \coloneqq \det\prs{x \id_V - T}\]
\end{definition}

\begin{remark}
בפועל, נסתכל בדרך כלל על פולינום אופייני של מטריצה, כיוון שצריך לבחור בסיס כדי לחשב את הדטרמיננטה.
ראינו כי הדטרמיננטה לא תלויה בבחירת הבסיס, ולכן
$p_T\prs{x} = p_{\brs{T}_B}\prs{x}$
לכל בסיס
$B$
של
$V$,
כאשר
$p_A\prs{x} = \det\prs{xI - A}$.
\end{remark}

\begin{corollary}
איבר
$\lambda \in \mbb{F}$
הוא ערך עצמי של
$T$
אם ורק אם
$\ker\prs{\lambda \id_V - T} \neq 0$,
אם ורק אם
$p_T\prs{\lambda} = \det\prs{\lambda \id_V - T} = 0$.

כלומר, הערכים העצמיים של
$T$
הם השורשים של
$p_T$.
\end{corollary}

\begin{remark}
כיוון שלכל פולינום
$p \in \mbb{C}\brs{x}$
יש שורש, לכל
$T \in \End_{\mbb{C}}\prs{V}$
יש ערך עצמי.
\end{remark}

\begin{definition}[ריבוי אלגברי]
יהי
$T \in \End_{\mbb{F}}\prs{V}$.
\emph{הריבוי האלגברי}
של ערך עצמי
$\lambda \in \mbb{F}$
הוא הריבוי שלו כשורש של
$p_T$.
נסמו
$r_a\prs{\lambda}$.
\end{definition}

\begin{definition}[ריבוי גיאומטרי]
יהי
$T \in \End_{\mbb{F}}\prs{V}$.
\emph{הריבוי הגיאומטרי}
של ערך עצמי
$\lambda \in \mbb{F}$
הוא
$r_g\prs{\lambda} \coloneqq \dim V_\lambda$.
\end{definition}

\begin{remark}
מתקיים תמיד
$r_g\prs{\lambda} \leq r_a\prs{\lambda}$.
\end{remark}

\begin{definition}
תהי
$A \in \Mat_{n}\prs{\mbb{F}}$
ויהי
$T = T_A$
אופרטור כפל ב־$
A$
משמאל (כלומר,
$T\prs{v} = Av$).
אם
$T$
לכסין, קיים בסיס
$B$
עבורו
$D \coloneqq \brs{T}_B$
אלכסונית.
אז
\begin{align*}
A &= \brs{T}_E
\\&= \brs{\id \circ T \circ \id}_E
\\&= M^B_E \brs{T}_B M^E_B
\\&= M^B_E D \prs{M^B_E}^{-1}
\end{align*}
ואם נסמן
$P = M^B_E$
נקבל כי זאת מטריצה הפיכה עבורה
$P^{-1} A P = D$.

לכן, נגיד שמטריצה
$A \in \Mat_n\prs{\mbb{F}}$
הפיכה אם קיימת
$P \in \Mat_n\prs{\mbb{F}}$
הפיכה עבורה
$P^{-1} A P$
אלכסונית.
\end{definition}

\begin{exercisechap}
הראו כי
\[A = \pmat{1 & 0 \\ 1 & 0} \in \Mat_2\prs{\mbb{R}}\]
לכסינה ומצאו
$P \in \Mat_2\prs{\mbb{R}}$
עבורה
$P^{-1}AP$
מטריצה אלכסונית.
\end{exercisechap}

\begin{solution}
סכום הערכים העצמיים של
$A$
שווה לעקבה שלה
$\tr\prs{A} = 1$
ומכפלת הערכים העצמיים שווה
$\det\prs{A} = 0$.
לכן הערכים העצמיים הם
$0,1$.
כיוון שלכל אחד מהם הריבוי האלגברי שווה לריבוי הגיאומטרי, המטריצה הינה לכסינה.

נמצא וקטורים עצמיים עבור שני הערכים העצמיים השונים.
עבור
$0$
ניתן לראות כי
$e_2$
ערך עצמי, כי
$A e_2$
היא העמודה השנייה של
$A$,
ששווה לוקטור האפס.
עבור
$1$,
נחפש וקטור
$v \in \mbb{R}^2$
עבורו
$Av = v$,
כלומר
$\prs{A - I}v = 0$.
מתקיים
$A - I = \pmat{0 & 0 \\ 1 & -1}$
ולכן אם
$v = \pmat{v_1 \\ v_2}$
צריך להתקיים
$v_1 - v_2 = 0$,
כלומר
$v_1 = v_2$.
ניקח אם כך
$v = \pmat{1 & 1}$
ונקבל
$Av = \pmat{1 & 0 \\ 1 & 0} = \pmat{1 \\ 1} = v$.

אז
$B = \prs{e_2, e_1 + e_2}$
בסיס מלכסן של ההעתקה
\begin{align*}
T_A \colon \mbb{R}^2 &\to \mbb{R}^2 \\
\text{.} \hphantom{lalala} v &\mapsto Av
\end{align*}
נקבל כי
\[D \coloneqq \brs{T_A}_B = \prs{M^B_E}^{-1} \brs{T_A}_E M^B_E\]
מטריצה אלכסונית, ולכן ניקח
$P = M^B_E = \pmat{0 & 1 \\ 1 & 1}$.
\end{solution}

\begin{exercisechap}
יהיו
$n \in \mbb{N}_+$
ו־%
$\lambda \in \mbb{C}$,
ותהי
\[\text{.} J_n\prs{\lambda} = \pmat{\lambda & 1 & 0 & \cdots & 0 \\
0 & \lambda & 1 & \ddots & 0 \\
\vdots & \ddots & \ddots & \ddots & \vdots \\
0 & \ddots & \ddots & \lambda & 1 \\
0 & 0 & \cdots & 0 & \lambda} \in \Mat_n\prs{\mbb{C}}\]

מיצאו עבור אילו ערכי
$n, \lambda$
המטריצה
$J_n\prs{\lambda}$
לכסינה.
\end{exercisechap}

\begin{solution}
הערכים העצמיים של מטריצה משולשת עליונה הינם על האלכסון. לכן
$\lambda$
ערך עצמי של
$J_n\prs{\lambda}$
מריבוי אלגברי
$n$.
לכן, אם
$J_n\prs{\lambda}$
לכסינה, היא דומה למטריצה
$\lambda I_n$.
אבל, מטריצה סקלרית דומה רק לעצמה, ולכן המטריצה
$J_n\prs{\lambda}$
לכסינה רק עבור
$n = 1$,
ובלי תלות ב־%
$\lambda$.
\end{solution}

\begin{exercisechap}
הוכיחו/הפריכו:
\begin{enumerate}
\item סכום של מטריצות לכסינות הוא לכסין.
\item כפל של מטריצות לכסינות הוא לכסין.
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
\item לא.
מתקיים
\[\pmat{1 & 1 \\ 0 & 0} + \pmat{0 & 0 \\ 0 & 1} = J_2\prs{1}\]
וראינו שמטריצה זאת אינה לכסינה.
המטריצה
$A \coloneqq \pmat{1 & 1 \\ 0 & 0}$
לכסינה כי ראינו בתרגיל קודם ש־%
$A^t$
לכסינה.

\item לא.
מתקיים
\[\pmat{1 & 0 \\ 0 & -1} \cdot \pmat{1 & 1 \\ 0 & -1} = \pmat{1 & 1 \\ 0 & 1} = J_2\prs{1}\]
וזאת מטריצה שאינה לכסינה.
אבל,
$\pmat{1 & 1 \\ 0 & - 1}$
לכסינה כי יש לה שני ערכים עצמיים שונים,
$\pm 1$,
כאיברי האלכסון של מטריצה משולשת עליונה.
\end{enumerate}
\end{solution}


\section{מרחבים שמורים}

נרצה להבין אופרטורים לינאריים דרך הבנה של צמצום שלהם לתת־מרחבים קטנים יותר.
אם
$T \in \End_{\mbb{F}}\prs{V}$,
נוכל תמיד לצמצם את המקור כדי לקבל העתקה לינארית
$\left. T \right|_{W} \colon W \to V$,
אבל לא נוכל ללמוד מספיק כאשר הצמצום אינו אופרטור. לכן נרצה לצמצם גם את הטווח, מה שמוביל להגדרה הבאה.

\begin{definition}[מרחב שמור]
יהי
$T \in \End_{\mbb{F}}\prs{V}$
ויהי
$U \leq V$.
נגיד כי
$U$
הינו
\emph{$T$%
־שמור} (או
\emph{$T$%
־אינווריאנטי}
אם
$T\prs{U} \subseteq U$.
\end{definition}

\begin{definition}
במקרה ש־%
$W$
מרחב
$T$%
־שמור, נוכל להסתכל על הצמצום
$\left. T \right|_W \colon W \to W$
שמוגדר על ידי
$\left. T \right|_W \prs{w} = T\prs{w}$.
\end{definition}

\begin{remark}
שימו לב שהסימון הוא אותו סימון כמו הצמצום של המקור, אך במסגרת הקורס צמצום אופרטורים יתייחס לזה שבהגדרה אלא אם כן יצוין מפורשות אחרת.
\end{remark}

\begin{exercisechap}
יהיו
$V$
מרחב וקטורי
מעל
$\mbb{F}$,
יהיו
$P,T \in \End_{\mbb{F}}\prs{V}$
כאשר
$P$
איזומורפיזם.
יהי
$W \leq V$.

הראו כי
$W$
הינו
$T$%
־שמור אם ורק אם
$P^{-1}\prs{W}$
הינו
$P^{-1} \circ T \circ P$%
־שמור.
\end{exercisechap}

\begin{solution}
נניח כי
$W$
הינו
$T$%
־שמור ויהי
$v \in P^{-1}\prs{W}$.
נרצה להראות כי
$P^{-1} \circ T \circ P \prs{v} \in P^{-1}\prs{W}$.
יהי
$w \in W$
עבורו
$v = P^{-1}\prs{w}$.
אז
\begin{align*}
P^{-1} \circ T \circ P \prs{v} &= P^{-1} \circ T \circ P \circ P^{-1}\prs{W}
\\&= P^{-1} \circ T \prs{w}
\end{align*}
כאשר
$T\prs{w} \in W$
כי
$W$
הוא
$T$%
־שמור. נקבל כי
$P^{-1} \circ T \circ P \prs{v} \in P^{-1}\prs{W}$.

בכיוון השני, נניח כי
$U \coloneqq P^{-1}\prs{W}$
הינו
$P^{-1} \circ T \circ P$%
־שמור.
נגדיר
$S = P^{-1} \circ T \circ P$,
וגם
$Q = P^{-1}$.
אז
$T = Q^{-1} \circ T \circ Q$
וגם
$W = P\prs{P^{-1}\prs{W}} = P\prs{U} = Q^{-1}\prs{U}$.
מהכיוון הראשון, נקבל כי
$W$
הינו
$\prs{Q^{-1} \circ T \circ Q}$%
־שמור, כלומר
$T$%
־שמור.
\end{solution}

\begin{exercisechap}
יהי
$\mbb{C}$
כמרחב וקטורי ממשי ויהי
\begin{align*}
T \colon \mbb{C} &\to \mbb{C} \\
\text{.} \hphantom{lala} z &\mapsto iz
\end{align*}
מצאו את התת־מרחבים ה־%
$T$%
־שמורים של
$\mbb{C}$
והסיקו כי
$T$
אינו לכסין מעל
$\mbb{R}$.
\end{exercisechap}

\begin{solution}
$\mbb{C}, \set{0}$
תת־מרחבים
$T$%
־שמורים.

נניח כי
$W \leq \mbb{C}$
מרחב
$T$%
־שמור נוסף. אז
$\dim_{\mbb{R}}\prs{W} = 1$
ולכן יש
\[z_0 \in \mbb{C}^\times \ceq \set{z \in \mbb{C}}{z \neq 0}\]
עבורו
$W = \spn\set{z_0}$.
נקבל
$T\prs{z_0} \in W$
לכן
$T\prs{z_0} = c z_0$
עבור
$c \in \mbb{R}$.
אבל
$c z_0 = i z_0$
גורר
$c = i$
בסתירה.

תת־מרחבים $T$־שמורים $1$־מימדיים של
$\mbb{C}$
הם
$\Span_{\mbb{R}}\prs{v}$
עבור
$v$
וקטור עצמי של
$T$.
 לכן אין ל־%
$T$
וקטורים עצמיים, ולכן הוא אינו לכסין מעל
$\mbb{R}$.
\end{solution}

\begin{notation}
עבור מטריצות ריבועיות
$A_1, \ldots, A_k$
נסמן
\[\text{.} A_1 \oplus \ldots \oplus A_k = \pmat{A_1 & & \\ & \ddots & \\ & & A_k}\]
\end{notation}

\begin{exercisechap}
יהי
$V = \mbb{C}^n$
ותהי
\[T \colon V \to V\]
עם
\[\brs{T}_E = \lambda_1 I_{m_1} \oplus \ldots \oplus \lambda_k I_{m_k}\]
עבור
$\lambda_i \neq \lambda_j$
לכל
$i \neq j$.
נסמן
$n_i = m_1 + \ldots + m_{i-1} + 1$.
מצאו את כל התת־מרחבים ה־%
$T$%
־שמורים של
$V$.
\end{exercisechap}

\begin{solution}
ראשית, אם
$W \leq V_i \coloneqq \Span\prs{e_{n_i}, \ldots, e_{n_i + m_i - 1}}$,
נקבל כי
$T\prs{w} = \lambda_i w \in W$
לכל
$w \in W$.
לכן כל תת־מרחב כזה הינו
$T$%
־שמור.
גם סכום של תת־מרחבים כאלה יהיה
$T$%
־שמור כי אם
$v_i \in W_i \coloneqq W \cap V_i$
לכל
$i \in [k]$
אז
\[T\prs{v_1 + \ldots + v_k} = T\prs{v_1} + \ldots + T\prs{v_k}\]
כאשר
$T\prs{v_i} \in W$
וגם
$T\prs{v_i} = \lambda_i v_i \in V_i$,
כלומר
$T\prs{v_i} \in W_i$.
נראה שאלו כל האפשרויות לתת־מרחבים שמורים.

ראינו בהרצאה כי אם
$W$
הינו
$T$%
־שמור, אז
$\left. T \right|_W$
הינו לכסין.
לכן,
$W$
סכום ישר של המרחבים העצמיים של
$\left. T \right|_W$.
לכל ערך עצמי
$\lambda$,
המרחב העצמי
$W_{\lambda}$
של
$\left. T \right|_W$
הוא החיתוך
$V_\lambda \cap W$
כאשר
$V_\lambda$
המרחב העצמי של
$T$.
כיוון שעבור אופרטור לכסין המרחב שווה לסכום ישר של המרחבים העצמיים, נקבל כי
\begin{align*}
\text{,} W = \bigoplus_{i \in [k]} W_{\lambda_i} = \bigoplus_{i \in [k]} W \cap V_{\lambda_i}
\end{align*}
כנדרש.
\end{solution}

\begin{definition}[בלוק ז'ורדן]
יהי
$\lambda \in \mbb{F}$.
נגדיר
\emph{בלוק ז'ורדן מגודל
$m$
עם ערך עצמי
$\lambda$}
בתור
\begin{align*}
\text{.} J_m\prs{\lambda} \coloneqq \pmat{\lambda & 1 & & \\ & \lambda & \ddots & \\ & & \ddots & 1 \\ & & & \lambda} \in \Mat_m\prs{\mbb{F}}
\end{align*}
\end{definition}

\begin{definition}[אופרטור אי־פריד]
אופרטור
$T \in \End_{\mbb{F}}\prs{V}$
נקרא
\emph{אי־פריד}
אם לכל
$U,W \leq V$
שהינם
$T$%
־שמורים ועבורם
$U \oplus W = V$,
בהכרח
$U = V, W = \set{0}$
או
$U = \set{0}, W = V$.
\end{definition}

\begin{exercisechap}\label{exercise:jordan_invariant}
\begin{enumerate}
\item יהי
$T = T_{J_n\prs{0}} \in \End\prs{\mbb{F}^n}$.
מיצאו את המרחבים ה־%
$T$
שמורים של
$\mbb{F}^n$.

\item יהי
$N \in \End_{\mbb{F}}\prs{V}$
ויהי
$\lambda \in \mbb{F}$.
הראו שהמרחבים ה־%
$S$
־שמורים של
$V$
הם המרחבים ה־%
$\prs{N + \lambda \id_V}$
־שמורים של
$V$.

\item יהי
$S = T_{J_n\prs{\lambda}} \in \End_{\mbb{F}^n}$.
הסיקו מה המרחבים ה־%
$S$%
־שמורים של
$\mbb{F}^n$.

\item
הראו כי
$S$
הינו אי־פריד.
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
\item
נשים לב כי
\begin{align*}
\set{0} & \\
\ker\prs{T} &= \Span\prs{e_1} \\
\im\prs{T} &= \Span\prs{e_1, \ldots, e_{n-1}} \\
V &= \Span\prs{e_1, \ldots, e_n}
\end{align*}
כולם
$T$%
־שמורים, כיוון שמרחב האפס, הגרעין, התמונה, והמרחב כולו תמיד
$T$%
־שמורים.
גם, מתקיים
\begin{align*}
\forall i > 1 \colon T\prs{e_i} &= e_{i-1} \in \Span\prs{e_1, \ldots, e_i} \\
T\prs{e_1} &= 0
\end{align*}
ולכן כל מרחב מהצורה
$\Span\prs{e_1, \ldots, e_i}$
עבור
$i \in \set{0, \ldots, n}$
הינו
$T$%
־שמור.
נרצה להראות שהמרחבים ה־%
$T$%
־שמורים הם בדיוק אלו מהצורה
הזאת.

יהי
$W \leq \mbb{F}^n$
מרחב
$T$%
־שמור, ויהי
$k \in \set{0, \ldots, n}$
המקסימלי עבורו
$\Span\prs{e_1, \ldots, e_k} \subseteq W$
(יש כזה
$k$
כיוון שעבור
$k = 0$
נקבל
$\set{0} \subseteq W$).
נרצה להראות כי
$W = \Span\prs{e_1, \ldots, e_k}$.

אחרת, קיים וקטור
$v = \sum_{i \in \brs{\ell}} \alpha_i e_i \in W$
עם
$\ell > k$
וגם
$\alpha_\ell \neq 0$.
אם
$\ell = k+1$
נקבל כי
$\alpha_i e_i \in W$
לכל
$i < \ell$
ולכן
\[\alpha_\ell e_\ell = v - \sum_{i \in [\ell - 1]} \in W\]
וכיוון ש־%
$\alpha_\ell \neq 0$
אז
$e_{k+1} = e_\ell \in W$.
במקרה זה
$e_1, \ldots, e_{k+1} \in W$
ולכן
$\Span\prs{e_1, \ldots, e_{k+1}} \subseteq W$
בסתירה להנחה.

באופן כללי, מתקיים
$T^i\prs{v} \in W$
לכל
$i$.
כדי שיתקיים
$T^i\prs{e_\ell} = e_{k+1}$
צריך לקחת
$\ell - i = k+1$
כלומר
$i = \ell - \prs{k+1}$.
אז
\begin{align*}
T^{\ell - \prs{k+1}} \prs{v} &= \sum_{i \in \brs{\ell}} \alpha_i T^{\ell - \prs{k+1}}\prs{e_i}
\\&= \sum_{i = \ell - k}^{\ell} \alpha_i e_{i - \ell + k + 1}
\\&= \sum_{j = 1}^{k+1} \alpha_{j+\ell-k-1} e_j \in W
\end{align*}
ונקבל את הנדרש מהמקרה הקודם
$\ell = k+1$.

\item
יהי
$W \leq V$
תת־מרחב
$N$%
־שמור. לכל
$w \in W$
מתקיים
\[\prs{N + \lambda \id_V}\prs{w} = N\prs{w} + \lambda w \in W\]
כיוון ש־%
$N\prs{w}, \lambda w \in W$.
לכן
$W$
הינו
$N + \lambda \id_V$%
־שמור.

אם
$W \leq V$
תת־מרחב
$\prs{N + \lambda \id_V}$%
־שמור, נקבל מהכיוון הראשון שהוא
$\prs{N + \lambda \id_V} + \prs{-\lambda}\id_V$%
־שמור, כלומר
$N$%
־שמור.

\item
מהסעיף הקודם, נקבל כי המרחבים ה־%
$S$
שמורים הם המרחבים ה־%
$T$%
־שמורים, שהינם אלו מהצורה
$\Span_{\mbb{F}}\prs{e_1, \ldots, e_i}$
עבור
$i \in \set{0, \ldots, n}$.

\item
נניח כי יש תת־מרחבים
$S$%
־שמורים
$W_1, W_2$
עבורם
$\mbb{F}^n = W_1 \oplus W_2$.
מהסעיף הקודם, יש
$i,j \in \set{0, \ldots, n}$
עבורם
\begin{align*}
W_1 &= \Span\prs{e_1, \ldots, e_i} \\
\text{.} W_2 &= \Span\prs{e_1, \ldots, e_j}
\end{align*}
כיוון ש־%
$W_1 \oplus W_2 = \mbb{F}^n$,
בהכרח
$e_n \in W_1 + W_2$,
ולכן
$i = n$
או
$j = n$.
במקרה הראשון,
$W_1 = \mbb{F}^n, W_2 = \set{0}$
ובמקרה השני
$W_2 = \mbb{F}^n, W_1 = \set{0}$,
ובכל מקרה הפירוק הינו טריוויאלי.
\end{enumerate}
\end{solution}

\begin{example}
יהי
$V = \mbb{C}^4$,
ויהי
$T = T_{J_4\prs{0}} \in \End_{\mbb{C}}\prs{V}$.
נניח כי
$W \leq V$
מכיל
\end{example}

\begin{exercisechap}
\begin{enumerate}
\item תהי
$A \in \mrm{Mat}_n\prs{\mbb{R}}$.
הוכיחו כי אם ל־%
$T_A$
אין תת־מרחב שמור ממימד
$1$,
יש לו תת־מרחב שמור ממימד
$2$.

\item נניח כי
$A \in \mrm{Mat}_n\prs{\mbb{C}}$
מטריצה שכל מקדמיה ממשיים. הוכיחו כי אם
$\lambda$
ערך עצמי של
$T_A$
אז
$\bar{\lambda}$
גם ערך עצמי של
$T_A$.
\end{enumerate}
\end{exercisechap}

\begin{solution}
עבור מטריצה
$A = \prs{a_{i,j}} \in \mrm{Mat}_{n, m}$
נגדיר
\[\bar{A} = \prs{\bar{a}_{i,j}}\]
את המטריצה שמקדמיה הם המספרים הצמודים לאלו ב־%
$A$.
נשים לב כי עבור שתי מטריצות
$A \in \mrm{Mat}_{m,n}\prs{\mbb{C}}$
ו־%
$B \in \mrm{Mat}_{n,\ell}\prs{\mbb{C}}$,
מתקיים
\begin{align*}
\prs{\overline{AB}}_{i,j} &= \overline{\sum_{k = 1}^n a_{i,k} b_{k,j}}
\\&= \sum_{k=1}^n \overline{a_{i,k}} \overline{b_{k,j}}
\\&= \prs{\abs{A} \abs{B}}_{i,j}
\end{align*}
ולכן
$\overline{AB} = \bar{A} \bar{B}$.

\begin{enumerate}
\item
תת־מרחב
$T_A$%
־שמור ממימד
$1$
הוא מהצורה
$\Span_{\mbb{R}}\prs{v}$
עבור וקטור עצמי
$v$
של
$T_A$.
לכן מההנחה, אין ל־%
$T_A$
וקטורים עצמיים.

אבל, אפשר לחשוב על
$A$
כעל מטריצה ב־%
$\mrm{Mat}_n\prs{\mbb{C}}$
שנסמנה
$\tilde{A}$.
אז ל־%
$T_{\tilde{A}} \in \End_{\mbb{C}}\prs{\mbb{C}^n}$
יש וקטור עצמי כאופרטור מעל
$\mbb{C}$.
יהי
$v \in \mbb{C}^n$
וקטור עצמי של
$T_{\tilde{A}}$
עם ערך עצמי
$\lambda = \alpha + i \beta$,
ונכתוב
\[v = \pmat{u_1 + i w_1 \\ \vdots \\ u_n + i w_n} = u + iw\]
כאשר
$u,w \in \mbb{C}^n$
וקטורים עם מקדמים ממשיים. נוכל לחשוב עליהם כחיים ב־%
$\mbb{R}^n$.
אז
\begin{align*}
Au + iAw &= A\prs{u + iw}
\\&= Av
\\&= \lambda v
\\&= \prs{\alpha + i \beta} \prs{u + iw}
\\&= \alpha u + \alpha i w + \beta i u - \beta w
\\&= \prs{\alpha u - \beta w} + i\prs{\alpha w + \beta u}
\end{align*}
כאשר
$Au, Aw \in \mbb{R}^n$.
אז, נוכל להשוות מקדמים ולקבל
\begin{align*}
T_A\prs{u} &= Au = \alpha u - \beta w \in \Span\prs{u,w} \\
\text{.} T_A\prs{w} &= Aw =  \alpha w + \beta u \in \Span\prs{u,w}
\end{align*}
לכן
$\Span\prs{u,w}$
הינו תת־מרחב
$L_A$%
־שמור של
$\mbb{R}^n$.

\item אם
$\lambda$
ממשי אין מה להוכיח כי
$\lambda = \bar{\lambda}$.
נניח אם כן כי
$\lambda = \alpha + i\beta$
עבור
$\beta \neq 0$.
נסמן ב־%
$v = u + iw$
וקטור עצמי של
$A$
עם ערך עצמי
$\lambda$,
כאשר
$u,w \in \mbb{C}^n$
עם מקדמים ממשיים.
אז
\begin{align*}
\bar{A}\bar{v} = \overline{Av} = \overline{\lambda v} = \bar{\lambda} \bar{v}
\end{align*}
ולכן
$\bar{v}$
וקטור עצמי של
$A$
עם ערך עצמי
$\bar{\lambda}$,
כנדרש.
\end{enumerate}
\end{solution}

\chapter{צורת ז'ורדן}

כדי לבצע חישובים על אופרטורים לינאריים, בדרך כלל יש לקחת בסיס ולערוך את החישובים על המטריצות המייצגות.
נרצה לקחת בסיס שיתן לנו מטריצה שתאפשר חישובים פשוטים ככל הניתן: מטריצה אלכסונית. אין לכל אופרטור צורה אלכסונית, אבל, מעל שדה סגור אלגברית יש צורה
``כמעט אלכסונית'' שנקראת
\emph{צורת ז'ורדן}.

\begin{definition}
יהי
$\lambda \in \mbb{F}$.
נגדיר
\emph{בלוק ז'ורדן מגודל
$m$
עם ערך עצמי
$\lambda$}
בתור
\begin{align*}
\text{.} J_m\prs{\lambda} \coloneqq \pmat{\lambda & 1 & & \\ & \lambda & \ddots & \\ & & \ddots & 1 \\ & & & \lambda} \in \Mat_m\prs{\mbb{F}}
\end{align*}
\end{definition}

\begin{definition}[מטריצת ז'ורדן]
מטריצה
$A \in \Mat_n\prs{\mbb{F}}$
נקראת
\emph{מטריצת ז'ורדן}
אם היא מטריצה אלכסונית בלוקים שכל הבלוקים בה הם בלוקי ז'ורדן.
\end{definition}

\begin{definition}[בסיס ז'ורדן]
יהי
$T \in \End_{\mbb{F}}\prs{V}$.
\emph{בסיס ז'ורדן}
עבור
$T$
הוא בסיס
$B$
של
$V$
עבורו
$\brs{T}_B$
מטריצת ז'ורדן.
\end{definition}

\begin{definition}[שדה סגור אלגברית]
שדה
$\mbb{F}$
נקרא
\emph{סגור אלגברית}
אם לכל פולינום
$p \in \mbb{F}\brs{x}$
שאינו קבוע יש שורש.
\end{definition}

\begin{theorem}[משפט ז'ורדן]
יהי
$\mbb{F}$
שדה סגור אלגברית, יהי
$V$
מרחב וקטורי סוף־מימדי מעל
$\mbb{F}$
ויהי
$T \in \End_{\mbb{F}}\prs{V}$.
קיים בסיס ז'ורדן עבור
$T$,
וצורת ז'ורדן של
$T$
יחידה עד כדי שינוי סדר הבלוקים.
\end{theorem}

בהוכחת משפט ז'ורדן בהרצאה, הסתכלנו קודם כל על אופרטורים שעבורם הערך העצמי היחיד הוא
$0$,
שהינם אופרטורים
\emph{נילפוטנטיים}.
נדון תחילה במשפט ז'ורדן עבור אופרטורים אלו.

\section{אופרטורים נילפוטנטיים}

עבור בלוק ז'ורדן
$A = J_n\prs{0}$
מתקיים
$A^n = 0$,
ולכן גם
$T_A^n = 0$.
נוכל באופן דומה לדבר על אופרטורים כלליים עם תכונה זאת.

\begin{definition}[אופרטור נילפוטנטי]
אופרטור
$T \in \End_{\mbb{F}}\prs{V}$
נקרא
\emph{נילפוטנטי}
אם קיים
$i \in \mbb{N}_+$
עבורו
$T^i = 0$.

הערך
$k$
המינימלי עבורו
$T^k = 0$
נקרא
\emph{אינדקס הנילפוטנטיות}
של
$T$.
\end{definition}

התרגיל הבא מראה שאלו בדיוק האופרטורים שמעניינים אותנו כאשר אנו רוצות להתייחס רק לערך עצמי
$0$.

\begin{exercisechap}
יהי
$V$
מרחב וקטורי סוף־מימדי מעל שדה
\emph{סגור אלגברית}
$\mbb{F}$,
ויהי
$T \in \End_{\mbb{F}}\prs{V}$.
אז
$T$
נילפוטנטי אם ורק אם
$0$
הוא הערך העצמי היחיד של
$T$.
\end{exercisechap}

\begin{solution}
נניח כי
$T$
נילפוטנטי מאינדקס
$k$, ויהי
$\lambda$
ערך עצמי של
$T$
עם וקטור עצמי
$v$.
אז
$0 = T^k\prs{v} = \lambda^k v$
וכיוון ש־%
$v \neq 0$
נקבל
$\lambda^k = 0$
ואז
$\lambda = 0$.

בכיוון השני, נניח כי
$0$
הוא הערך העצמי היחיד.
ממשפט ז'ורדן, קיים בסיס
$B$
של
$V$
עבורו
\begin{align*}
\text{.} \brs{T}_B = \pmat{J_{m_1}\prs{0} & & \\ & \ddots & \\ & & J_{m_k}\prs{0}}
\end{align*}
לכל
$i \in [k]$
מתקיים
$J_{m_i}\prs{0}^{m_i} = 0$,
ולכן אם ניקח
$m = \max_{i \in [k]} m_i$
נקבל כי
\begin{align*}
\brs{T}_B^m = \pmat{J_{m_1}\prs{0}^m & & \\ & \ddots & \\ & & J_{m_k}\prs{0}^m} = 0
\end{align*}
ואז
$T^m = 0$.
\end{solution}

\begin{exercisechap}
יהי
$T \in \End_{\mbb{F}}\prs{V}$
נילפוטנטי מאינדקס
$k$
ונסמן
$n_i \coloneqq \dim \ker\prs{T^i}$
לכל
$i \in \mbb{N}$.
הראו כי
\[\text{.} 0 < n_1 < n_2 < \ldots < n_{k-1} < n_k = n\]
\end{exercisechap}

\begin{solution} 
לכל
$v \in \ker\prs{T^i}$
מתקיים
$T^{i+1}\prs{v} = 0$
ולכן
$\ker\prs{T} \subseteq \ker\prs{T^2} \subseteq \ldots \subseteq \ker\prs{T^k} = V$.

אם
$\ker\prs{T^i} = \ker\prs{T^{i+1}}$
נראה כי
$T^i = 0$.
אחרת, יש
$j > i$
עבורו
$\ker\prs{T^j} \supsetneq \ker\prs{T^i}$.
ניקח
$j$
מינימלי כזה וניקח
$v \in \ker\prs{T^j} \setminus \ker\prs{T^i}$.
נכתוב
$j = i + r$
ואז
\begin{align*}
T^{i+1}\prs{T^{r-1}\prs{v}} &= T^{i+r}\prs{v} = T^j\prs{v} = 0 \\
T^i\prs{T^{r-1}\prs{v}} &= T^{i+r-1}\prs{v} = T^{j-1}\prs{v} \neq 0
\end{align*}
כאשר
$T^0 = \id_V$
וכאשר
$T^{j-1}\prs{v} \neq 0$
כי
$v \notin \ker\prs{T^i} = \ker\prs{T^{j-1}}$.
\end{solution}

\begin{exercisechap}
תהי
$T$
נילפוטנטית מאינדס
$k$.
הראו שהעתקות
$\prs{\id_V \pm T}$
הפיכות ומצאו את ההופכיות שלהן.
\end{exercisechap}

\begin{solution}
אנו יודעות כי
\[\sum_{k \in \mbb{N}} r^k = \frac{1}{1-r}\]
עבור
$r < 0$.
נרצה אם כן שההופכית של
$\id_V - T$
תהיה
$\id_V + T + \ldots + T^{k-1}$.
אכן,
\begin{align*}
\prs{\id_V - T}\prs{\id_V + T + \ldots + T^{k-1}} &= \sum_{i = 0}^{k-1} T^{i} - \sum_{i = 1}^k T^^i
\\&= \id_V - T^k
\\&= \id_V - 0
\\ \text{.} \hphantom{\prs{\id_V - T}\prs{\id_V + T + \ldots + T^{k-1}}} &= \id_V
\end{align*}

כעת, אם
$T$
נילפוטנטית מאינדקס
$k$
גם
$-T$
נילפוטנטית מאינדקס
$k$,
לכן ההופכית של
$\id_V + T = \id_V - \prs{-T}$
היא
\[\text{.} \id_V - T + T^2 - T^3 + \ldots + \prs{-1}^{k-1} T^{k-1}\]
\end{solution}

\subsection{מציאת בסיס ז'ורדן עבור אופרטורים נילפוטנטיים}

\begin{definition}[אופרטור הזזה]
יהי
$V$
מרחב וקטורי עם בסיס
$B = \prs{v_1, \ldots, v_n}$
ויהי
$T \in \End_{\mbb{F}}\prs{V}$.
נגיד כי
$T$
\emph{אופרטור הזזה ביחס לבסיס
$B$}
אם מתקיים
\[\text{,} T\prs{v_i} = \fcases{v_{i-1} & i > 1 \\ 0 & i = 1}\]
או באופן שקול אם
$\brs{T}_B = J_n\prs{0}$.
\end{definition}

כדי למצוא בסיס ז'ורדן עבור אופרטור הזזה, נרצה למצוא וקטור
$v \in V$
עבורו
$T^n\prs{v} = 0$
אבל
$T^{n-1}\prs{v} \neq 0$,
ואז
$\prs{T^{n-1}\prs{v}, T^{n-2}\prs{v}, \ldots, T\prs{v}, v}$
יהיה בסיס ז'ורדן.

\begin{exercisechap}
תהי
\begin{align*}
A = \pmat{0 & 1 & 0 \\ 1 & 1 & 1 \\ -1 & -2 & -1} \in \Mat_3\prs{\mbb{C}}
\end{align*}
ויהי
$T = T_A \in \End_{\mbb{C}}\prs{\mbb{C}^3}$.
מיצאו בסיס ז'ורדן עבור
$T$.
\end{exercisechap}

\begin{solution}
מתקיים
\begin{align*}
A^2 &= \pmat{1 & 1 & 1 \\ 0 & 0 & 0 \\ -1 & -1 & -1} \\
A^3 &= 0
\end{align*}
ולכן
$A$
נילפוטנטית מסדר
$3 = \dim_{\mbb{C}}\prs{\mbb{C}^3}$.
מתקיים
$\ker\prs{T^2} = \Span\prs{e_1 - e_2, e_1 - e_3}$
כי שני הוקטורים נמצאים בגרעין וכי
$\dim\ker\prs{T^2} = 3 - \rank\prs{A^2} = 2$.
ניקח
$v \in \ker\prs{T^3} \setminus \ker\prs{T^2}$
ואז יתקיים
$T^3\prs{v} = 0$
וגם
$T^2\prs{v} \neq 0$.
למשל, ניקח
$v = e_1$,
ואת הבסיס
\[\text{.} \prs{T^2\prs{e_1}, T\prs{e_1}, e_1} = \prs{e_1 - e_3, e_2 - e_3, e_1}\]
\end{solution}

כעת, יתכנו אופרטורים נילפוטנטיים שאינם אופרטורי הזזה. באופן כללי, עבור אופרטורים כאלה, נשלים בסיס של
$\ker\prs{T^{k-1}}$
לבסיס של
$\ker\prs{T^k}$
ונסתכל על
\emph{השרשראות}
$\prs{T^{k-1}\prs{v}, \ldots, T\prs{v}, v}$
שמתקבלות מהוקטורים המתאימים. אם שרשור השרשראות מאורך ששווה למימד של
$V$,
נקבל בסיס ז'ורדן
\[\text{.}\prs{T^{k-1}\prs{v_1}, \ldots, T\prs{v_1}, v_1, T^{k-1}\prs{v_2}, \ldots, T\prs{v_2}, v_2, \ldots, T^{k-1}\prs{v_k}, \ldots, T\prs{v_k}, v_k}\]
אבל, יתכן שזה לא המצב. במקרה זה, נחפש שרשראות קצרות יותר, שיתחילו בוקטורים באיזשהו
$v \in \ker\prs{T^i} \setminus \ker\prs{T^{i-1}}$
ויהיו מהצורה
\[\text{.} \prs{T^{i-1}\prs{v}, \ldots, T\prs{v}, v}\]
נראה בהמשך נוסחא לחישוב מספר בלוקי ז'ורדן מכל גודל, וכיוון שכל שרשרת כזאת תתאים לבלוק ז'ורדן, נוכל לדעת בדיוק אילו ערכי
$i$
לבדוק.

\begin{exercisechap}
יהי
$V = \mbb{C}^7$,
יהי
$T \in \End_{\mbb{C}}\prs{V}$
אופרטור הזזה ביחס לבסיס הסטנדרטי, ויהי
$S = T^3$.
מיצאו בסיס ז'ורדן עבור
$S$.
\end{exercisechap}

\begin{solution}
נשים לב ראשית שמתקיים
\begin{align*}
\text{.} S\prs{e_i} = \fcases{e_{i-3} & i > 3 \\
0 & i \leq 3}
\end{align*}
מתקיים אם כן
$S^2\prs{e_7} = e_{7-2 \cdot 3} = e_1 \neq 0$
וגם
$S^3 = 0$
ולכן
$S$
נילפוטנטי מאינדקס
$3$.
מתקיים
$\ker\prs{S^2} = \Span\prs{e_1, \ldots, e_6}$.
ניקח
$e_7 \in \ker\prs{S^3} \setminus \ker\prs{S^2}$
שיתאים לשרשרת ז'ורדן
$\prs{S^2\prs{e_7}, S\prs{e_7}, e_7} = \prs{e_1, e_4, e_7}$.
אורך השרשרת הוא
$3$
ואילו
$\dim_{\mbb{C}}\prs{\mbb{C}^7} = 7$,
ולכן יש למצוא עוד שרשראות ז'ורדן.

מתקיים
$\dim \ker\prs{S^2} - \dim \ker\prs{S} = 6-3 = 3$,
ואילו השרשרת שמצאנו ``תורמת'' וקטור יחיד ל־%
$\ker\prs{S^2} \setminus \ker\prs{S}$,
לכן נחפש עוד שני וקטורים כאן, שיפתחו שרשראות נוספות.
מתקיים
$e_5, e_6 \in \ker\prs{S^2} \setminus \ker\prs{S}$
ושני וקטורים אלו יחד בלתי תלויים בשרשרת
$\prs{e_1, e_4, e_7}$
שמצאנו. נשרשר את השרשרת שמצאנו עם השרשראות
$\prs{S\prs{e_5}, e_5}, \prs{S\prs{e_6},e_6}$
ונקבל בסיס ז'ורדן
\[B = \prs{e_1, e_4, e_7, e_2, e_5, e_3, e_6}\]
שעבורו
\[\text{.} \brs{T}_B = \pmat{J_3\prs{0} & & \\ & J_2\prs{0} & \\ & & J_2\prs{0}}\]
נשים לב שהבלוק מגודל
$3$
מופיע ראשון בדיוק כי השרשרת מאורך
$3$
היא זאת שכתבנו ראשונה. אם היינו משנות את סדר השרשראות, היה משתנה סדר הבלוקים.
\end{solution}

\begin{exercisechap}
\begin{enumerate}
\item הראו כי
$J_n\prs{\lambda}^t \cong J_n\prs{\lambda}$,
מעל
$\mbb{C}$.
\item הסיקו כי
$A \cong A^t$
לכל
$A \in \Mat_n\prs{\mbb{C}}$.
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
\item
נכתוב
$T = T_{J_n\prs{\lambda}^t}$
ונרצה למצוא בסיס
$B$
עבורו
$\brs{T}_B = J_n\prs{\lambda}$.
נניח תחילה כי
$\lambda = 0$
כשבמקרה זה מתקיים
\[\text{.} T\prs{e_i} = \fcases{e_{i+1} & i < n \\ 0 & i = n}\]
אז הבסיס
$B = \prs{e_n, e_{n-1}, \ldots, e_2, e_1}$
מקיים את הנדרש.

באופן כללי,
\[T = T_{J_n\prs{0}^t + \lambda I} = T_{J_n\prs{0}^t} + \lambda \id_{\mbb{C}^n}\]
ולכן
\[\brs{T}_B = \brs{T_{J_n\prs{0}^t}}_B + \lambda \brs{\id_{\mbb{C}^n}}_B = J_n\prs{0} + \lambda I = J_n\prs{\lambda}\]
ולכן הבסיס
$B$
עדיין עובד.

\item
ממשפט ז'ורדן, קיימת מטריצה הפיכה
$P \in \Mat_n\prs{\mbb{C}}$
עבורה
$P^{-1} A P = \diag{J_{m_1}\prs{\lambda_1}, \ldots, J_{m_k}\prs{\lambda_k}}$
מטריצה אלכסונית בלוקים עם בלוקים
$J_{m_i}\prs{\lambda_i}$.
אז
\[\text{.} P^t A^t \prs{P^t}^{-1} = \diag\prs{J_{m_1}\prs{\lambda_1}^t, \ldots, J_{m_k}\prs{\lambda_k}^t}\]
כעת,
$J_{m_1}\prs{\lambda_1}^t \cong J_{m_1}\prs{\lambda_1}$ 
ולכן קיימות מטריצות
$Q_i \in \Mat_n\prs{\mbb{C}}$
הפיכות עבורן
$Q_i^{-1} J_{m_i}\prs{\lambda_i}^t Q_i = J_{m_i}\prs{\lambda_i}$.
ולכן אם נסמן
$Q \coloneqq \diag\prs{Q_1, \ldots, Q_n}$
נקבל כי
\begin{align*}
Q^{-1} \prs{P^t A^t \prs{P^t}^{-1}} Q &=
Q^{-1} \diag\prs{J_{m_1}\prs{\lambda_1}^t, \ldots, J_{m_k}\prs{\lambda_k}^t} Q
\\&= \diag\prs{Q_1^{-1} J_{m_1}\prs{\lambda_1}^t Q_1, \ldots, Q_k^t J_{m_k}\prs{\lambda_k}^t Q_k}
\\&= \diag\prs{J_{m_1}\prs{\lambda_1}, \ldots, J_{m_k}\prs{\lambda_k}}
\\&= P^{-1} A P
\end{align*}
כלומר
\[A = \prs{P Q^{-1} P^t} A^t \prs{\prs{P^t}^{-1} Q P^{-1}} = \prs{P Q^{-1} P^t} A^t \prs{P Q^{-1} P^t}^{-1}\]
ולכן
$A \cong A^t$.
\end{enumerate}
\end{solution}

\section{משפט ז'ורדן הכללי}

לאחר שהבנו כיצד למצוא בסיס ז'ורדן עבור אופרטורים נילפוטנטיים, נוכל לדבר על אופרטורים כלליים. אם
$\lambda_1, \ldots, \lambda_k$
הערכים העצמיים השונים של
$T \in \End_{\mbb{F}}\prs{V}$,
נוכל לכתוב
\[V = V_{\lambda_1}' \oplus \ldots \oplus V_{\lambda_k}'\]
כאשר
$V_{\lambda_i}'$
\emph{מרחבים עצמיים מוכללים},
שהינם
$T$%
־שמורים. כדי למצוא את הבלוקים עם ערך עצמי
$\lambda_i$
נסתכל על
$\left. T \right|_{V_{\lambda_i}'} - \id_{V_{\lambda_i}'}$
שהינו אופרטור נילפוטנטי על
$V_{\lambda_i}'$,
וניעזר באלגוריתם למציאת בסיס ז'ורדן למקרה הנילפוטנטי.

\begin{definition}[מרחב עצמי מוכלל]
יהי
$V$
מרחב וקטורי סוף־מימדי ויהי
$T \in \End_{\mbb{F}}\prs{V}$.
נסמן
$n \coloneqq \dim_{\mbb{F}}\prs{V}$.
\emph{המרחב העצמי המוכלל}
של
$\lambda \in \mbb{F}$
עבור
$T$
הוא
\[\text{.} V_{\lambda}' \coloneqq \ker\prs{\prs{T - \lambda \id_V}^n}\]
\end{definition}

\begin{theorem}[פירוק למרחבים עצמיים מוכללים]
יהי
$V$
מרחב וקטורי סוף־מימדי מעל שדה סגור אלגברית, יהי
$T \in \End_{\mbb{F}}\prs{V}$
ויהיו
$\lambda_1, \ldots, \lambda_k \in \mbb{F}$
הערכים העצמיים השונים של
$T$.
אז
$V_{\lambda_i}'$
הינו
$T$%
־שמור לכל
$i \in [k]$,
וגם
\[\text{.} V = \bigoplus V_{\lambda_i}'\]
\end{theorem}

לפני שנתאר את האלגוריתם הכללי, נזכיר תכונות שראינו בהרצאה.

\begin{proposition}
יהי
$V$
מרחב וקטורי סוף־מימדי מעל שדה סגור אלגברית, ויהי
$T \in \End_{\mbb{F}}\prs{V}$.

\begin{enumerate}
\item 
מספר הבלוקים עם ערך עצמי
$\lambda \in \mbb{F}$
בצורת ז'ורדן של
$T$
הוא
$r_g\prs{\lambda}$,
וסכום גדלי הבלוקים עם ערך עצמי
$\lambda$
הוא
$r_a\prs{\lambda}$.

\item
הבלוק המקסימלי עם ערך עצמי
$\lambda$
בצורת ז'ורדן של
$T$
שווה לאינדקס הנילפוטנטיות של
$\left. T \right|_{V'_\lambda} - \id_{V'_\lambda}$
כאשר
$V'_\lambda$
המרחב העצמי המוכלל של
$\lambda$
עבור
$T$.

\item מספר הבלוקים עם ערך עצמי
$\lambda$
שהינם מגודל לפחות
$r$
הוא
\[\text{.} \dim \ker\prs{\prs{T - \lambda \id_V}^r} - \dim \ker\prs{\prs{T - \lambda \id_V}^{r-1}}\]

\item מספר הבלוקים עם ערך עצמי
$\lambda$
מגודל בדיוק
$r$
הוא
\[\text{.} 2 \dim \ker\prs{\prs{T - \lambda \id_V}^r} - \dim \ker\prs{\prs{T - \lambda \id_V}^{r+1}} - \dim \ker\prs{\prs{T - \lambda \id_V}^{r-1}}\]
\end{enumerate}
\end{proposition}


\subsection{מציאת בסיס ז'ורדן עבור אופרטור כללי}

יהי
$V$
מרחב וקטורי ממימד סופי
$n$
מעל שדה סגור אלגברית
$\mbb{F}$,
יהי
$T \in \End_{\mbb{F}}\prs{V}$,
ויהיו
$\lambda_1, \ldots, \lambda_k$
הערכים העצמיים השונים של
$T$.
כדי למצוא בסיס ז'ורדן עבור
$T$
נסתכל על כל ערך עצמי בנפרד. לכל ערך עצמי
$\lambda$
האופרטור
$\left. T \right|_{V'_\lambda} - \id_{V'_\lambda}$
נילפוטנטי ולכן מהאלגוריתם במקרה הנילפונטי נוכל לקבל בסיס ז'ורדן
$B_\lambda$
עבורו. נשרשר את כל הבסיסים הללו ונקבל בסיס ז'ורדן
$B = B_{\lambda_1} \cup \ldots \cup B_{\lambda_k}$
עבור
$T$.

\begin{exercisechap}
ידוע כי כל הערכים העצמיים של
\[A \ceq \pmat{1 & 1 & 0 & 0 & 0 & 0 \\
-1 & 3 & 0 & 0 & 0 & 0 \\
-1 & 0 & 2 & 1 & 0 & 0 \\
-1 & 0 & -1 & 3 & 1 & 0 \\
-1 & 0 & -1 & 0 & 4 & 0 \\
-1 & 0 & -1 & 0 & 2 & 2} \in \Mat_6\prs{\mbb{C}}\]
רציונליים.
מצאו צורת ובסיס ז'ורדן עבור
$A$.
\end{exercisechap}

\begin{solution}
נסמן
$V = \mbb{C}^6$.

חישוב ישיר נותן
\[\text{.} p_A\prs{x} = \det\prs{xI - A} = x^6 - 15x^5 + 93x^4 - 305x^3 + 558x^2 - 540x + 216\]
ממשפט ניחוש השורש הרציונלי אפשר למצוא את השורשים ולקבל
\[\text{.} p_A\prs{x} = \prs{x-2}^3 \prs{x-3}^3\]

נסתכל על הערכים העצמיים
$2,3$
בנפרד.

\begin{description}
\item[$\lambda = 3$:]
מתקיים
\[\prs{A-3I} = \pmat{-2 & 1 & 0 & 0 & 0 & 0 \\
-1 & 0 & 0 & 0 & 0 & 0 \\
-1 & 0 & -1 & 1 & 0 & 0 \\
-1 & 0 & -1 & 0 & 1 & 0 \\
-1 & 0 & -1 & 0 & 1 & 0 \\
-1 & 0 & -1 & 0 & 2 & -1}\]
ומרחב הפתרונות של המערכת ההומוגנית הוא
\[\text{.} \ker\prs{T_A - 3\id_V} = \spn\set{\pmat{0\\0\\1\\1\\1\\1}}\]
חישוב ישיר נותן כי
\[\ker\prs{\prs{T_A - 3\id_V}^2} = \spn\set{\pmat{0\\0\\1\\1\\1\\1}, e_3}\]
וגם
\[\text{.} \ker\prs{\prs{T_A - 3\id_V}^3} = \spn\set{\pmat{0\\0\\1\\1\\1\\1}, e_3, e_4}\]
אז,
$e_4$
פותח שרשרת ז'ורדן
\[\text{.} B_3 = \pmat{\prs{A-3I}^2 e_4, \prs{A-3I}e_4, e_4} = \pmat{\pmat{0\\0\\-1\\-1\\-1\\-1}, e_3, e_4}\]

\item[$\lambda = 2$:]
מתקיים
\[\ker\prs{T_A - 2\id_V} = \spn\set{e_6, \pmat{1\\1\\1\\1\\1\\0}}\]
ולכן יש ל־%
$2$
ריבוי גיאומטרי
$2$.
אז יש שני בלוקי ז'ורדן עבור הערך העצמי
$2$,
ולכן השרשרת המקסימלית מגודל
$2$.
אפשר לראות כי סכום העמודות של
\[A - 2I = \pmat{-1 & 1 & 0 & 0 & 0 & 0 \\
-1 & 1 & 0 & 0 & 0 & 0 \\
-1 & 0 & 0 & 1 & 0 & 0 \\
-1 & 0 & -1 & 1 & 1 & 0 \\
-1 & 0 & -1 & 0 & 2 & 0 \\
-1 & 0 & -1 & 0 & 2 & 0}\]
שווה
$0$,
ולכן
$e_1 \in \ker\prs{\prs{T_A - \id_V}^2}$
ונקבל
\[\text{.} \ker\prs{\prs{T_A - \id_V}^2} = \spn\set{e_6, \pmat{1\\1\\1\\1\\1\\0}, e_1}\]
אז
$e_1$
מתחיל שרשרת ז'ורדן
\[\text{.} \prs{\prs{A-2I} e_1, e_1} = \prs{\pmat{-1\\-1\\-1\\-1\\-1\\-1}, e_1}\]

חסרה שרשרת ז'ורדן מאורך
$1$
עבור
$\lambda = 2$.
היא וקטור עצמי של
$2$
שאינו תלוי ב־%
$\prs{\prs{A-2I} e_1, e_1}$.
למשל,
$e_6$
הוא כזה וקטור עצמי.

נקבל בסיס ז'ורדן
\[B_2 \coloneqq \prs{\pmat{-1\\-1\\-1\\-1\\-1\\-1}, e_1, e_6}\]
של
$\left. T \right|_{V'_2}$.

\item[סיכום:]
נסדר את השרשראות השונות בבסיס ונקבל בסיס ז'ורדן
\[
B = \pmat{\pmat{0\\0\\-1\\-1\\-1\\-1}, e_3, e_4, \pmat{-1\\-1\\-1\\-1\\-1\\-1}, e_1, e_6}
\]
לפיו
\[\text{.} \brs{T_A}_B = \mrm{diag}\prs{J_3\prs{3}, J_2\prs{2}, J_1\prs{2}}\]
\end{description}

\end{solution}

נזכיר כי ראינו כיצד לחשב חזקות של בלוק ז'ורדן. המטריצה
$J_n\prs{0}^r$
היא מטריצה עם
$0$
מחוץ לאלכסון ה־%
$r$
מעל האלכסון הראשי, ו־%
$1$
על אלכסון זה (או מטריצת האפס, אם
$r \geq n$).
כמו כן,
\begin{align*}
\text{.} J_n\prs{\lambda}^r = \pmat{\lambda^r & \pmat{r \\ 1} \lambda^{r-1} & \pmat{r \\ 2} \lambda^{r-2} & \cdots & \\ & \lambda^r & \ddots & & \vdots \\ & & \ddots & \ddots & \pmat{r\\2}\lambda^{r-2} \\ & & & \lambda^r & \pmat{r \\ 1} \lambda^{r-1} \\ & & & & \lambda^r}
\end{align*}
לכן, חישוב חזקות של מטריצות ז'ורדן הינו פשוט למדי. נוכל להיעזר בו כדי לחשב חזקות של מטריצות כלליות.

\begin{exercisechap}
תהי
\[\text{.} A \ceq \pmat{2 & 4 & 0 \\ -1 & -2 & 0 \\ 8 & 7 & 9} \in \Mat_3\prs{\mbb{C}}\]
חשבו את
$A^{2022}$.
\end{exercisechap}

\begin{solution}
נסמן
$V = \mbb{C}^3$
ונמצא בסיס ז'ורדן
$B$
עבור
$A$.
אז נקבל
$P \in \Mat_3\prs{\mbb{C}}$
עבורה
$J \ceq P A P^{-1}$
מטריצת ז'ורדן, ואז
\begin{align*}
A^{2022} &= \prs{P^{-1}JP}^{2022}
= P^{-1}J^{2022}P
\end{align*}
כאשר מהחישוב הנ"ל נדע לחשב את
$J^{2022}$.

\begin{description}
\item[ערכים עצמיים:]
ניתן לראות כי
$9$
ערך עצמי של
$A$
כי
$A e_3 = 9 e_3$.
נסמן ב־%
$\lambda_1, \lambda_2$
את הערכים העצמיים הנוספים ונקבל
\begin{align*}
\lambda_1 + \lambda_2 + 9 = \tr\prs{A} = 9 \\
9 \lambda_1 \lambda_2 = \det\prs{A} = 9\prs{-4+4} = 0
\end{align*}
לכן
$\lambda_1 = \lambda_2 = 0$.

נקבל כי
$9$
ערך עצמי מריבוי אלגברי
$1$
וכי
$0$
ערך עצמי מריבוי אלגברי
$2$.
בפרט,
$\prs{e_3}$
שרשרת ז'ורדן עבור הערך העצמי
$9$.
\item[שרשרת ז'ורדן עבור
$\lambda = 0$:]
ניתן לראות כי
$r\prs{A} = 2$
ולכן
$\dim \ker \prs{T_A} = 1$.
נשים לב כי
\[2 e_1 - e_2 - e_3 \in \ker\prs{L_A}\]
ולכן
\[\text{.} \ker\prs{T_A} = \spn\prs{2 e_1 - e_2 - e_3}\]
מתקיים
\[A^2 = \pmat{0 & 0 & 0 \\ 0 & 0 & 0 \\ 81 & 81 & 81}\]
לכן נוכל להשלים את
$\prs{2 e_1 - e_2 - e_3}$
לבסיס
\[\prs{2 e_1 - e_2 - e_3, e_1 - e_3}\]
של
$\ker\prs{T_A^2}$.
מתקיים
\[A \prs{e_1 - e_3} = 2e_1 - e_2 - e_3\]
לכן נקבל שרשרת ז'ורדן
\[\text{.} \prs{A\prs{e_1 - e_3}, e_1 - e_3} = \prs{2e_1 - e_2 - e_3, e_1 - e_3}\]

\item[מסקנה:]
קיבלנו
\[B \ceq \prs{2e_1 - e_2 - e_3, e_1 - e_3, e_3}\]
עבורו
\[\brs{T_A}_B = J \ceq \pmat{0 & 1 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & 9}\]
ולכן
\begin{align*}
\text{.} A &= \brs{T_A}_E
= \brs{\id_V}^{B}_E \brs{T_A}_B \brs{\id_V}^E_B
\end{align*}
נסמן
\[P \ceq \brs{\id_V}^B_E = \pmat{2 & 1 & 0 \\ -1 & 0 & 0 \\ -1 & -1 & 1}\]
שעמודותיה הן וקטורי הבסיס
$B$,
ונקבל
\[\text{.} A = P J P^{-1}\]
אז
\begin{align*}
A^{2022} &= P J^{2022} P^{-1}
\\&= \pmat{2 & 1 & 0 \\ -1 & 0 & 0 \\ -1 & -1 & 1} \pmat{0 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & 9^{2022}} \pmat{0 & -1 & 0 \\ 1 & 2 & 0 \\ 1 & 1 & 1}
\\ \text{.} \hphantom{A^{2022}} &= \pmat{0 & 0 & 0 \\ 0 & 0 & 0 \\ 9^{2022} & 9^{2022} & 9^{2022}}
\end{align*}
\end{description}
\end{solution}

\section{הפולינום המינימלי ופירוק פרימרי}

כאשר
$V$
מרחב וקטורי מעל שדה סגור אלגברית
$\mbb{F}$,
ו־%
$T \in \End_{\mbb{F}}\prs{V}$,
ראינו כי
$V$
הינו סכום ישר של המרחבים העצמיים המוכללים של
$T$.
\begin{align*}
\text{.} V = V'_{\lambda_1} \oplus \ldots \oplus V'_{\lambda_k}
\end{align*}
כאן
\[V'_{\lambda} = \ker\prs{\prs{T - \lambda \id_V}^{r_i}}\]
עבור ערכים שלמים
$r_i$.
נקבל כי עבור
$p\prs{x} = \prs{x - \lambda_1}^{r_1} \cdot \ldots \cdot \prs{x- \lambda_k}^{r_k}$
מתקיים
$p\prs{T} = 0$,
וכי כל פולינום
$q$
עבורו
$q\prs{T} = 0$
הוא כפולה של
$p$.

\begin{definition}[פולינום מינימלי]
יהי
$T \in \End_{\mbb{F}}\prs{V}$.
\emph{הפולינום המינימלי}
של
$T$
הוא הפולינום
$m_T \in \mbb{F}\brs{x}$
המתוקן מהמעלה המינימלית עבורו
$m_T\prs{T} = 0$.
\end{definition}

\begin{proposition}
הפולינום המינימלי קיים, ואם
$q\prs{T} = 0$
אז
$m_T \mid q$.
\end{proposition}

\begin{example}
במקרה שיש ל־%
$T$
צורת ז'ורדן (למשל, אם השדה סגור אלגברית), הפולינום המינימלי יהיה בדיוק
\[m_T\prs{x} = \prod_{i \in [k]} \prs{x - \lambda_i}^{r_i}\]
כאשר
$\lambda_i$
הערכים העצמיים, ו־%
$r_i$
גודל הבלוק המקסימלי עם ערך עצמי
$\lambda_i$.
אכן, אם
$J_{m_i}\prs{\lambda_i}$
בלוק בצורת ז'ורדן של
$T$,
נקבל
$m_T\prs{J_{m_i}\prs{\lambda_i}} = 0$
כי אחד הגורמים בכפל הזה הוא
\[\text{.} \prs{J_{m_i}\prs{\lambda_i} - \lambda_i I_{m_i}}^{r_i} = J_{m_i}\prs{0}^{r_i} = 0\]
אם היה איזהשהו
$r_j < m_j$
היה מתקבל
\[m_T\prs{J_{m_j}\prs{\lambda_j}} = \prod_{i \in [k]} \prs{J_{m_j}\prs{\lambda_j} - \lambda_i I_{m_j}}^{r_i}\]
כאשר
$J_{m_j}\prs{\lambda_j} - \lambda_i I_{m_j}$
הפיכה לכל
$j \neq i$
ונילפוטנטית מאינדקס
$m_i$
שגדול מ־%
$r_i$
כאשר
$j = i$.
לכן במקרה זה היה מתקבל
$m_T\prs{J_{m_j}\prs{\lambda_j}} \neq 0$
ולכן לא יתכן ש־%
$J_{m_j}\prs{\lambda_j}$
בלוק בצורת ז'ורדן של
$T$,
בסתירה.
\end{example}

\begin{example}
נניח כי
$T \in \End_{\mbb{F}}\prs{V}$
עם פולינום אופייני
$p_T\prs{x} = x \prs{x-1}$.
אז
$m_T \mid p_T$
כי
$p_T\prs{T} = 0$
ממשפט קיילי־המילטון.
מההנחה על הפולינום האופייני, יש וקטורים עצמיים
$v_0, v_1$
עם ערכים עצמיים
$0,1$
בהתאמה.
אם
$m_T\prs{x} = x$
נקבל
\[0 = m_T\prs{T}\prs{v_1} = T\prs{v_1} = v_1\]
בסתירה.
אם
$m_T\prs{x} = x-1$
נקבל
\[0 = m_T\prs{T}\prs{v_0} = \prs{T - \id_V}\prs{v_0} = T\prs{v_0} - v_0 = -v_0\]
בסתירה.
לכן
$m_T\prs{x} = x\prs{x-1}$.

באופן כללי, יותר, אם
\[p_T\prs{x} = \prod_{i \in [k]} g_i^{r_i}\]
פירוק לגורמים אי־פריקים זרים, נקבל כי
\[m_T\prs{x} = \prod_{i \in [k]} g_i^{s_i}\]
עבור
$s_i \in \brs{r_i}$.
בפרט, כאשר הפולינום האופייני מתפרק לגורמים לינארים נקבל כי
$m_T\prs{x} = p_T\prs{x}$.
\end{example}

\begin{exercisechap}
יהי
$\mbb{F} = \mbb{C}$
ותהי
$T \in \endo_{\mbb{F}}\prs{V}$.
יהי
$m \in \mbb{N}_+$
עבורו
$T^m = \id_V$.
הראו כי
$T$
לכסין.
\end{exercisechap}

\begin{solution}
כדי להראות ש־%
$T$
לכסין מספיק להראות שכל שורשי
$m_T$
הינם מריבוי
$1$.
מההנחה, מתקיים
$m_T \mid \prs{x^m - 1}$
ולכן די להראות שכל שורשי
$x^m - 1$
הם מריבוי
$1$.
אכן, יש לפולינום זה
$m$
שורשים שונים
\[\text{.} \set{e^{\frac{2 \pi i k}{m}}}{k \in [m]} = \set{\mrm{cis}\prs{\frac{2 \pi k}{m}}}{k \in [m]}\]
\end{solution}

\begin{exercisechap}
\begin{enumerate}
\item
תהיינה
$A,B \in \Mat_6\prs{\mbb{C}}$
המקיימות
\begin{enumerate}[label = (\roman*)]
\item $p_A = p_B$.
\item $m_A = m_B$
וזהו פולינום ממעלה
$5$.
\end{enumerate}
הראו כי
$A \sim B$.

\item
מצאו
$A,B \in \Mat_6\prs{\mbb{C}}$
שאינן דומות וכך שמתקיים
\begin{enumerate}[label = (\roman*)]
\item $p_A = p_B$.
\item $m_A = m_B$
וזהו פולינום ממעלה
$4$.
\end{enumerate}
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
\item נתון
$\deg m_A = 5$,
וזהו סכום גדלי הבלוקים המקסימליים של הערכים העצמיים השונים של
$A$.
לכן יש ערך עצמי
$\lambda$
מריבוי גיאומטרי
$2$
ובלוק מגודל
$1$,
וכל ערך עצמי אחר הוא מריבוי גיאומטרי
$1$.
אז
\[\text{.} A \sim \pmat{\lambda & 0 & \cdots & & 0 \\ 0 & J_m\prs{\lambda_1} & \ddots & & \\ \vdots & \ddots & \ddots & & \vdots \\ & & & \ddots & 0 \\ 0 & & \cdots & 0 & J_{m_r}\prs{\lambda_r}}\]
נתון
$m_A = m_B$
לכן באותו אופן
\[B \sim \pmat{\lambda & 0 & \cdots & & 0 \\ 0 & J_m\prs{\lambda_1} & \ddots & & \\ \vdots & \ddots & \ddots & & \vdots \\ & & & \ddots & 0 \\ 0 & & \cdots & 0 & J_{m_r}\prs{\lambda_r}}\]
ונסיק כי
$A \sim B$.

\item נסתכל על
\begin{align*}
A &\ceq \pmat{J_1\prs{0} & & \\  & J_1\prs{0} & \\ & & J_4\prs{0}} \\
B &\ceq \pmat{J_2\prs{0} & \\ & J_4\prs{0}}
\end{align*}
ונקבל
$m_A = m_B = x^4$
אבל
$A \not\sim B$
כי יש להן צורת ז'ורדן שונה.

\end{enumerate}
\end{solution}

מעל שדה כללי, יתכן שלא תהיה צורת ז'ורדן. במקרה זה, במקום פירוק למרחבים עצמיים מוכללים, נקבל פירוק כללי היותר הנקרא
\emph{פירוק פרימרי}.

\begin{theorem}[פירוק פרימרי]
יהי
$T \in \End_{\mbb{F}}\prs{V}$
ויהי
\[m_T = \prod_{i \in [k]} p_i^{r_i}\]
פירוק של הפולינום המינימלי
$m_T$
של
$T$
לגורמים אי־פריקים (כלומר, אם
$p_i = f \cdot g$,
לפחות אחד מבין
$f,g$
קבוע).
לכל
$i \in [k]$
יהי
$V_i \coloneqq \ker\prs{p_i^{r_i}\prs{T}}$.
מתקיים
\[V = \bigoplus_{i \in [k]} V_i\]
וההטלות על
$V_i$
נתונות על ידי פולינומים ב־%
$T$.
\end{theorem}

הרבה תרגילים מעניינים על פירוק פרימרי מצריכים שימוש
\emph{בפולינום מינימלי ביחס לוקטור},
לכן נגדיר זאת לפני שנעבור לתרגיל.

\begin{definition}[פולינום מינימלי ביחס לוקטור]
יהי
$T \in \End_{\mbb{F}}\prs{V}$
ויהי
$v \in V$.
\emph{הפולינום המינימלי של
$T$
ביחס לוקטור
$v$},
שיסומן
$m_{T,v}$,
הוא הפולינום המתוקן מהמעלה המינימלית עבורו
$m_{T,v}\prs{T}\prs{v} = 0$.
\end{definition}

\begin{fact}
בדומה לתכונה של
$m_T$,
אם
$p\prs{T}\prs{v} = 0$
אז
$m_{T,v} \mid p$.
\end{fact}

\begin{corollary}
תמיד מתקיים
$m_T\prs{T}\prs{v} = 0$
כי
$m_T\prs{T} = 0$,
לכן
$m_{T,v} \mid m_T$.
\end{corollary}

\begin{exercisechap}
יהי
$V$
מרחב וקטורי סוף־מימדי מעל שדה
$\mbb{F}$,
ויהי
$T \in \End_{\mbb{F}}\prs{V}$
עם פולינום מינימלי
$m_T = \prod_{i \in [k]} g_i^{r_i}$
עבור
$g_i$
אי־פריקים וזרים.
יהי
\[V = \bigoplus_{i \in [k]} W_i = \bigoplus_{i \in [k]} \ker\prs{g_i\prs{T}}^{r_i}\]
הפירוק הפרימרי של
$V$
שמתאים ל־%
$T$
ויהי
$W \leq V$
תת־מרחב
$T$%
־שמור.

הראו שמתקיים
\[\text{.} W = \bigoplus_{i \in [k]} \prs{W \cap W_i}\]
\end{exercisechap}

\begin{solution}
מתקיים
\[m_T\prs{\left. T \right|_W} = \left. m_T\prs{T} \right|_W = 0\]
ולכן
$m_{\left. T \right|_W} \mid m_T$.
נקבל כי
\[m_{\left. T \right|_W} = \prod_{i \in [k]} g_i^{s_i}\]
עבור שלמים אי־שליליים
$s_1, \ldots, s_k$.
הפולינומים
$g_i$
זרים ולכן זהו פירוק לגורמים אי־פריקים של
$m_{\left. T \right|_W}$.
ממשפט הפירוק הפרימרי נקבל כי
\[\text{.} W = \bigoplus_{i \in [k]} \ker\prs{p_i\prs{\left. T \right|_W}^{s_i}}\]

נראה כי
$\ker\prs{p_i\prs{\left. T \right|_W}^{s_i}} = W \cap W_i$
ונקבל את הנדרש.

\begin{itemize}
\item[-]
יהי
$v \in \ker\prs{g_i\prs{\left. T \right|_W}^{s_i}}$.
אז
$v \in W$
ומתקיים
\[\text{.} g_i\prs{T}^{r_i}\prs{v} = g_i\prs{T}^{r_i - s_i} \underset{=0}{\underbrace{g_i\prs{T}^{s_i}\prs{v}}} = 0\]
לכן גם
$v \in \ker\prs{g_i\prs{T}^{r_i}} = W_i$
ולכן
$v \in W \cap W_i$.

\item[-]
יהי
$v \in W \cap W_i$.
אז
$g_i\prs{T}^{r_i}\prs{v} = 0$.
מתקיים תמיד
$m_{\left. T \right|_W, v} \mid m_{\left. T \right|_W}$,
ומהנ"ל
$m_{\left. T \right|_W, v} \mid g_i^{r_i}$.
לכן,
$m_{\left. T \right|_W, } \mid g_i^{s_i}$
כי זאת החזקה הכי גדולה של
$g_i$
ב־%
$m_{\left. T \right|_W}$.
לכן
$g_i\prs{\left. T \right|_W}^{s_i}\prs{v} = 0$
כלומר
$v \in g_i\prs{\left. T \right|_W}^{s_i}$.
\end{itemize}
\end{solution}

\begin{corollary}
יהי
$T \in \End_{\mbb{F}}\prs{V}$
עם צורת ז'ורדן
$\brs{T}_B = \diag\prs{J_{m_1}\prs{\lambda_1}, \ldots, J_{m_k}\prs{\lambda_k}}$
עבור
$\lambda_i$
שונים.
אם
$W \leq V$
הינו
$T$%
־שמור נקבל כי
\[\text{.} W = \bigoplus_{i \in [k]} \prs{W \cap V'_{\lambda_i}}\]
לאופרטור
$\left. T \right|_{V'_{\lambda_i}}$
יש ערך עצמי יחיד
$\lambda_i$
וצורת ז'ורדן
$J_{m_i}\prs{\lambda_i}$
לפי החלק המתאים בבסיס. אם נכתוב
\[B = B_1 \cup \ldots \cup B_k\]
כאשר
\[B_i = \prs{b_{i,1}, \ldots, b_{i,r_i}} = \prs{\prs{T - \lambda_i}^{r_i - 1}\prs{v_i}, \ldots, \prs{T - \lambda_i}\prs{v_i}, v_i}\]
בסיס של
$V'_{\lambda_i}$
נקבל מתרגיל שראינו (או נראה בגיליון התרגילים) כי המרחבים השמורים של
$\left. T \right|_{V'_{\lambda_i}}$
הם אלו מהצורה
$\Span\prs{b_{i,1}, \ldots, b_{i,m}}$
עבור
$m \in \set{0, \ldots, r_i}$.

כיוון ש־%
$\bigoplus_{i \in [k]} \prs{W \cap W_i}$
הינו
$T$%
־שמור אם ורק אם כל אחד מהגורמים הינו
$\left. T \right|_{V'_{\lambda_i}}$%
־שמור, נקבל כי המרחבים השמורים הם אלו מהצורה
\[\Span\prs{b_{1,1}, \ldots, b_{1,m_1}, b_{2,1}, \ldots, b_{2, m_2}, \ldots, b_{k,1}, \ldots, b_{k,m_k}}\]
עבור ערכים
$m_i \in \set{0, \ldots, r_i}$.
\end{corollary}

\part{חלק שני - מרחבי מכפלה פנימית ואלגברה מולטי־לינארית}

\chapter{מרחבי מכפלה פנימית}

\section{מוטיבציה}

נסתכל תחילה על המרחב הוקטורי
$\mbb{R}^n$.
כיוון שנוכל לחשוב על וקטורים ב־%
$\mbb{R}^n$
בתור נקודות במרחב, נוכל לחשוב על המרחק בין שני וקטורים
$u,v \in \mbb{R}^n$,
שנסמנו
$d\prs{u,v}$.

כדי לחשב מרחק כזה, נסתכל על האורך של הקטע המחבר בין
$u,v$,
וזה אותו אורך כמו של הקטע המחבר בין
$0,u-v$.
לכן,
$d\prs{u,v} = d\prs{0,u-v}$.
נקרא למרחק
$d\prs{0,u-v}$
\emph{האורך}
של
$u-v$,
כיוון שזה האורך של הקו המחבר בין
$0,u-v$,
ונסמנו
$\norm{u-v}$
בדומה לסימון
$\abs{z}$
של ערך מוחלט ב־%
$\mbb{C}$.
נוכל להשתמש במשפט פיתגורס כדי לקבל כי
\[\norm{\pmat{v_1 \\ \vdots \\ v_n}} = \sqrt{v_1^2 + \ldots + v_n^2}\]
ולמשל מתקיים
$\norm{\pmat{a\\b}} = \sqrt{a^2 + b^2} = \abs{a + ib}$.

כשמדובר על גיאומטריה אוקלידית, מושג חשוב בנוסף למרחק ואורך הוא זה של זווית. נסתכל על שני וקטורים
$u,v$
באורך
$1$
ועל הישרים
$\ell_u, \ell_v$
שעוברים דרכם.
הקוסינוס
$\cos\prs{\alpha}$
של הזווית מ־%
$\ell_u$
ל־%
$\ell_v$
שווה לאורך של הוקטור שהקצה שלו הוא החיתוך בין
$\ell_u$
לאנך מ־%
$v$
ל־%
$\ell_u$.
נסמן וקטור זה
$\trs{v,u} u$,
כיוון שהוא אכן כפולה של
$u$
מהיותו על
$\ell_u$.
במקרה זה נקרא לו
\emph{ההטלה של
$v$
על
$u$}.
אז יתקיים
\[\cos\prs{\alpha} = \trs{v,u}\]
ולכן
\[\text{.} \alpha = \acos\prs{\trs{v,u}}\]

כדי להכליל את המושג של זווית, נכליל את הביטוי
$\trs{v,u}$
באמצעות ההגדרה הבאה, של מכפלה פנימית.

\section{הגדרות}

\begin{definition}[מכפלה פנימית]
יהי
$V$
מרחב וקטורי מעל
$\mbb{F} \in \set{\mbb{R}, \mbb{C}}$.
\emph{מכפלה פנימית}
על
$V$
היא פונקציה
\begin{align*}
\trs{\cdot,\cdot} \colon V \times V &\to \mbb{F}
\end{align*}
המקיימת את התכונות הבאות.
\begin{description}
\item[חיוביות:]
לכל
$v \in V \setminus \set{0}$
מתקיים
$\trs{v,v} \geq 0$.

\item[סימטריות (הרמיטיות):]
לכל
$u,v \in V$
מתקיים
$\trs{u,v} = \overline{\trs{v,u}}$.

\item[לינאריות ברכיב הראשון:]
לכל
$u,v \in V$
ולכל
$\alpha \in \mbb{F}$
מתקיים
\[\text{.}\trs{\alpha u + v, w} = \alpha\trs{u,w} + \trs{v,w}\]
\end{description}

מרחב וקטורי
$V$
יחד עם מכפלה פנימית
$\trs{\cdot,\cdot}$
נקרא
\emph{מרחב מכפלה פנימית}.
\end{definition}

\begin{remark}
בודגמא מהמרחב האוקלידי, ניתן לראות שנובע מהדרישה הגיאומטרית שלנו כי
\[\trs{u,v} = \sum_{i \in [n]} u_i v_i\]
עבור
$u,v \in \mbb{R}^n$
מאורך
$1$.
נוכל בעצם להגדיר זאת עבור וקטור כללי, ונשים לב כי הדבר אכן מקיים את שלוש התכונות הדרושות, ולכן הינו מכפלה פנימית על
$\mbb{R}^n$.

מכפלה פנימית זאת נקראת
\emph{המכפלה הפנימית הסטנדרטית}
על
$\mbb{R}^n$
ולעתים נסמן אותה
$u \cdot v \coloneqq \trs{u,v}_{\mrm{std}}$.
\end{remark}

\begin{exercisechap}
קיבעו אלו מההעתקות הבאות הן מכפלות פנימיות.

\begin{enumerate}
\item
\begin{align*}
f_1 \colon \mbb{R}^3 \times \mbb{R}^3 \mbb{R} \\
\prs{\pmat{a\\b\\c}, \pmat{x\\y\\z}} &\mapsto ax + by + \prs{cz}^2
\end{align*}

\item
\begin{align*}
f_2 \colon \mbb{R}^4 \times \mbb{R}^4 &\to \mbb{R} \\
\prs{\pmat{a\\b\\c\\d}, \pmat{w\\x\\y\\z}} &\mapsto ax + by + cz 
\end{align*}

\item
\begin{align*}
f_3 \colon \mbb{C}^3 \times \mbb{C}^3 &\to \mbb{C} \\
\prs{\pmat{a\\b\\c}, \pmat{x\\y\\z}} &\mapsto ax + by + cz
\end{align*}

\item
\begin{align*}
f_4 \colon \Mat_n\prs{\mbb{C}} \times \Mat_n\prs{\mbb{C}} &\to \mbb{C} \\
\prs{A,B} &\mapsto \tr\prs{B^t A}
\end{align*}
\end{enumerate}
\end{exercisechap}

\begin{solution}
אף אחת מההעתקות אינה מכפלה פנימית.
\begin{enumerate}
\item
ההעתקה
$f_1$
אינה לינארית ברכיב הראשון, כי
\[f_1\prs{\pmat{0\\0\\1}, \pmat{0\\0\\1}} = 1\]
ואילו
\[\text{.} f_1\prs{\pmat{0\\0\\2}, \pmat{0\\0\\1}} = 2^2 = 4 \neq 2 = 2 f_1\prs{\pmat{0\\0\\1}, \pmat{0\\0\\1}}\]

\item
ההעתקה
$f_2$
אינה חיובית, כי
\[\text{.} f_2\prs{\pmat{0\\0\\0\\1}, \pmat{0\\0\\0\\1}} = 0 \leq 0\]

\item
ההעתקה
$f_3$
אינה הרמיטית, כי
\[f_3\prs{\pmat{0\\0\\1}, \pmat{0\\0\\i}} = i\]
ואילו
\[\text{.} f_3\prs{\pmat{0\\0\\i}, \pmat{0\\0\\1}} = i \neq -i = \bar{i} = \overline{f_3\prs{\pmat{0\\0\\1}, \pmat{0\\0\\i}}}\]
\end{enumerate}

\item
ההעתקה
$f_4$
אינה הרמיטית, כי
$f_4\prs{I_n, iI_n} = \tr\prs{iI_n} = in$
ואילו
\[\text{.} f_4\prs{i I_n, I_n} = \tr\prs{iI_n} =in \neq \overline{in} = \overline{f_4\prs{I_n, iI_n}}\]
\end{solution}

\section{תכונות של מכפלות פנימיות, ונורמות}

במרחב האוקלידי, כאשר
$\norm{u} = \norm{v} = 1$,
אמרנו שהערך
$\abs{\trs{u,v}}$
שווה לאורך של ההטלה של
$v$
על
$u$
(או להיפך, כי המכפלה הפנימית סימטרית).
בפרט, אורך זה יכול להיות לכל היותר
$1$,
והינו שווה
$1$
אם ורק אם
$u = v$,
כי אחרת ההטלה תהיה קצרה יותר.

ניעזר בלינאריות של המכפלה הפנימית ונקבל כי לוקטורים
$u,v \in \mbb{R} \setminus \set{0}$
כלליים מתקיים
\begin{align*}
\abs{\trs{u,v}} &= \trs{\norm{u} \frac{u}{\norm{u}}, \norm{v} \frac{v}{\norm{v}}}
\\&=
\norm{u} \norm{v} \abs{\trs{\frac{u}{\norm{u}}, \frac{v}{\norm{v}}}}
\\&\leq \norm{u} \norm{v}
\end{align*}
כאשר
$\abs{\trs{\frac{u}{\norm{u}}, \frac{v}{\norm{v}}}} \leq 1$
כי הוקטורים
$\frac{u}{\norm{u}}, \frac{v}{\norm{v}}$
הינם מאורך
$1$.

אי־שוויון כזה מתקבל גם במרחב מכפלה פנימית כללי, כפי שקובע אי־שוויון קושי־שוורץ, אך לשם כך עלינו להגדיר מושג של אורך בהגדרה הבאה.

\begin{definition}[נורמה]
יהי
$V$
מרחב מכפלה פנימית מעל
$\mbb{F} \in \set{\mbb{R}, \mbb{C}}$.
\emph{נורמה}
על
$V$
היא פונקציה
$\norm{\cdot} \colon V \to \mbb{R}$
המקיימת את התכונות הבאות.

\begin{description}
\item[חיוביות:]
לכל
$v \in V \setminus \set{0}$
מתקיים
$\norm{v} > 0$.

\item[הומוגניות:]
לכל
$v \in V$
ולכל
$\alpha \in \mbb{F}$
מתקיים
$\norm{\alpha v} = \abs{\alpha} \norm{v}$.

\item[אי־שוויון המשולש:]
לכל
$u,v \in V$
מתקיים
$\norm{u+v} \leq \norm{u} + \norm{v}$.
\end{description}

מרחב וקטורי עם נורמה נקרא
\emph{מרחב נורמי}.
\end{definition}

\begin{theorem}[נורמה המושרית ממכפלה פנימית]
יהי
$V$
מרחב מכפלה פנימית.
הפונקציה
$\norm{v} = \sqrt{\trs{v,v}}$
היא נורמה על
$V$.
נקרא לה
\emph{הנורמה המושרית מהמכפלה הפנימית
$\trs{\cdot,\cdot}$}.
\end{theorem}

\begin{theorem}[אי־שוויון קושי־שוורץ]
יהי
$V$
מרחב מכפלה פנימית. אז לכל
$u,v \in V$
מתקיים
\[\abs{\trs{u,v}} \leq \norm{u} \cdot \norm{v}\]
ושוויון מתקיים אם ורק אם
$u,v$
תלויים לינארית.
\end{theorem}

\begin{exercisechap}
יהי
$V$
מרחב מכפלה פנימית, ויהיו
$u_1, \ldots, u_n, v_1, \ldots, v_n \in V$.
הראו שמתקיים
\begin{align*}
\text{.} \sum_{i = 1}^n \trs{u_i, v_i} \leq \sqrt{{\sum_{i = 1}^n \norm{u_i}^2}} \cdot \sqrt{\sum_{i=1}^n \norm{v_i}^2}
\end{align*}
\end{exercisechap}

\begin{solution}
נרצה לפרש את אגף שמאל בתור מכפלה פנימית.
כיוון שהוא מזכיר את המכפלה הפנימית על
$\mbb{R}^n$,
רק עם וקטורים מ־%
$V$
במקום מספרים ב־%
$\mbb{R}$,
נרצה להגדיר מכפלה זאת על המרחב
\[\text{.} V^n \coloneqq \set{\prs{v_1, \ldots, v_n}}{v_i \in V}\]
זה אכן מרחב וקטורי עם חיבור וכפל בסקלר לפי כל קואורדינטה בנפרד, ונגדיר עליו מכפלה פנימית לפי
\[\text{.} \trs{\prs{u_1, \ldots, u_n}, \prs{v_1, \ldots, v_n}} \coloneqq \sum_{i = 1}^n \trs{u_i, v_i}\]
אם
$v \coloneqq \prs{v_1, \ldots, v_n} \neq \prs{0, \ldots, 0}$,
יש
$v_j \neq 0$
ולכן
\[\text{,} \trs{v,v} \geq \trs{v_j, v_j} > 0\]
לכון מתקיימת חיוביות.
סימטריה ולינאריות ברכיב הראשון מתקיימות בכל רכיב בנפרד, ולכן גם בסך הכל.

כעת, אי־שוויון קושי־שוורץ על
$V^n$
אומר לנו כי
\begin{align*}
\sum_{i = 1}^n \trs{u_i, v_i}
&\leq
\abs{\sum_{i = 1}^n \trs{u_i, v_i}}
\\&=
\abs{\trs{u,v}}
\\&\leq
\norm{u} \norm{v}
\\&=
\sqrt{\trs{u,u}} \cdot \sqrt{v,v}
\\&=
\sqrt{{\sum_{i = 1}^n \trs{u_i, u_i}}} \cdot \sqrt{\sum_{i=1}^n \trs{v_i, v_i}}
\\\text{,}\hphantom{\sum_{i = 1}^n \trs{u_i, v_i}}&=
\sqrt{{\sum_{i = 1}^n \norm{u_i}^2}} \cdot \sqrt{\sum_{i=1}^n \norm{v_i}^2}
\end{align*}
כנדרש.
\end{solution}

ראינו שממכפלה פנימית ניתן לקבל נורמה המושרית ממנה. שאלה הגיונית לשאול היא האם כל נורמה מגיעה ממכפלה פנימית באופן זה. הטענה הבאה מתארת איך למצוא מכפלה פנימית כזאת, אם היא קיימת.

\begin{proposition}[זהות הפולריזציה]
יהי
$V$
מרחב מכפלה פנימית מעל שדה
$\mbb{F} \in \set{\mbb{R}, \mbb{C}}$.

\begin{enumerate}
\item אם
$\mbb{F} = \mbb{R}$,
לכל
$u,v \in V$
מתקיים
\[\text{.} \trs{u,v} = \frac{1}{4} \prs{\norm{u + v}^2 - \norm{u-v}^2}\]

\item אם
$\mbb{F} = \mbb{C}$,
לכל
$u,v \in V$
מתקיים
\[\text{.} \trs{u,v} = \frac{1}{4} \prs{\norm{u+v}^2 - \norm{u-v}^2 + i \norm{u+iv}^2 - i\norm{u-iv}^2}\]
\end{enumerate}
\end{proposition}

\begin{exercisechap}
יהי
$V = \mbb{R}^n$
עם הנורמה
$\norm{v}_{\infty} = \max_{i \in [n]} \abs{v_i}$.
הראו כי נורמה זאת אינה מושרית ממכפלה פנימית.
\end{exercisechap}

\begin{solution}
אם הנורמה מושרית ממכפלה פנימית,
$\trs{\cdot, \cdot}$,
מתקיים מזהות הפולריזציה כי
\[\text{.} \trs{u,v} = \frac{1}{4} \prs{\prs{\max_{i \in [n]} \abs{u_i + v_i}}^2 - \prs{\max_{i \in [n]} \abs{u_i - v_i}}^2}\]
אבל זאת לא מכפלה פנימית, למשל כי אינה לינארית.
מתקיים
\begin{align*}
\trs{e_1, e_2} &= \frac{1}{4} \prs{1^2 - 1^2} = 0 \\
\trs{e_2, e_2} &= \frac{1}{4} \prs{2^2 - 0^2} = 1
\end{align*}
ואילו
\[\text{.} \trs{e_1 + e_2, e_2} = \frac{1}{4} \prs{2^2 + 1^2} = \frac{5}{4} \neq 1 + 0\]
\end{solution}

יש לנו דךר נוספת לבדוק האם נורמה מושרית ממכפלה פנימית.

\begin{theorem}[זהות המקבילית]
יהי
$\prs{V, \norm{\cdot}}$
מרחב נורמי. הנורמה
$\norm{\cdot}$
מושרית ממכפלה פנימית אם ורק אם לכל
$u,v$
מתקיים
\[\text{.} 2 \norm{u}^2 + 2 \norm{v}^2 = \norm{u+v}^2 + \norm{u-v}^2\]
\end{theorem}

\begin{exercisechap}
הראו שהנורמה
\begin{align*}
\norm{p} = \abs{p\prs{0}} + \abs{p\prs{1}} + \abs{p\prs{2}}
\end{align*}
על
$\mbb{R}_2\brs{x}$
אינה מושרית ממכפלה פנימית.
\end{exercisechap}

\begin{solution}
נראה שלא מתקיימת זהות המקבילית.
נסתכל על הפולינומים
$p\prs{x} = x, q\prs{x} = x^2 - 1$.
אז
\begin{align*}
\norm{p} &= 0+1+2 = 3 \\
\norm{q} &= 1 + 0 + 3 = 4 \\
\norm{p+q} &= 1 + 1 + 5 = 7 \\
\norm{p-q} &= 1 + 1 + 1 = 3
\end{align*}
ולכן
\begin{align*}
2 \prs{\norm{p}^2 + \norm{q}^2} &= 2 \prs{9 + 16} = 50 \\
\norm{p-q}^2 + \norm{p-q}^2 &= 49 + 9 = 58
\end{align*}
ערכים שונים.
\end{solution}

\section{מטריקות וניצבות}

ראינו שבמרחבי מכפלה פנימית יש מושג של אורך%
\textemdash
נורמה.
על מרחב נורמי יש גם מושג של מרחק.

\begin{definition}[מטריקה]
תהי
$X$
קבוצה.
\emph{מטריקה}
על
$X$
היא פונקציה
$d \colon X \times X \to \mbb{R}_{\geq 0}$
המקיימת את התכונות הבאות.
\begin{description}
\item[חיוביות:]
$d\prs{x,y} \geq 0$
וגם
$d\prs{x,y} = 0$
אם ורק אם
$x = y$.

\item[סימטריה:]
$d\prs{x,y} = d\prs{y,x}$.

\item[אי־שוויון המשולש:]
$d\prs{x,z} \leq d\prs{x,y} + d\prs{y,z}$.
\end{description}

קבוצה עם מטריקה נקראת
\emph{מרחב מטרי}.
\end{definition}

\begin{definition}[מטריקה המושרית מנורמה]
יהי
$\prs{V,\norm{\cdot}}$
מרחב נורמי.
\emph{המטריקה המושרית}
על
$V$
היא
$d\prs{x,y} = \norm{x-y}$.
\end{definition}

כעת, את המרחק בין שני שני וקטורים קל בדרך כלל לחשב כאשר יש לנו נורמה נתונה. מעט מסובך יותר לחשב את המרחב מוקטור לקבוצה.

\begin{definition}[מרחק מקבוצה]
יהי
$\prs{X,d}$
מרחב מטרי, יהי
$x \in X$
ותהי
$S \subseteq X$.
נגדיר את
\emph{המרחק של
$x$
מ־%
$S$}
להיות
\begin{align*}
\text{.} d\prs{x,S} \coloneqq \inf\set{d\prs{x,s}}{s \in S}
\end{align*}
\end{definition}

תת־קבוצות של מרחב וקטורי שמעניינות אותנו הן בדרך כלל תת־מרחבים. במקרה האוקלידי, אנו יודעות כיצד לחשב את המרחק מתת־מרחב. כדי לחשב את
$d\prs{x,W}$
עבור
$W \leq \mbb{R}^n$,
נעביר אנך מ־%
$x$
ל־%
$W$
ונחשב את המרחק בין
$x$
ונקודת החיתוך בין
$W$
לאנך.

כדי לעשות דבר דומה במרחבי מכפלה פנימית כלליים, נצטרך לדבר קודם כל על ניצבות.

\begin{definition}[זווית במרחב מכפלה פנימית]
יהי
$V$
מרחב מכפלה פנימית ויהיו
$u,v \in V$.
נגדיר את
\emph{הזווית}
בין
$u,v$
בתור
\[\text{.} \angle\prs{u,v} = \acos\prs{{\frac{\Re\prs{\trs{u,v}}}{\norm{u} \norm{v}}}}\]
\end{definition}

\begin{definition}[וקטורים ניצבים]
יהי
$V$
מרחב מכפלה פנימית.
וקטורים
$u,v \in V$
נקראים
\emph{ניצבים}
אם
$\trs{u,v} = 0$.
במקרה זה נסמן
$u \perp v$.
\end{definition}

\begin{remark}
מעל
$\mbb{R}$,
וקטורים ניצבים בדיוק כאשר הזווית בינם היא
$\frac{\pi}{2}$.
\end{remark}

\begin{definition}
קבוצה
$S \subseteq V$
במרחב מכפלה פנימית נקראת
\emph{אורתוגונלית}
אם
$s_1 \perp s_2$
לכל
$s_1, s_2 \in S$
שונים.
\end{definition}

\begin{theorem}[פיתגורס]
תהי
$\prs{v_1, \ldots, v_n}$
סדרה של וקטורים אורתוגונליים במרחב מכפלה פנימית
$V$.
אז
\begin{align*}
\text{.} \norm{v_1 + \ldots + v_n}^2 = \norm{v_1}^2 + \ldots + \norm{v_n}^2
\end{align*}
\end{theorem}

\begin{exercisechap}
יהי
$V$
מרחב מכפלה פנימית.
\begin{enumerate}
\item הוכיחו כי אם
$\trs{v,w} = 0$
לכל
$w \in V$
אז
$v = 0$.
\item הוכיחו כי אם
$\trs{v,w} = \trs{u,w}$
לכל
$w \in V$
אז
$v=u$.
\item הוכיחו כי אם
$T,S \in \endo_{\mbb{F}}\prs{V}$
ו־%
$\trs{Tu,v} = \trs{Su,v}$
לכל
$u,v \in V$
אז
$T = S$.
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
\item ניקח
$w = v$
ונקבל
\[\text{.} \trs{v,v} = 0\]
ולכן
$v = 0$.
\item נעביר אגף ונקבל
\[\trs{v-u, w} = 0\]
לכל
$w \in V$.
אז מהסעיף הקודם
$v-u = 0$
ולכן
$v = u$.
\item נעביר אגף ונקבל
\[\text{.} \trs{\prs{T-S}\prs{u},v} = 0\]
לכל
$u,v \in V$.
אז עבור כל
$u \in V$
מתקיים
$\prs{T-S}\prs{u} = 0$,
ולכן
$T\prs{u} = S\prs{u}$.
\end{enumerate}
\end{solution}

\section{בסיסים אורתונורמליים והמרחב הניצב}

כעת, כדי לדבר על המרחק של וקטור
$v \in V$
מתת־מרחב
$W \leq V$,
נרצה לכתוב את
$v$
בתור סכום של שני וקטורים, כאשר אחד מהם מ־%
$W$
והשני ניצב ל־%
$W$.
ראינו כי
$V = W \oplus W^{\perp}$
עבור
$W^\perp$
תת־המרחב של הוקטורים הניצבים ל־%
$W$
ולכן זה אפשרי.
ככה, ושהמרחק יצא, כמו במקרה האוקלידי, האורך של החלק הניצב ל־%
$W$.

\begin{definition}[מרחב ניצב]
יהי
$V$
מרחב מכפלה פנימית, ותהי
$S \subseteq V$.
\emph{המרחב הניצב ל־%
$S$}
הוא
\[\text{.} S^\perp = \set{v \in V}{\forall s \in S \colon v \perp s}\]
\end{definition}

\begin{proposition}
יהי
$V$
מרחב מכפלה פנימית ויהי
$W \leq V$.
מתקיים
$V = W \oplus W^\perp$.
\end{proposition}

\begin{exercisechap}
יהי
$V$
מרחב מכפלה פנימית ותהיינה
$S,T \subseteq V$.

\begin{enumerate}
\item 
נניח כי
$S \subseteq T$.
הראו כי
$T^\perp \subseteq S^\perp$.

\emph{התאמה כזאת, כמו $S \mapsto S^\perp$, שהופכת יחס הכלה, נקראת
\emph{התאמת גלואה}.}

\item
נסמן
$W = \Span\prs{S}$.
הראו כי
$S^\perp = W^\perp$.

\item
הראו כי
$\prs{S^{\perp}}^\perp = \Span\prs{S}$.
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
\item
יהי
$v \in T^\perp$
ויהי
$s \in S$.
אז
$s \in T$
כי
$S \subseteq T$,
ולכן
$v \perp s$,
כי
$v$
ניצב לכל וקטור ב־%
$T$.
לכן
$v \in S^\perp$.

\item
מתקיים
$S \subseteq W$
ולכן
$W^\perp \subseteq S^\perp$.
יהי
$v \in S^\perp$
ויהי
$w \in W$.
כיוון ש־%
$W = \Span\prs{S}$,
יש איברים
$s_1, \ldots, s_k$
וסקלרים
$\alpha_1, \ldots, \alpha_k$
עבורם
$w = \sum_{i \in [k]} \alpha_i s_i$.
אז
\[\trs{v,w} = \trs{v, \sum_{i \in [k]} \alpha_i s_i} = \sum_{i \in [k]} \alpha_i \cancelto{0}{\trs{v_i, s_i}} = 0\]
ולכן
$v \in W^\perp$.

\item
ראינו כי
$\prs{W^\perp}^\perp = W$
עבור
$W \leq V$.
ניקח
$W = \Span\prs{S}$.
מתקיים
$S \subseteq W$
ולכן
$W^\perp \subseteq S^\perp$
ואז
$\prs{S^\perp}^\perp \subseteq \prs{W^\perp}^\perp = W$.
כמו כן,
$S^\perp = W^\perp$
תת־מרחב וקטורי ומכיוון ש־%
$V = S^\perp \oplus \prs{S^\perp}^\perp$,
נקבל כי
\[\dim\prs{\prs{S^\perp}^\perp} = \dim\prs{V} - \dim\prs{S^\perp} = \dim\prs{V} - \dim\prs{W^\perp} = \dim\prs{W}\]
ולכן יש שוויון
$\prs{S^\perp}^\perp = W = \Span\prs{S}$.
\end{enumerate}
\end{solution}

\begin{remark}
לא יכולנו בתרגיל האחרון להניח כי
$S$
אינסופית. באופן כללי,
\[\Span\prs{S} = \set{\sum_{i \in [k]} \alpha_i s_i}{\substack{\alpha_i \in \mbb{F} \\ s_i \in S}}\]
גם כאשר
$S$
אינסופית.
\end{remark}

\begin{exercisechap}
מצאו את
$W^\perp$
עבור
\[\text{.} W \ceq \spn\prs{e_1 + e_2} \leq \mbb{R}^2\]
\end{exercisechap}

\begin{solution}
ראינו כי מתקיים
$v \in \Span\prs{e_1 + e_2}^\perp$
אם ורק אם
$v \perp e_1 + e_2$.
זה מתקיים
אם ורק אם
$v_1 + v_2 = 0$
אם ורק אם
$v_2 = - v_1$.
לכן
\[\text{.} W^\perp = \spn\prs{e_1 - e_2}\]
\end{solution}

\begin{definition}[בסיס אורתונורמלי]
יהי
$V$
מרחב מכפלה פנימית.
בסיס
$B = \prs{v_1, \ldots, v_n}$
של
$V$
נקרא
\emph{אורתוגונלי}
אם
$\trs{v_i, v_j} = 0$
לכל
$i \neq j$,
ו%
\emph{אורתונורמלי}
אם
$\trs{v_i, v_j} = \delta_{i,j} \coloneqq \fcases{0 & i \neq j \\ 1 & i=j}$.
\end{definition}

\begin{definition}[הטלה אורתוגונלית]
יהי
$V$
מרחב מכפלה פנימית ויהי
$W \leq V$.
\emph{ההטלה האורתוגונלית על
$W$}
היא ההטלה על
$W$
ביחס לסכום הישר
$V = W \oplus W^\perp$.
\end{definition}

\begin{proposition}
יהי
$V$
מרחב מכפלה פנימית ויהי
$W \leq V$.
יהי
$B = \prs{w_1, \ldots, w_m}$
בסיס
\textbf{אורתונורמלי}
של
$W$
ויהי
$v \in V$.
תהי
$P_W$
ההטלה האורתוגונלית על
$W$.
אז
\[\text{.} P_W\prs{w} = \sum_{i \in [m]} \trs{v, w_i} w_i\]
\end{proposition}

\begin{exercisechap}
יהי
$V$
מרחב מכפלה פנימית ויהיו
$u,v \in V$.
הראו כי
$u \perp v$
אם ורק אם
\[\norm{u} \leq \norm{u+av}\]
לכל
$a \in \mbb{F}$.
\end{exercisechap}

\begin{solution}
אם
$u \perp v$
ו־%
$a \in \mbb{F}$,
נקבל מפיתגורס
\begin{align*}
\norm{u+av}^2 &= \norm{u}^2 + \abs{a}^2 \norm{v}^2 \geq \norm{u}^2
\end{align*}
ולכן
$\norm{u} \leq \norm{u+av}$.

נניח כי
$\trs{u,v} \neq 0$
ונניח תחילה כי
$\norm{v} = 1$.
אז
\[\trs{\trs{u,v}v, v} = \trs{u,v} \trs{v,v} = \trs{u,v} \norm{v}^2 = \trs{u,v} \neq 0\]
וגם
\[\text{.} \trs{u - \trs{u,v}v, v} = \trs{u,v} - \trs{\trs{u,v}v,v} = 0\]
אז, ממשפט פיתגורס
\begin{align*}
\norm{u}^2 &= \norm{u - \trs{u,v}v + \trs{u,v}v}^2
\\&=
\norm{u - \trs{u,v}v}^2 + \norm{\trs{u,v}v}^2
\\&>
\norm{u-\trs{u,v}v}^2
\end{align*}
כאשר האי־שוויון חזק כי
$\trs{u,v}v \neq 0$
מההנחה
$\trs{u,v} \neq 0$.
לכן, עבור
$a = \trs{u,v}$
לא מתקיים
$\norm{u} \leq \norm{u+av}$.

כעת, אם
$v$
כללי, הוקטור
$\frac{v}{\norm{v}}$
הינו מאורך
$1$
ולכן יש
$a' \in \mbb{F}$
עבורו
$\norm{u} > \norm{u+a' \frac{v}{\norm{v}}}$.
אז ניקח
$a = \frac{a'}{\norm{v}}$
ונקבל כי
$\norm{u} > \norm{u + av}$.
\end{solution}

כדי למצוא בסיסים אורתונורמליים ומשלימים ישרים, ניעזר בתהליך שלוקח בסיס כלשהו ומחזיר בסיס אורתונורמלי.

\begin{theorem}[גרם־שמידט]
יהי
$V$
מרחב מכפלה פנימית ויהי
$B = \prs{u_1, \ldots, u_n}$
בסיס של
$V$.
קיים בסיס אורתונורמלי
$C = \prs{v_1, \ldots, v_n}$
של
$V$
עבורו
\[\Span\prs{u_1, \ldots, u_i} = \Span\prs{v_1, \ldots, v_i}\]
לכל
$i \in \brs{n}$.
\end{theorem}

ניסוח זה של המשפט לא מתאר לנו איך למצוא את
$C$,
אבל ההוכחה שלו קונסטרוקטיבית ומתארת את האלגוריתם הבא.

\begin{enumerate}
\item
עבור
$i = 1$
ניקח
$v_i = \frac{u_i}{\norm{u_i}}$.

\item
עבור כל
$i$
לאחר מכן, לפי הסדר, ניקח
\[w_i = u_i - \sum_{j \in \brs{i-1}} \trs{u_i, v_j}\]
ואז
$v_i = \frac{w_i}{\norm{w_i}}$.
\end{enumerate}

\begin{corollary}
יהי
$W \leq V$
תת־מרחב במרחב מכפלה פנימית.
כדי למצוא אורתונורמלי של
$W$
ושל
$W^\perp$
ניקח בסיס
$B_W$
של
$W$
ונשלים אותו לבסיס
$B = B_W \cup B'_W$
של
$V$.
נבצע את תהליך גרם־שמידט על
$B$
ונקבל בסיס
$C = C_W \cup C_W^\perp$
כך ש־%
$\Span\prs{C_W} = \Span\prs{B_W} = W$.
כל הוקטורים ב־%
$C_W^\perp$
ניצבים ל־%
$W$
כי
$C$
אורתונורמלי, ולכן
$W' \coloneqq \Span\prs{C_W^\perp} \subseteq W^\perp$.
כמו כן,
\[\dim\prs{W'} = \dim\prs{V} - \dim\prs{W} = \dim\prs{W^\perp}\]
כי
$V = W \oplus W' = W \oplus W^\perp$,
ולכן יש שוויון
$W' = W^\perp$.
\end{corollary}

\begin{theorem}[מרחק של וקטור מתת־מרחב]
יהי
$V$
מרחב מכפלה פנימית, יהי
$W \leq V$,
תהי
$P_W$
ההטלה האורתוגונלית על
$W$
ויהי
$v \in V$.
מתקיים
\[\text{.} d\prs{v,W} = d\prs{v, p_W\prs{v}}\]
\end{theorem}

\begin{exercisechap}
יהי
$V = \Mat_2\prs{\mbb{R}}$
עם המכפלה הפנימית הסטנדרטית
\[\trs{A,B} = \tr\prs{B^t A}\]
ויהי
$W \leq V$
התת־מרחב של המטריצות הסימטריות.

\begin{enumerate}
\item מיצאו בסיס אורתונורמלי עבור
$W$
ועבור
$W^\perp$.

\item
הראו כי
$P_W\prs{A} = \frac{A + A^t}{2}$
בשתי דרכים שונות.

\item
חשבו את המרחק של
$A = \pmat{1 & 2 \\ 3 & 4}$
מ־%
$W$.
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
\item
ניקח בסיס
$B_W = \prs{E_{1,1}, E_{1,2} + E_{2,1}, E_{2,2}}$
של
$W$
ונשלים אותו לבסיס
\[B = \prs{u_1, u_2, u_3, u_4} = \prs{E_{1,1}, E_{1,2} + E_{2,1}, E_{2,2}, E_{1,2}}\]
של
$V$.
נבצע את תהליך גרם־שמידט כדי לקבל בסיס אורתונורמלי
$\prs{v_1, v_2, v_3, v_4}$
עבורו
$W = \Span\prs{v_1, v_2, v_3}$
וגם
$W^\perp = \Span\prs{v_4}$.

נחשב
\begin{align*}
v_1 &= \frac{1}{\norm{E_{1,1}}} E_{1,1} = E_{1,1} \\
w_2 &= u_2 - \trs{u_2,v_1} v_1 = E_{1,2} + E_{2,1} - 0 = E_{1,2} + E_{2,1} \\
v_2 &= \frac{1}{\norm{w_2}} w_2 = \frac{1}{\sqrt{2}} \prs{E_{1,2} + E_{2,1}} \\
w_3 &= u_3 - \trs{u_3, v_2} v_2 - \trs{u_3, v_1} v_1 = u_3 = E_{2,2} \\
v_3 &= \frac{1}{\norm{w_3}} w_3 = E_{2,2} \\
w_4 &= u_4 - \trs{u_4, v_3}v_3 - \trs{u_4, v_2}v_2 - \trs{u_4, v_1}v_1 \\&= E_{1,2} - \trs{E_{1,2}, \frac{1}{\sqrt{2}} \prs{E_{1,2} + E_{2,1}}} \prs{\frac{1}{\sqrt{2}} \prs{E_{1,2} + E_{2,1}}}
\\&= E_{1,2} - \frac{1}{2} \prs{E_{1,2} + E_{2,1}}
\\&= \frac{1}{2} \prs{E_{1,2} - E_{2,1}} \\
v_4 &= \frac{w_4}{\norm{w_4}} = \frac{1}{\norm{E_{1,2} - E_{2,1}}} \prs{E_{1,2} - E_{2,1}} = \frac{1}{\sqrt{2}} \prs{E_{1,2} - E_{2,1}}
\end{align*}
ונקבל כי
\[\prs{v_1, v_2, v_3} = \prs{E_{1,1}, \frac{1}{\sqrt{2}} \prs{E_{1,2} + E_{2,1}}, E_{2,2}}\]
בסיס אורתונורמלי של
$W$
וכי
$\frac{1}{\sqrt{2}} \prs{E_{1,2} - E_{2,1}}$
בסיס אורתונורמלי של
$W^\perp$.
אז,
$W^\perp$
מרחב המטריצות האנטיסימטריות.

\item
בדרך אחת, זכור לנו מאלגברה א' כי
\[A = \frac{A + A^t}{2} + \frac{A - A^t}{2}\]
כאשר
$\frac{A + A^t}{2}$
סימטרית ו־%
$\frac{A - A^t}{2}$
אנטי־סימטרית.
אז
$\frac{A + A^t}{2} \in W$
וכיוון ש־%
$W^\perp$
מרחב המטריצות האנטיסימטריות, נקבל גם
$\frac{A - A^t}{2} \in W^\perp$.
לכן
$P_W\prs{A} = \frac{A + A^t}{2}$.

אבל, במקרה הכללי, לא נדע מראש איך לכתוב וקטור
$v \in V$
בתור סכום של וקטור ב־%
$W \leq V$
ווקטור ב־%
$W^\perp$.
כדי לחשב את ההטלה
$P_W\prs{A}$
נוכל לקחת בסיס אורתונורמלי של
$W$
ולהשתמש בנוסחא עבור ההטלה האורתוגונלית לפי בסיס כזה.

אכן,
\begin{align*}
P_W\prs{A} &= \sum_{i \in [3]} \trs{A, v_i} v_i \\&= \trs{A, E_{1,1}} E_{1,1} + \trs{A, \frac{1}{\sqrt{2}} \prs{E_{1,2} + E_{2,1}}} \cdot \frac{1}{\sqrt{2}} \prs{E_{1,2} + E_{2,1}} + \trs{A, E_{2,2}}, E_{2,2}
\\&=
a_{1,1} E_{1,1} + \frac{1}{2} \prs{a_{1,2} + a_{2,1}} \prs{E_{1,2} + E_{2,1}} + a_{2,2} E_{2,2}
\\&=
\pmat{a_{1,1} & \frac{a_{1,2} + a_{2,1}}{2} \\ \frac{a_{1,2} + a_{2,1}}{2} & a_{2,2}}
\\ \text{.} \hphantom{P_W\prs{A}} &=
\frac{A + A^t}{2}
\end{align*}

\item
נכתוב את
$A$
בתור סכום של מטריצה סימטרית ואנטי־סימטרית. ראינו כי
\[A = \frac{A + A^t}{2} + \frac{A - A^t}{2}\]
כאשר
$\frac{A + A^t}{2}$
סימטרית ו־%
$\frac{A - A^t}{2}$
אנטי־סימטרית.
אז
$d_W\prs{A} = \frac{A+A^t}{2}$
ונקבל כי
המרחק של
$A$
מ־%
$W$
הוא
\[\text{.} d\prs{A, \frac{A + A^t}{2}} = \norm{A - \frac{A + A^t}{2}}\]
מתקיים
\begin{align*}
\norm{A - \frac{A + A^t}{2}} &= \norm{\frac{A - A^t}{2}}
\\&= \frac{1}{2} \norm{\pmat{0 & -1 \\ & 1 & 0}}
\\&= \frac{1}{2} \cdot \sqrt{2}
\\&= \frac{1}{\sqrt{2}}
\end{align*}
ולכן
$d\prs{A, W} = \frac{1}{\sqrt{2}}$.
\end{enumerate}
\end{solution}

\chapter{אופרטורים על מרחבי מכפלה פנימית}

\section{המרחב הדואלי, ומשפט ההצגה של ריס}

\begin{definition}[המרחב הדואלי]
יהי
$V$
מרחב מכפלה פנימית מעל שדה
$\mbb{F}$.
\emph{המרחב הדואלי}
של
$V$
הוא
\[\text{.} V^* \coloneqq \hom_{\mbb{F}}\prs{V,\mbb{F}}\]
איבריו נקראים
\emph{פונקציונלים לינאריים}.
\end{definition}

\begin{theorem}[משפט ההצגה של ריס]
יהי
$V$
מרחב מכפלה פנימית סוף־מימדי מעל שדה
$\mbb{F}$,
ויהי
$\phi \in V^*$
פונקציונל לינארי על
$V$.
קיים וקטור
$w \in V$
יחיד עבורו
$\phi\prs{v} = \trs{v,w}$
לכל
$v \in V$.

בנוסף, אם
$B = \prs{v_1, \ldots, v_n}$
בסיס אורתונורמלי של
$V$,
מתקיים
\[\text{.} w = \sum_{i \in \brs{n}} \trs{w, v_i} v_i = \sum_{i \in \brs{n}} \overline{\phi\prs{v_i}} v_i\]
\end{theorem}

\begin{exercisechap}
יהי
$V = \Mat_n\prs{\mbb{C}}$
ותהי
$\tr \colon V \to \mbb{C}$
העתקת העקבה.
מיצאו מטריצה
$B$
עבורה
$\tr\prs{A} = \trs{A,B}$
לכל
$A \in V$.
\end{exercisechap}

\begin{solution}
נסתכל על הבסיס האורתונורמלי
$\prs{E_{i,j}}_{i,j \in \brs{n}}$
של
$V$
וניעזר בנוסחא. נקבל
\[\text{.} B = \sum_{i,j \in \brs{n}} \overline{\tr\prs{E_{i,j}}} E_{i,j} = \sum_{i \in \brs{n}} E_{i,i} = I_n\]
\end{solution}

\begin{exercisechap}
\begin{enumerate}
\item הוכיחו כי לכל
$n \in \mbb{N}$
קיים
$C > 0$
כך שלכל
$p \in \mbb{R}_n\brs{x}$
מתקיים
\[\text{.} \abs{p\prs{0}} \leq C \prs{\int_{-1}^1 p\prs{x}^2 \diff x}^{\frac{1}{2}}\]

\item חשבו את
$C$
המינימלי עבור
$n=2$.
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
\item נשים לב כי
\[\trs{f,g} = \int_{-1}^1 f\prs{x} g\prs{x} \diff x\]
מכפלה פנימית.
אז
\begin{align*}
\text{.} \prs{\int_{-1}^1 p\prs{x}^2 \diff x}^{\frac{1}{2}} = \pmat{\trs{p,p}}^{\frac{1}{2}} = \norm{p}
\end{align*}
כלומר, עלינו להוכיח
\[\text{.} \abs{p\prs{0}} \leq C\norm{p}\]

ההצבה
\begin{align*}
\ev_0 \colon \mbb{R}_n\brs{x} &\to \mbb{R} \\
f &\mapsto f\prs{0}
\end{align*}
היא פונקציונל לינארי, ולכן ממשפט ריס יש
$g \in \mbb{R}_n\brs{x}$
עבורו
\[\text{.} p\prs{0} = \ev_0\prs{p} = \trs{p,g}\]
עכשיו, מקושי־שוורץ
\[\text{.} \abs{p\prs{0}} = \abs{\trs{p,g}} \leq \norm{p} \norm{g}\]
לכן ניקח
$C = \norm{g}$.

\item
נסמן
$g\prs{x} = ax^2 + bx + c$.
נשים לב כי
כאשר
$p = g$
יש שוויון בקושי־שוורץ ואז
\[\text{.} \abs{p\prs{0}} = \norm{p}\norm{g} \leq C\norm{p}\]
גורר
$C \geq \norm{g}$.
ראינו כי
$C = \norm{g}$
מקיים את הנדרש, ולכן נותר למצוא את
$\norm{g}$.

כדי לא להצטרך בסיס אורתונורמלי, שיהיה פחות יפה במקרה הזה, נשים לב שמספיק לחשב את המכפלות הפנימיות בין
$g$
לאיברי בסיס כלשהו.
לפי בסיס אורתונורמלי
$B = \prs{v_1, \ldots, v_n}$
מתקיים
\[\text{.} g = \sum_{i \in \brs{n}} \trs{g, v_i} v_i\]
אם
$C = \prs{u_1, \ldots, u_n}$
בסיס נוסף, נוכל לכתוב
\[v_i = \sum_{j \in \brs{n}} \alpha_{i,j} u_j\]
ואז
\[\text{,} g = \sum_{i \in \brs{n}} \trs{g, v_i} v_i = \sum_{i,j \in \brs{n}} \bar{\alpha}_{i,j} \trs{g, u_j}\]
ונקבל שמהכפלות הפנימיות
$\trs{g, u_i}$
נותנות מספיק אינפורמציה כדי למצוא את
$g$.

כעת, נחשב את המכפלות הפנימיות של
$g$
עם איברי הבסיס הסטנדרטי ונפתור מערכת משוואות שיהיה לה פתרון יחיד שהוא מקדמי
$g$.
\begin{align*}
1 &= 1\prs{0} = \trs{g\prs{x},1} = \int_{-1}^1 g\prs{x} \diff x = \left. \frac{ax^3}{3} + \frac{bx^2}{2} + cx \right|_{x=-1}^1 = \frac{2a}{3} + 2c \\
0 &= x\prs{0} = \trs{g\prs{x}, x} = \int_{-1}^1 g\prs{x} x \diff x = \left. \frac{ax^4}{4} + \frac{bx^3}{3} + \frac{cx^2}{2} \right|_{x=-1}^1 = \frac{2b}{3} \\
\text{.} 0 &= x^2\prs{0} = \trs{g\prs{x}, x^2} = \int_{-1}^1 g\prs{x} x^2 \diff x = \left. \frac{ax^5}{5} + \frac{bx^4}{4} + \frac{cx^3}{3} \right|_{x=-1}^1 = \frac{2a}{5} + \frac{2c}{3}
\end{align*}
מהמשוואה השנייה נקבל
$b = 0$.
מהמשוואה הראשונה פחות
$3$
פעמים השנייה נקבל
\[1 = \frac{2a}{3} - 3 \cdot \frac{2a}{5} + 0 = \frac{10a - 18a}{15}\]
ולכן
$a = -\frac{15}{8}$.
אז מהמשוואה השלישית נקבל
\[c = -\frac{3a}{5} = -\frac{9}{8}\]
ולכן
\[\text{.} g\prs{x} = -\frac{15}{8} x^2 - \frac{9}{8}\]

אז
\[\text{.} C = \norm{g} = \sqrt{\int_{-1}^1 \prs{-\frac{15}{8} x^2 - \frac{9}{8}}^2} \diff x = \frac{27}{4}\]
\end{enumerate}
\end{solution}

\section{ההעתקה הצמודה}

\begin{theorem}[ההעתקה הצמודה]
יהיו
$V,W$
מרחבי מכפלה פנימית סוף־מימדיים ותהי
$T \in \Hom_{\mbb{F}}\prs{V,W}$.
קיימת העתקה יחידה
$T^* \in \Hom_{\mbb{F}}\prs{W,V}$
עבורה
\begin{align*}
\trs{T\prs{v}, w}_W = \trs{v, T^*\prs{w}}_V
\end{align*}
לכל
$v \in V$
ולכל
$w \in W$.

היא נקראת
\emph{ההעתקה הצמודה}
של
$T$.
\end{theorem}

\begin{theorem}
יהיו
$\prs{V, \trs{\cdot, \cdot}_V}, \prs{W, \trs{\cdot, \cdot}_W}$
מרחבי מכפלה פנימית סוף מימדיים עם בסיסים אורתונורמליים
$B,C$
בהתאמה, ותהי
$T \in \Hom_{\mbb{F}}\prs{V,W}$.
אז
$\brs{T^*}^C_B = \prs{\brs{T}^B_C}^*$.
\end{theorem}

כעת, אם
$T \in \End_{\mbb{F}}\prs{V}$,
יש לנו דרכים שונות לחשב את
$T^*$.
נוכל לנחש איזה אופרטור יקיים
$\trs{Tv, w} = \trs{v, T^* w}$
לכל
$v,w \in V$,
על ידי מניפולציות של הצגת המכפלה הפנימית.
נוכל גם לכתוב את
$T^*$
בצורה כללית ולפתור מערכת משוואות.
לבסוף, נוכל לקחת בסיס אורתונורמלי
$B$,
כדי שיתקיים
$\brs{T^*}_B = \overline{\brs{T}_B}^t$,
ואז לשחזר את
$T^*$
מהמטריצה המייצגת.
נראה דוגמאות לחישוב בכל אחת מהדרכים.

\begin{exercisechap}
יהי
$V = \mbb{R}_2\brs{x}$
עם המכפלה הפנימית
\[\text{.} \trs{f,g} = \int_{-1}^1 f\prs{x} \bar{g}\prs{x} \diff x\]
יהי
$D \in \End_{\mbb{R}}\prs{V}$
אופרטור הגזירה.
מיצאו את
$D^*$.
\end{exercisechap}

\begin{solution}
כדי להראות
$D^* = S$
די להראות כי
$\trs{Df,g} = \trs{f,Dg}$
עבור
$f,g$
בבסיס נתון, מלינאריות.
נחשב מה צריך להיות
$D^*$
לפי הבסיס
$\prs{1,x,x^2}$.
יהי
$g\prs{x} = ax^2 + bx + c$.
נחשב את מכפלת
$D\prs{g}$
עם
$1$
\begin{align*}
    0 &= \trs{0,g} \\&= \trs{D\prs{1}, g} \\&= \trs{1, D^*\prs{g}} \\&= \int_{-1}^1 D^*\prs{g}\prs{x} \diff x
\end{align*}
עם
$x$
\begin{align*}
        \frac{2a}{3} + 2c &= \left. \frac{ax^3}{3} + \frac{bx^2}{2} + cx \right|_{-1}^1 \\&= \int_{-1}^1 ax^2 + bx + c \diff x \\&= \trs{1,g} \\&= \trs{D\prs{x}, g} \\&= \trs{x, D^*\prs{g}} \\&= \int_{-1}^1 x D^*\prs{g}\prs{x} \diff x
\end{align*}
ועם
$x^2$
\begin{align*}
        \frac{4b}{3} &= \left. \frac{2ax^4}{4} + \frac{2bx^3}{3} + \frac{2cx^2}{2} \right|_{-1}^1 \\&= 2 \int_{-1}^1 ax^3 + bx^2 + cx \diff x \\&= \trs{2x,g} \\&= \trs{D\prs{x^2}, g} \\&= \trs{x^2, D^*\prs{g}} \\&= \int_{-1}^1 x^2 D^*\prs{g}\prs{x} \diff x
\end{align*}

נכתוב
$D^*\prs{g} = \alpha x^2 + \beta x + \gamma$
ונקבל
\begin{align*}
    0 &= \int_{-1}^1 \alpha x^2 + \beta x + \gamma \diff x = \frac{2 \alpha}{3} + 2 \gamma \\
    \frac{2a}{3} + c &= \int_{-1}^1 \alpha x^3 + \beta x^2 + \gamma x \diff x = \frac{2\beta}{3} \\
    \frac{4b}{3} &= \int_{-1}^1 \alpha x^4 + \beta x^3 + \gamma x^2 \diff x = \left. \frac{\alpha x^5}{5} + \frac{\beta x^4}{4} + \frac{\gamma x^3}{3} \right|_{-1}^1 = \frac{2 \alpha}{5} + \frac{2 \gamma}{3}
\end{align*}
מהמשוואה הראשונה,
$\gamma = -\frac{\alpha}{3}$.
אז מהמשוואה השלישית,
$\frac{4b}{3} = \frac{2 \alpha}{5} - \frac{2 \alpha}{9}$
כלומר
\[4b = \prs{\frac{6}{5} - \frac{2}{3}}\alpha = \prs{\frac{18}{15} - \frac{10}{15}}\alpha = \frac{8 \alpha}{15}\]
כלומר
$b = \frac{2 \alpha}{15}$
כלומר
$\alpha = \frac{15}{2} b$.
נקבל כי
$\gamma = -\frac{5}{2}$
ומהמשוואה השנייה כי
$\beta = a + \frac{3c}{2}$.
לכן
\[\text{.} D^*\prs{ax^2 + bx + c} = \frac{15}{2} b x^2 + \prs{a + \frac{3c}{2}}x - \frac{5}{2}\]
\end{solution}

\begin{exercisechap}
יהי
$V = \Mat_n\prs{\mbb{C}}$
עם המכפלה הפנימית
$\trs{A,B} = \tr\prs{B^*, A}$,
ויהי
\begin{align*}
    \Phi \colon V &\to V \\
    \text{.} \hphantom{lala} A &\mapsto A^t
\end{align*}
חשבו את
$\Phi^*$.
\end{exercisechap}

\begin{solution}
נוכל לחשב ישירות,
\begin{align*}
    \trs{\Phi\prs{A},B} &= \trs{A^t, B} \\&= \tr\prs{B^* A^t} \\&= \overline{\tr\prs{\overline{B^* A^t}}} \\&= \overline{\tr\prs{B^t A^*}} \\&= \overline{\tr\prs{A^* B^t}} \\&= \overline{\trs{B^t, A}} \\&= \trs{A, B^t} \\&= \trs{A, \Phi\prs{B}}
\end{align*}
ולכן
$\Phi^* = \Phi$.

נוכל לחשב זאת גם בעזרת מטריצה מייצגת בבסיס אורתונורמלי.
נסמן ב־%
$E_{i,j}$
מטריצה עבורה
$\prs{E_{i,j}}_{k,\ell} = \delta_{i,k} \delta_{j,\ell}$.
כלומר, זאת מטריצה עם
$0$
בכל המקדמים חוץ מזה בשורה ה־%
$i$
והעמודה ה־%
$j$.
אז בבסיס
\[B \coloneqq \prs{E_{1,1}, \ldots, E_{n,n}, E_{1,2}, E_{2,1}, E_{1,3}, E_{3,1} \ldots, E_{n-1, n} E_{n,n-1}}\]
נקבל כי
\begin{align*}
    \text{.} \brs{\Phi}_B &= I_n \oplus \pmat{0 & 1 \\ 1 & 0} \oplus \ldots \oplus \pmat{0 & 1 \\ 1 & 0}
\end{align*}
כיוון ש־%
$B$
בסיס אורתונורמלי
נקבל כי
$\brs{\Phi^*}_B = \overline{\brs{\Phi}_B}^t$.
אך
$\brs{\Phi}_B$
מטריצה ממשית סימטרית, ולכן
$\brs{\Phi^*}_B = \brs{\Phi}_B$
ואז
$\Phi^* = \Phi$.
\end{solution}

\section{אופרטורים אוניטריים ואורתוגונליים}

תכונה אינטואיטיבית גיאומטרית של אופרטורים על מרחבי מכפלה פנימית היא שמירה של המכפלה הפנימית.
אופרטור
$T \in \End_{\mbb{F}}\prs{V}$
עבורו
$\trs{Tv, Tw} = \trs{v,w}$
לכל
$v,w \in V$
מקיים
$\trs{T^* T v, w} = \trs{v,w}$
ולכן
$T^* T = \id$
כלומר
$T^* = T^{-1}$.
נקרא לאופרטור כזה
\emph{אורתוגונלי}
אם
$\mbb{F} = \mbb{R}$,
או
\emph{אוניטרי},
אם
$\mbb{F} = \mbb{C}$.

\begin{definition}[אופרטור אורתוגונלי (אוניטרי)]
אופרטור
$T \in \End_{\mbb{F}}\prs{V}$
מעל
$\mbb{R}$
(מעל
$\mbb{C}$
נקרא
\emph{אורתוגונלי (אוניטרי)}
אם
$T^* = T^{-1}$.
\end{definition}

\begin{definition}[מטריצה אורתונוגלית (אוניטרית)]
מטריצה
$A \in \Mat_n\prs{\mbb{F}}$
עבור
$\mbb{F} = \mbb{R}$
(עבור
$\mbb{F} = \mbb{C}$)
נקראת
\emph{אורתוגונלית (אוניטרית)}
אם
$A^t = A^{-1}$.
\end{definition}

\begin{exercisechap}
הראו כי
$T \in \End_{\mbb{F}}\brs{V}$
אורתוגונלי (אוניטרי) אם ורק אם
$\norm{Tv} = \norm{v}$
לכל
$v \in V$.
\end{exercisechap}

\begin{solution}
אם
$T \in \End_{\mbb{F}}\prs{V}$
אופרטור אורתוגונלי (אוניטרי), מתקיים
\[\norm{Tv} = \sqrt{\trs{Tv, Tv}} = \sqrt{\trs{v,v}} = \norm{v}\]
לכל
$v \in V$.

להיפך, אם
$\norm{Tv} = \norm{v}$
לכל
$v \in V$,
נקבל מזהות הפולריזציה כי
$\trs{Tv, Tw} = \trs{v,w}$
לכל
$v,w \in W$.
\end{solution}

\begin{remark}
קיבלנו כי אופרטורים אורתוגונליים (או אוניטריים) הם בדיוק אלו השומרים על הנורמה, ולכן הם גם אלו השומרים על מרחקים.

העתקות השומרות על מרחקים נקראות
\emph{איזומטריות}
ולכן אופרטור אורתוגונלי נקרא גם
\emph{איזומטריה לינארית}.
כיוון שבקורס נדבר רק על העתקות לינאריות, נתייחס לפעמים לאופרטור לינארי בתור
\emph{איזומטריה}.
\end{remark}

\begin{proposition}
יהי
$V$
מרחב מכפלה פנימית ממשי ממימד
$n$,
ויהי
$T \in \End_{\mbb{R}}\prs{V}$.
התנאים הבאים שקולים.

\begin{enumerate}
    \item $T$ אורתוגונלי.

    \item קיים בסיס אורתונורמלי
    $B = \prs{v_1, \ldots, v_n}$,
    כך שהבסיס
    $\prs{T v_1, \ldots, Tv_n}$
    אורתונורמלי.
    
    \item לכל בסיס אורתונורמלי
    $B = \prs{v_1, \ldots, v_n}$,
    הבסיס
    $\prs{T v_1, \ldots, Tv_n}$
    אורתונורמלי.
\end{enumerate}
\end{proposition}

\begin{exercisechap}
יהי
$V = \mbb{R}^2$
ויהי
\begin{align*}
    R \colon V &\to V \\
    \pmat{x \\ y} &\mapsto \pmat{x \\ -y}
\end{align*}
שיקוף דרך ציר ה־%
$x$.

הראו כי
$R$
איזומטריה.
\end{exercisechap}

\begin{solution}
מתקיים
$\brs{R}_E = \pmat{1 & 0 \\ 0 & -1}$
וזאת מטריצה שעמודותיה מהוות בסיס אורתונורמלי של
$V$.
לכן
$R$
שולח בסיס אורתונורמלי (הסטנדרטי) לבסיס אורתונורמלי, ולכן הינו איזומטריה.
\end{solution}

\begin{exercisechap}
הראו כי
$\rho_\theta \coloneqq A_\theta$
עבור
\[A_\theta = \pmat{\cos \theta & - \sin \theta \\ \sin \theta & \cos\theta}\]
הינו איזומטריה.
\end{exercisechap}

\begin{solution}
מתקיים כי
$\rho_{\theta}\prs{e_i} = A_{\theta} e_i$
העמודה ה־%
$i$
של
$A_{\theta}$.
נראה שעמודות
$A_\theta$
מהוות בסיס אורתונורמלי ונקבל כי
$\rho_{\theta}$
שולחת בסיס אורתונורמלי (הסטנדרטי) לבסיס אורתונורמלי. ראינו שזה תנאי שקול לאורתוגונליות ולכן נקבל את הנדרש.

אכן, מתקיים
\begin{align*}
    \trs{\pmat{\cos \theta \\ \sin \theta}, \pmat{-\sin \theta \\ \cos \theta}} &= -\sin \theta \cos \theta + \sin \theta \cos \theta = 0 \\
    \trs{\pmat{\cos \theta \\ \sin \theta}, \pmat{\cos \theta \sin \theta}} &= \cos^2 \theta + \sin^2 \theta = 1 \\
    \trs{\pmat{-\sin \theta \\ \cos \theta}, \pmat{-\sin \theta \\ \cos \theta}} &= \prs{-\sin \theta}^2 + \cos^2 \theta = \sin^2 \theta + \cos^2 \theta = 1
\end{align*}
כנדרש.
\end{solution}

\begin{exercisechap}
הראו כי כל איזומטריה של
$\mbb{R}^2$
היא מהצורה
$\rho_\theta$
או
$\rho_\theta R$
עבור
$\theta \in \mbb{R}$.
\end{exercisechap}

\begin{solution}
תהי
$T \in \End_{\mbb{R}}\prs{\mbb{R}^2}$
איזומטריה.
מהתנאים השקולים, הבסיס
$\prs{T\prs{e_1}, T\prs{e_2}}$
הינו אורתונורמלי.
בפרט,
$v \coloneqq T\prs{e_1}$
הינו מנורמה
$1$.

נראה שניתן לכתוב
$v = \pmat{\cos\theta \\ \sin\theta}$.
נכתוב
$v = \pmat{v_1, v_2}$
ונקבל כי
$v_1^2 + v_2^2 = 1$.
בפרט,
$v_1 \in \brs{-1,1}$
ולכן יש
$\theta \in \mbb{R}$
עבורה
$v_1 = \cos\theta$.
נקבל כי
$v_2^2 = 1 - \prs{\cos \theta}^2 = \prs{\sin \theta}^2$
ולכן
$v_2 \in \set{\pm \sin \theta}$.
אם
$v_2 = \sin\theta$,
סיימנו.
אחרת, ניתן לכתוב
\begin{align*}
    v_1 &= \cos\prs{-\theta} \\
    v_2 &= \sin\prs{-\theta}
\end{align*}
ואז הזווית המתאימה היא
$-\theta$.

נקבל כי
$v = \rho_\theta\prs{e_1}$
ולכן
\[\text{.} \rho_{-\theta}\prs{v} = \rho_{-\theta} \circ T \prs{e_1} = e_1\]
הרכבת איזומטריות הינה איזומטריה, ולכן נקבל כי
$\rho_{-\theta} \circ T$
היא איזומטריה שמקבעת את
$e_1$.
מהתנאים השקולים, היא מעבירה בסיס אורתונורמלי לבסיס אורתונורמלי, לכן
$\prs{e_1, u} \coloneqq \prs{e_1, \rho_{-\theta} \circ T\prs{e_2}}$
אורתונורמלי.
אבל אז
$u \in \set{\pm e_2}$
כי
$u \in \set{e_1}^\perp = \Span\prs{e_2}$
מנורמה
$1$.
אם
$u = e_2$
נקבל כי
$\rho_{-\theta} \circ T = \id_{\mbb{R}^2}$
כלומר
$T = \rho_{\theta}$.
אחרת,
$\rho_{-\theta} \circ T = R$
ואז
$T = \rho_{\theta} \circ R$.
\end{solution}

\section{אופרטורים נורמליים וצמודים לעצמם, ומשפט הפירוק הספקטרלי}

ראינו בתרגיל קודם דוגמא לאופרטור
$T$
עבורו
$T^* = T$.
אופרטור כזה נקרא
\emph{צמוד לעצמו}
מעל
$\mbb{R}$
או
\emph{הרמיטי}
מעל
$\mbb{C}$.
אופרטורים צמודים לעצמם מאופיינים על ידי המשפט הבא.

\begin{theorem}[משפט הפירוק הספקטרלי לאופרטורים צמודים לעצמם]
יהי
$V$
מרחב מכפלה פנימית ממשי סוף־מימדי, ויהי
$T \in \End_{\mbb{R}}\prs{V}$.
אז
$T$
צמוד לעצמו אם ורק אם יש בסיס אורתונורמלי
$B$
של
$V$
עבורו
$\brs{T}_B$
מטריצה אלכסונית.
\end{theorem}

מעל
$\mbb{C}$,
אופרטורים בעלי אפיון דומה אינם אופרטורים הרמיטיים, אלא אופרטורים
\emph{נורמליים}.

\begin{definition}[אופרטור נורמלי]
יהי
$V$
מרחב מכפלה פנימית ויהי
$T \in \End_{\mbb{F}}\prs{V}$.
נגיד כי
$T$
\emph{נורמלי}
אם
$T^* T = T T^*$.
\end{definition}

\begin{theorem}[משפט הפירוק הספקטרלי לאופרטורים נורמליים]
יהי
$V$
מרחב מכפלה פנימית מרוכב סוף־מימדי, ויהי
$T \in \End_{\mbb{C}}\prs{V}$.
אז
$T$
נורמלי אם ורק אם יש בסיס אורתונורמלי
$B$
של
$V$
עבורו
$\brs{T}_B$
מטריצה אלכסונית.
\end{theorem}

\begin{definition}
מטריצה
$A \in \Mat_n\prs{\mbb{F}}$
עבור
$\mbb{F} \in \set{\mbb{R}, \mbb{C}}$
נקראת
\emph{נורמלית}
אם
$A^* A = A A^*$
כאשר
$A^* \coloneqq \bar{A}^t$.
\end{definition}

\begin{remark}
תהי
$A$
מטריצה סימטרית (נורמלית) מעל
$\mbb{R}$
(מעל
$\mbb{C}$).
אז
$T_A$
אופרטור צמוד לעצמו (נורמלי) ולכן ממשפט הפירוק הספקטרלי קיים בסיס אורתונורמלי
$B$
עבורו
$\brs{T_A}_B$
מטריצה אלכסונית.

אז
\[\text{.} A = \brs{T_A}_E = \prs{M^E_B}^{-1} \brs{T_A}_B M^E_B\]
המטריצה
$P \coloneqq \prs{M^E_B}^{-1} = M^B_E$
היא מטריצה שעמודותיה מהוות בסיס אורתונורמלי, ולכן הינה אורתוגונלית (אוניטרית). אז מתקיים כי
$P^{-1} A P = D$
עבור מטריצה אורתוגונלית (אוניטרית)
$P$
ומטריצה אלכסונית
$D$.
\end{remark}

\begin{theorem}[משפט הפירוק הספקטרלי למטריצות]
תהי
$A \in \Mat_n\prs{\mbb{F}}$
עבור
$\mbb{F} = \mbb{R}$
($\mbb{F} = \mbb{C}$).
אז
$A$
סימטרית (נורמלית) אם ורק אם קיימת מטריצה אורתוגונלית (אוניטרית)
$P \in \Mat_n\prs{\mbb{F}}$
עבורה
$P^{-1} A P$
אלכסונית.
\end{theorem}

\begin{exercisechap}
תהי
\[\text{.} A = \pmat{3 & 0 & 0 \\ 0 & 2 & 1 \\ 0 & 1 & 2} \in \Mat_3\prs{\mbb{R}}\]
מצאו מטריצה אורתוגונלית
$P \in \Mat_3\prs{\mbb{R}}$
עבורה
$P^{-1} A P$
מטריצה אלכסונית.
\end{exercisechap}

\begin{solution}
ראשית נמצא ערכים עצמיים. מתקיים
\begin{align*}
\det\pmat{2 & 1 \\ 1 & 2} &= 3 \\
\text{.} \tr\pmat{2 & 1 \\ 1 & 2} &= 4 
\end{align*}
לכן אם
$\lambda_1, \lambda_2$
הערכים העצמיים נקבל
$\lambda_1 \lambda_2 = 3$
וגם
$\lambda_1 + \lambda_2 = 4$,
לכן הערכים העצמיים של
$A$
הם
$3$
מריבוי אלגברי
$2$
ו־%
$1$
מריבוי אלגברי
$1$.

המרחב העצמי של
$3$
הוא
$\Span\prs{e_1, e_2 + e_3}$.
נחפש את המרחב העצמי של
$1$.
נדרג
\begin{align*}
A - I &= \pmat{2 & 0 & 0 \\ 0 & 1 & 1 \\ 0 & 1 & 1}
\to \pmat{1 & 0 & 0 \\ 0 & 1 & 1 \\ 0 & 0 & 0}
\end{align*}
ואז המרחב העצמי הוא
$\Span\prs{e_2 - e_3}$.

כדי לקבל בסיס אורתונורמלי נוכל לבצע את תהליך גרם־שמידט על בסיס של כל מרחב עצמי בנפרד, או על הבסיס כולו. אם אנו יודעים שהמטריצה נורמלית, המרחבים העצמיים השונים שלה ניצבים, ולכן שתי הדרכים שקולות. באופן כללי, יש להראות שקיבלנו בסיס מלכסן, או אורתונורמלי, תלוי בשיטה שבחרנו.

נבצע את תהליך גרם־שמידט על
$\prs{e_1, e_2+e_3}$.
נקבל בסיס
$\prs{e_1, \frac{e_2 + e_3}{\sqrt{2}}}$.
על
$\prs{e_2 - e_3}$
נקבל בסיס
$\prs{\frac{e_2 - e_3}{\sqrt{2}}}$.
נרצה להראות כי
\[B = \pmat{\frac{e_2 - e_3}{\sqrt{2}}, e_1, \frac{e_2 + e_3}{\sqrt{2}}}\]
בסיס מלכסן של
$A$.

אכן, כל הוקטורים ב־%
$B$
הם וקטורים עצמיים של
$A$.
לכן אם ניקח
$P \ceq \brs{\id_{\mbb{C}^3}}^B_E$
נקבל כי
$P^{-1} A P$
מטריצה אלכסונית, וכי
$P$
אורתוגונלית, שכן עמודותיה הן בסיס אורתונורמלי.
\end{solution}

\begin{exercisechap}
יהי
$T \in \End_{\mbb{C}}\prs{V}$.
הראו כי
$T$
נורמלי אם ורק אם קיים פולינום
$p \in \mbb{C}\brs{x}$
עבורו
$T^* = p\prs{T}$.

היעזרו במשפט הבא.

\begin{theorem}[אינטרפולציית לגרנג']
תהיינה
$x_1, \ldots, x_n, y_1, \ldots, y_n \in \mbb{C}$.
קיים
$p \in \mbb{C}_{n+1}\brs{x}$
עבורו
$p\prs{x_i} = y_i$
לכל
$i \in [n]$.
\end{theorem}
\end{exercisechap}

\begin{solution}
נניח כי קיים פולינום
$p \in \mbb{C}\brs{x}$
עבורו
$T^* = p\prs{T}$.
כיוון ש־%
$T$
מתחלף עם כל פולינום ב־%
$T$,
נקבל
\[T^* T = p\prs{T} T = T p\prs{T} = T T^*\]
ולכן
$T$
נורמלי.

בכיוון השני, נניח כי
$T$
נורמלי.
ממשפט הפירוק הספקטלי קיים בסיס אורתונורמלי
$B$
של
$V$
עבורו
$\brs{T}_B = \diag\prs{\lambda_1, \ldots, \lambda_n}$
אלכסונית.
אז
\[\text{.} \brs{T^*}_B = \brs{T}_B^* = \diag\prs{\bar{\lambda}_1, \ldots, \bar{\lambda}_n}\]
מאינטרפולציית לגרנג', קיים פולינום
$p \in \mbb{C}\brs{x}$
עבורו
$p\prs{\lambda_i} = \bar{\lambda}_i$
לכל
$i \in [n]$.
אז
\[\brs{T^*}_B = \diag\prs{p\prs{\lambda}_1, \ldots, p\prs{\lambda_n}} = p\prs{\diag\prs{\lambda_1, \ldots, \lambda_n}} = p\prs{\brs{T}_B} = \brs{p\prs{T}}_B\]
ונקבל כי
$T^* = p\prs{T}$,
כנדרש.
\end{solution}

\begin{exercisechap}
יהי
$T \in \End_{\mbb{C}}\prs{V}$
נורמלי. הראו כי
$T$
הרמיטי אם ורק אם כל הערכים העצמיים של
$T$
ממשיים.
\end{exercisechap}

\begin{solution}
ממשפט הפירוק הספקטרלי קיים בסיס אורתונורמלי
$B$
של
$V$
עבורו
$\brs{T}_B = \diag\prs{\lambda_1, \ldots, \lambda_n}$
אלכסונית.
כעת
$T$
הרמיטי אם ורק אם
$T^* = T$
אם ורק אם
$\brs{T^*}_B = \brs{T}_B$.
כיוון ש־%
$B$
אורתונורמלי, מתקיים
$\brs{T^*}_B = \overline{\brs{T}_B}^t = \diag\prs{\bar{\lambda}_1, \ldots, \bar{\lambda}_n}$.
לכן השוויון הנ"ל מתקיים אם ורק אם
$\bar{\lambda}_i = \lambda_i$
לכל
$i \in \brs{n}$,
כלומר אם ורק אם כל הערכים העצמיים ממשיים.
\end{solution}

\begin{exercisechap}
יהי
$T \in \End_{\mbb{C}}\prs{V}$
נורמלי. הראו כי
$T$
אוניטרי אם ורק אם
הערכים העצמיים של
$T$
הינם על מעגל היחידה.
\end{exercisechap}

\begin{solution}
ממשפט הפירוק הספקטרלי קיים בסיס אורתונורמלי
$B$
של
$V$
עבורו
$\brs{T}_B = \diag\prs{\lambda_1, \ldots, \lambda_n}$
אלכסונית.
אז
\[\text{.} \brs{T}_B^* = \overline{\brs{T}_B}^t = \diag\prs{\bar{\lambda}_1, \ldots, \bar{\lambda}_n}\]
כעת,
\[\text{.} \brs{T^* T}_B = \brs{T^*}_B \brs{T}_B = \diag\prs{\bar{\lambda}_1 \lambda_1 \ldots, \bar{\lambda}_n \lambda_n} = \diag\prs{\abs{\lambda_1}, \ldots, \abs{\lambda_n}}\]
$T$
אוניטרי אם ורק אם
$T^* T = \id$
אם ורק אם
$\brs{T^* T} = I_n$,
אבל מהחישוב הנ"ל זה מתקיים בדיוק כאשר הערכים העצמיים של
$T$
על מעגל היחידה (כלומר, עם ערך מוחלט
$1$).
\end{solution}

\begin{exercisechap}
יהי
$V$
מרחב מכפלה פנימית ממימד סופי מעל
$\mbb{C}$.

\begin{enumerate}
\item
יהי
$T \in \End_{\mbb{C}}\prs{V}$
הפיך. הוכיחו כי
$\prs{T^*}^{-1} = \prs{T^{-1}}^*$.

\item
נסמן ב־%
$\mcal{M}$
את קבוצת כל ההעתקות
$T \in \End_{\mbb{C}}\prs{V}$
ההרמיטיות, ונסמן ב־%
$\mcal{N}$
את קבוצת כל ההעתקות
$U \in \End_{\mbb{C}}\prs{V}$
האוניטריות ש־%
$1$
אינו ערך עצמי שלהן.
יהי
\begin{align*}
\Phi \colon \mcal{M} &\to V \\
\text{.} \hphantom{lala} T &\mapsto \prs{T + i \id_V} \prs{T - i \id_V}^{-1}
\end{align*}
הראו כי
$\Phi$
מוגדר היטב וכי
$\im\prs{\Phi} \subseteq \mcal{N}$.

\item
הוכיחו כי
$\Phi$
חד־חד ערכית וכי
$\im\prs{\Phi} = \mcal{N}$.
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
\item נראה כי
$\prs{T^{-1}}^* \circ T^* = \id_V$.
אכן, ידוע
$\prs{S_1 \circ S_2}^* = S_2^* \circ S_1^*$
ולכן
\[\text{,} \prs{T^{-1}}^* \circ T^* = \prs{T \circ T^{-1}}^* = \id_V^* = \id_V\]
כנדרש.

\item
ראשית, יש להראות כי
$T - i \id_V$
אכן הפיך לכל
$T \in \mcal{M}$.
ראינו כי אופרטורים אוניטריים הינם עם ערכים עצמיים ממשיים, לכן
$i$
אינו ערך עצמי של
$T$
ולכן זה אכן המקרה.

כעת נראה כי
$\Phi\prs{T} \in \mcal{N}$
לכל
$T \in \mcal{M}$.
ראינו כי אופרטור נורמלי הינו אוניטרי אם ורק אם הערכים העצמיים שלו על מעגל היחידה, לכן יש להראות כי
$\Phi\prs{T}$
נורמלי, כי הערכים העצמיים שלו על מעגל היחיד, וכי הם שונים מאחת.

$T$
הרמטיטי ולכן נורמלי, וממשפט פירוק הספקטרלי קיים בסיס אורתונורמלי
$B$
עבורו
$T$
לכסין.
אז
\[\brs{\Phi\prs{T}}_B = \prs{\brs{T}_B + i I_n} \prs{\brs{T}_B - i I_n}^{-1}\]
גם מטריצה אלכסונית. כיוון שהבסיס
$B$
אורתונורמלי, נקבל שוב ממשפט הפירוק הספקטרלי כי
$\Phi\prs{T}$
נורמלי.

כעת, ערך עצמי של
$\Phi\prs{T}$
יהיה מהצורה
$\mu = \frac{\lambda + i}{\lambda - i}$
עבור
$\lambda$
ערך עצמי של
$T$.
כיוון ש־%
$T$
הרמיטי,
$\lambda$
כזה הינו ממשי.
נשים לב כי
$\mu \neq 1$
כי המונה והמכנה שונים, ונותר לנו להראות כי
$\abs{\mu} = 1$.
אכן,
\begin{align*}
\mu &= \frac{\prs{\lambda + i}^2}{\prs{\lambda + i}\prs{\lambda - i}}
\end{align*}
ואז
\begin{align*}
\abs{\mu} &= \mu \bar{\mu}
\\&= \frac{\prs{\lambda + i}^2 \overline{\prs{\lambda + i}}^2}{\prs{\lambda + i}^2\prs{\lambda - i}^2}
\\&= \frac{\prs{\lambda + i}^2\prs{\lambda - i}^2}{\prs{\lambda + i}^2\prs{\lambda - i}^2}
\\ \text{,} \hphantom{\abs{\mu}} &= 1
\end{align*}
כנדרש.

\item
ננסה למצוא את
$\lambda$
בחזרה מתוך
$\mu$.
נבודד אותו במשוואה
$\mu = \frac{\lambda + i}{\lambda - i}$.
נתחיל בכפל במכנה.
\begin{align*}
\mu \lambda - i \mu = \lambda + i
\end{align*}
נעביר אגפים ונקבל
\begin{align*}
\prs{\mu - 1}\lambda = \prs{\mu + 1}i
\end{align*}
ולכן
\begin{align*}
\text{.} \lambda = i \cdot \frac{\mu + 1}{\mu - 1}
\end{align*}
בהשראת זאת, נגדיר
\begin{align*}
\Psi \colon \mcal{N} &\to V \\
U &\mapsto i \prs{U + \id_V}\prs{U - \id_V}^{-1}
\end{align*}
ונראה שמתקיים
$\im\prs{\Psi} = \mcal{M}$
וגם
$\Psi = \Phi^{-1}$.

ראשית, יהי
$U \in \mcal{N}$
ונראה כי
$\Phi\prs{U} \in \mcal{M}$.
כיוון ש־%
$U$
אוניטרי, הוא נורמלי וממשפט הפירוק הספקטרלי קיים בסיס אורתונורמלי
$B$
עבורו
$\brs{U}_B = \diag\prs{\mu_1, \ldots, \mu_n}$
מטריצה אלכסונית. ראינו גם שבמקרה זה הערכים העצמיים הינם על מעגל היחידה, ומהגדרת
$\mcal{N}$
הם אינם כוללים את
$1$.
כעת
\[\text{,} \brs{\Psi\prs{U}}_B = \diag\prs{i \cdot \frac{\mu_1 + 1}{\mu_1 - 1}, \ldots, i \cdot \frac{\mu_n + 1}{\mu_n - 1}}\]
ומהחישוב למעלה נקבל כי איברי האלכסון ממשיים. ראינו שאופרטור הינו הרמיטי אם ורק אם הוא לכסין בבסיס אורתונורמלי וגם איברי האלכסון שלו ממשיים, ולכן
$\Phi\prs{U} \in \mcal{M}$.

מהחישוב למעלה נקבל גם כי
\begin{align*}
\brs{\Phi\prs{\Psi\prs{U}}}_B &= \diag\prs{\mu_1, \ldots, \mu_n} = \brs{U}_B \\
\text{,} \brs{\Psi \prs{\Phi\prs{T}}}_C &= \diag\prs{\lambda_1, \ldots, \lambda_n} = \brs{T}_C 
\end{align*}
עבור
$U$
כזה ועבור
$T \in \mcal{M}$
לכסין בבסיס אורתונורמלי
$C$.
לכן אם נסתכל על
$\Phi, \Psi$
בתור העתקות
\begin{align*}
\Phi \colon \mcal{M} &\to \mcal{N} \\
\Psi \colon \mcal{N} &\to \mcal{M}
\end{align*}
על ידי צמצום הטווח, נקבל כי
$\Phi, \Psi$
העתקות הופכיות, ובפרט חד־חד ערכיות ועל.

\end{enumerate}
\end{solution}

\begin{exercisechap}
יהי
$T \in \End_{\mbb{C}}\prs{V}$
הרמיטי ונניח שלכל ערך עצמי
$\lambda \in \mbb{C}$
מתקיים
$\lambda \geq 0$.
הראו כי קיים אופרטור יחיד
$S \in \End_{\mbb{C}}\prs{V}$
שכל הערכים העצמיים שלו אי־שליליים וכך שמתקיים
$S^2 = T$.
\end{exercisechap}

\begin{solution}
$T$
הרמיטי ולכן נורמלי. ממשפט הפירוק הספקטרלי, קיים בסיס אורתונורמלי
$B$
עבורו
$\brs{T}_B = \diag\prs{\lambda_1, \ldots, \lambda_n}$.
מההנחה,
$\lambda_i \geq 0$
לכל
$i \in \brs{n}$.
אז קיים שורש חיובי
$\sqrt{\lambda_i}$
וניקח
$S = \prs{\eta^B_B}^{-1} \prs{\diag\prs{\sqrt{\lambda_1}, \ldots, \sqrt{\lambda_n}}}$
להיות האופרטור עבורו
$\brs{S}_B = \prs{\diag\prs{\sqrt{\lambda_1}, \ldots, \sqrt{\lambda_n}}}$.
אז
$\brs{S^2}_B = \diag\prs{\lambda_1, \ldots, \lambda_n} = \brs{T}_B$
ולכן
$S^2 = T$.
\end{solution}

\begin{exercisechap}
נראה בתרגיל זה כי כל אופרטור
$T \in \End_{\mbb{C}}\prs{V}$
ניתן לכתיבה כצירוף לינארי של ארבעה אופרטורים אוניטריים.

\begin{enumerate}
    \item יהי
    $T \in \End_{\mbb{C}}\prs{V}$.
    הראו שניתן לכתוב את
    $T$
    כצירוף לינארי של שני אופרטורים הרמיטיים.
    \item יהי
    $T \in \End_{\mbb{C}}\prs{V}$
    הרמיטי. הראו שניתן לכתוב את
    $T$
    כצירוף לינארי של שני אופרטורים אוניטריים.
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
    \item נכתוב
    \begin{align*}
        T &= \frac{T + T^*}{2} + \frac{T - T^*}{2} = \frac{T + T^*}{2} + i \prs{\frac{T - T^*}{2i}}
    \end{align*}
    ואכן
    \begin{align*}
        \prs{\frac{T+T^*}{2}}^* &= \frac{1}{2} \prs{T^* + T^{**}} = \frac{1}{2} \prs{T + T^*} \\
        \prs{\frac{T - T^*}{2i}}^* &= \overline{\frac{1}{2i}} \prs{T^* - T^{**}} = -\frac{1}{2i} \prs{T^* - T} = \frac{1}{2} \prs{T - T^*}
    \end{align*}
    לכן שני האופרטורים הרמיטיים.

    \item
    \textbf{רעיון:}
    נרצה, באנלוגיה למקרה הקודם, לכתוב
    \[\text{.} T = \frac{T + i S}{2} + \frac{T - i S}{2}\]
    כיוון ש־%
    $T$
    הרמיטי ונרצה לכתוב את
    $S$
    בתור ביטוי ב־%
    $T$,
    נרצה לחפש
    $S$
    הרמיטי שמתחלף עם
    $T$.
    אז, כדי ש־%
    $T + i S$
    יהיה אוניטרי צריך להתקיים
\[\id_V = \prs{T+iS}\prs{T+iS}^* = \prs{T+iS}\prs{T^* - i S^*} = \prs{T+iS}\prs{T-iS} = T^2 - S^2\]
    ולכן
    $S^2 = \id_V - T^2$.
    
    יהי
    $T \in \End_{\mbb{C}}\prs{V}$
    הרמיטי.
    עבור אופרטורים אוניטריים, הערכים העצמיים על מעגל היחידה. אז, הערכים העצמיים של סכום של אופרטורים אוניטריים לא יוכלו להיות גדולים מדי. לשם כך, נתחיל בנרמול של
    $T$.
    
    נסמן ב־%
    $\sigma\prs{T}$
    את אוסף הערכים העצמיים של
    $T$,
    ונגדיר
    \begin{align*}
        c\prs{T} &\coloneqq \max\set{\abs{\lambda}}{\lambda \in \sigma\prs{T}}
    \end{align*}
    וגם
    $\tilde{T} = \frac{1}{c\prs{T}} T$.
    נראה כי
    $\tilde{T} = \frac{F + G}{2}$
    צירוף של שני אופרטורים אוניטריים ונקבל כי
    $T = c\prs{T} \tilde{T} = \frac{c\prs{T}}{2} F + \frac{c\prs{T}}{2} G$
    צירוף לינארי של שני אופרטורים אוניטריים.
    
    נשים לב כי הערכים העצמיים של
    $\tilde{T}$
    מערך מוחלט לכל היותר
    $1$.
    אכן, אם
    $\lambda \in \mbb{C}$
    ערך עצמי עם וקטור עצמי
    $v$,
    נקבל
    \[T\prs{v} = c\prs{T} \tilde{T}\prs{v} = c\prs{T} \lambda v\]
    ולכן
    $v$
    וקטור עצמי של
    $T$
    עם ערך עצמי
    $c\prs{T} \lambda$.
    אבל, מהגדרת
    $c\prs{T}$
    נקבל
    \[c\prs{T} \geq \abs{c\prs{T} \lambda} = c\prs{T} \abs{\lambda}\]
    ולכן
    $\abs{\lambda} \leq 1$.
    
    כעת,
    $\tilde{T}$
    הרמיטי כי
    $T$
    הרמיטי. לכן הוא נורמלי, ולכן קיים בסיס אורתונורמלי
    $B$
    של
    $V$
    עבורו
    $\brs{T}_B = \diag\prs{\lambda_1, \ldots, \lambda_n}$.
    נקבל כי הערכים העצמיים של
    $\id_V - T^2$,
    שהינם מהצורה
    $1 - \lambda^2$
    עבור
    $\lambda$
    ערך עצמי של
    $\tilde{T}$,
    הינם אי־שליליים.
    לכן, קיים שורש
    $\sqrt{\id_V - \tilde{T}^2}$.
    
    יהיו
    \begin{align*}
        F &= \tilde{T} + i\sqrt{\id_V - \tilde{T}^2} \\
        G &= \tilde{T} - i\sqrt{\id_V - \tilde{T}^2}
    \end{align*}
    ואז
    \begin{align*}
        \tilde{T} &= \frac{F+G}{2} \\
        F^* F &= \prs{\tilde{T} + i\sqrt{\id_V - \tilde{T}^2}}* \prs{\tilde{T} + i\sqrt{\id_V - \tilde{T}^2}}
        \\&=
        \prs{\tilde{T} - i \sqrt{\id_V - \tilde{T}^2}}\prs{\tilde{T} + i\sqrt{\id_V - \tilde{T}^2}}
        \\&= \tilde{T}^2 - \prs{\id_V \tilde{T}^2}
        \\&= \id_V
    \end{align*}
    ובאותו אופן
    $G^* G = \id_V$
    (אפשר גם לשים לב כי
    $F^* = G$
    ולכן
    $G^* G = F F^* = \id_V$).
\end{enumerate}
\end{solution}

\section{פירוק לערכים סינגולריים ופירוק פולארי}

יהיו
$V,W$
מרחבי מכפלה פנימית סוף־מימדיים, ותהי
$T \in \Hom_{\mbb{F}}\prs{V,W}$.
אם
$V = W$
ראינו כי
$T$
צמוד לעצמו (נורמלי) אם ורק אם קיים בסיס
$B$
עבורו
$\brs{T}_B$
אלכסונית.
ראינו שלהעתקות לינאריות כלליות יש איפיון דומה.

\begin{definition}[מטריצה מלבנית אלכסונית]
מטריצה
$A \in \Mat_{m \times n}\prs{\mbb{F}}$
נקראת
\emph{מלבנית אלכסונית}
אם
$a_{i,j} = 0$
לכל
$i \neq j$.
\end{definition}

\begin{theorem}[פירוק לערכים סינגולריים]
יהיו
$V,W$
מרחבי מכפלה פנימית סוף־מימדיים, ותהי
$T \in \Hom_{\mbb{F}}\prs{V,W}$.
קיימים בסיסים אורתונורמליים
$B,C$
של
$V,W$
בהתאמה עבורם
$\brs{T}^B_C$
מלבנית אלכסונית.

בנוסף, הערכים
$\sigma_i = \prs{\brs{T}^B_C}_{i,i}$
שנקראים
\emph{הערכים הסינגולריים}
של
$T$
הינם ממשיים אי־שליליים ונקבעים ביחידות תחת הדרישה
\[\text{.} \sigma_1 \geq \sigma_2 \geq \ldots \geq \sigma_{\min\prs{m,n}}\]
\end{theorem}

\begin{corollary}[פירוק לערכים סינגולריים של מטריצה] \label{corollary:matrix-svd}
תהי
$A \in \Mat_{m,n}\prs{\mbb{F}}$
עבור
$\mbb{F} \in \set{\mbb{R}, \mbb{C}}$.
מהמשפט, קיימים בסיסים אורתונורמליים
$B,C$
עבורם
$\Sigma \coloneqq \brs{T_A}^B_C$
אלכסונית מלבנית.
אז
\[\text{.} A = \brs{T_A}_E = M^C_E \brs{T_A}^B_C M^E_B = \brs{T_A}_E = M^C_E \Sigma M^E_B\]
המטריצות
$U \coloneqq M^C_E, V \coloneqq M^B_E$
הינן אורתוגונליות (אוניטריות) כיוון שהן שולחות בסיס אורתונורמלי לבסיס אורתונורמלי. אכן, אם
$B = \prs{b_1, \ldots, b_n}$
נקבל
\[\text{.} M^B_E e_i = M^B_E \brs{b_i}_B = b_i\]
בפרט,
$M^E_B = V^{-1} = V^*$
ונקבל כי
$A = U \Sigma V^*$.
\end{corollary}

\begin{definition}[אופרטור מוגדר אי־שלילית]
אופרטור
$T \in \End\prs{V}$
על מרחב מכפלה פנימית סוף־מימדי נקרא
\emph{מוגדר אי־שלילית}
אם הוא צמוד לעצמו (הרמיטי) וגם
$\trs{Tv, v} \geq 0$
לכל
$v \in V$.
\end{definition}

\begin{remark}
באופן דומה נגדיר אופרטור מוגדר חיובית%
\slash%
אי־חיובית%
\slash
שלילית.
\end{remark}

\begin{proposition}
אופרטור צמוד לעצמו (נורמלי) הינו מוגדר אי־שלילית אם ורק אם כל הערכים העצמיים שלו (ממשיים) אי־שליליים.
\end{proposition}

\begin{proposition}
האופרטור
$T^* T$
הינו מוגדר חיובית, והערכים הסינגולריים
$\sigma_1, \ldots, \sigma_n$
של העתקה לינארית
$T \in \Hom_{\mbb{F}}\prs{V,W}$
הם הערכים העצמיים של האופרטור
$\sqrt{T^* T} \in \End_{\mbb{F}}\prs{V}$.
\end{proposition}

נתאר כעת איך למצוא בסיסים
$B,C$
כנ"ל.
נסמן
$n \coloneqq \dim \prs{V}$
ו־%
$m \coloneqq \dim\prs{W}$.

\begin{enumerate}
\item
כעת נמצא את הערכים העצמיים $\lambda_i$ של $T^* T$. נסמן
$\sigma_i = \sqrt{\lambda_i}$
ונסדר אותם מהגדול לקטן
$\sigma_1 \geq \sigma_2 \geq \ldots \geq \sigma_n$.

\item
ניקח
$B = \prs{v_1, \ldots, v_n}$
בסיס אורתונורמלי של וקטורים עצמיים מתאימים של
$T^* T$
(שקיים לפי פירוק ספקטרלי).

יהי
$k \in \brs{n}$
המקסימלי עבורו
$\lambda_k > 0$.
נגדיר
$C' = \prs{\frac{1}{\sigma_1} T\prs{v_1}, \ldots, \frac{1}{\sigma_k} T\prs{v_k}}$.

אז אכן מתקיים
$T\prs{v_i} = \sigma_i u_i$
וגם
\begin{align*}
\trs{\frac{1}{\sigma_i} T\prs{v_i}, \frac{1}{\sigma_j} T\prs{v_j}}
&=
\frac{1}{\sigma_i \sigma_j} \trs{T\prs{v_i}, T\prs{v_j}}
\\&=
\frac{1}{\sigma_i \sigma_j} \trs{T^* T\prs{v_i}, v_j}
\\&=
\frac{\lambda_i}{\sigma_i \sigma_j} \trs{v_i, v_j}
\\&=
\frac{\lambda_i}{\sigma_i \sigma_j} \delta_{i,j}
\\&=
\frac{\lambda_i}{\sigma_i^2} \delta_{i,j}
\\ \text{.} \hphantom{\trs{\frac{1}{\sigma_i} T\prs{v_i}, \frac{1}{\sigma_j} T\prs{v_j}}} &=
\delta_{i,j}
\end{align*}

\item
נשלים את
$C'$
לבסיס אורתונורמלי
$C$
של
$W$.

לכל
$i > k$
מתקיים
\[\text{.} \norm{T\prs{v_i}}^2 = \trs{Tv_i, Tv_i} = \trs{T^* T v_i, v_i} = 0\]
לכן
$T\prs{v_i} = 0$
ולא משנה באיזו דרך נשלים לבסיס אורתונורמלי.
\end{enumerate}

\begin{remark}
כדי למצוא את הפירוק
$A = U \Sigma V^*$
של מטריצה
$A \in \Mat_{m,n}\prs{\mbb{F}}$,
נמצא את הפירוק לערכים סינגולריים של
$T_A \in \Hom_{\mbb{F}}\prs{\mbb{F}^n, \mbb{F}^m}$
ונעבוד לפי התיאור במסקנה
\ref{corollary:matrix-svd}.
\end{remark}

\begin{exercisechap}
תהי
\[\text{.} A = \pmat{1 & -1 \\ 0 & 1 \\ 1 & 0} \in \Mat_{3 \times 2}\prs{\mbb{C}}\]
מיצאו את הפירוק של
$A$
לערכים סינגולריים.
\end{exercisechap}

\begin{solution}
הערכים הסינגולריים הם הערכים העצמיים של
$\sqrt{A^* A}$.
מתקיים
$A^* A = A^t A = \pmat{2 & -1 \\ -1 & 2}$.
אם
$\lambda, \mu$
הערכים העצמיים, נקבל
\begin{align*}
\lambda + \mu = \tr\prs{A^* A} = 4 \\
\text{,} \lambda \mu = \det\prs{A^* A} = 3
\end{align*}
לכן הערכים העצמיים הם
$3,1$,
ולכן הערכים הסינגולריים הם
$\sqrt{3}, 1$.

כעת, כדי למצוא את הבסיס
$B$
נחפש בסיס אורתונורמלי של וקטורים עצמיים של
$A^* A$.
נשים לב מיד כי
$e_1 - e_2$
וקטור עצמי של
$3$
וכי
$e_1 + e_2$
וקטור עצמי של
$1$.
ננרמל את הוקטורים, שהינם ניצבים בתור וקטורים עצמיים עם ערכים עצמיים שונים עבור אופרטור צמוד לעצמו (הרמיטי), ונקבל בסיס אורתונורמלי
\[B = \pmat{\frac{e_1 - e_2}{\sqrt{2}}, \frac{e_1 + e_2}{\sqrt{2}}}\]
של
$\mbb{C}^2$.

נגדיר
\begin{align*}
\tilde{C} &= \prs{\frac{1}{\sqrt{3}} A \prs{\frac{e_1 - e_2}{\sqrt{2}}}, A\prs{\frac{e_1 + e_2}{\sqrt{2}}}}
\\&= \prs{\frac{1}{\sqrt{6}} \pmat{2\\-1\\1}, \frac{1}{\sqrt{2}} \pmat{0\\1\\1}}
\end{align*}
ונשלים קבוצה סדורה זאת לבסיס אורתונורמלי של
$\mbb{C}^3$.

נסמן
$w = \pmat{a\\b\\c}$
ונפתור את המשוואות
\begin{align*}
2a - b + c &= 0\\
b + c &= 0
\end{align*}
כדי לקבל
$w = \pmat{1\\1\\-1}$.
כעת,
$\norm{w} = 3$
לכן לאחר נרמול נקבל
$w_3 = \frac{1}{\sqrt{3}} \pmat{1\\1\\-1}$.
נגדיר
\begin{align*}
\text{.} C \ceq \tilde{C} * \prs{w_3}
\end{align*}

נקבל את הפירוק
$A = U \Sigma V^*$
עבור
\begin{align*}
U &= M^C_E = \pmat{\frac{2}{\sqrt{6}} & 0 & \frac{1}{\sqrt{3}} \\ -\frac{1}{\sqrt{6}} & \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{3}} \\ \frac{1}{\sqrt{6}} & \frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{3}}} \\
\Sigma &= \pmat{\sqrt{3} & 0 \\ 0 & 1 \\ 0 & 0} \\
\text{.} V &= M^B_E = \frac{1}{\sqrt{2}} \pmat{1 & 1 \\ -1 & 1}
\end{align*}
כלומר,
\begin{align*}
\text{.} A = \pmat{\frac{2}{\sqrt{6}} & 0 & \frac{1}{\sqrt{3}} \\ -\frac{1}{\sqrt{6}} & \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{3}} \\ \frac{1}{\sqrt{6}} & \frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{3}}} \pmat{\sqrt{3} & 0 \\ 0 & 1 \\ 0 & 0} \pmat{\frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}}}
\end{align*}
\end{solution}

\begin{exercisechap}
מה יקרה אם נחשב בעזרת האלגוריתם פירוק לערכים סינגולריים עבור אופרטור נורמלי?
באילו מקרים האלגוריתם יתן
$B = C$?
\end{exercisechap}

\begin{solution}
ניקח בסיס
$B = \prs{v_1, \ldots, v_n}$
עבורו
$\brs{T}_B = \diag\prs{\lambda_1, \ldots, \lambda_n}$,
ואז
\[\text{,} \brs{T^* T}_B = \diag\prs{\bar{\lambda}_1, \ldots, \bar{\lambda}_n} \diag\prs{\lambda_1, \ldots, \lambda_n} = \diag\prs{\abs{\lambda_1}^2, \ldots, \abs{\lambda_n}^2}\]
\end{solution}
וכן
$\sqrt{\brs{T^* T}_B} = \diag\prs{\abs{\lambda_1}, \ldots, \abs{\lambda_n}}$.
אז החישוב שלנו מראה
\begin{align*}
\text{.} C \coloneqq \prs{u_1, \ldots, u_n} = \prs{\frac{1}{\abs{\lambda_1}} T\prs{v_1}, \ldots, \frac{1}{\abs{\lambda_n}} T\prs{v_n}}
\end{align*}
כעת,
$T\prs{v_i} = \lambda_i v_i$
ונקבל כי
$u_i = \frac{\lambda_i}{\abs{\lambda_i}} v_i$.
אז
$u_i = v_i$
אם ורק אם
$\lambda_i$
ממשי אי־שלילי.

לכן האלגוריתם יתן
$B = C$
אם ורק אם כל הערכים העצמיים של
$T$
הינם ממשיים אי־שליליים. כלומר, אם ורק אם
$T$
מוגדר אי־שלילית.

\begin{exercisechap}
הוכיחו או הפריכו: הערכים הסינגולריים של
$T^2$
הם ריבועי הערכים הסינגולריים של
$T$.
\end{exercisechap}

\begin{solution}
הטענה איננה נכונה, למשל עבור
$A = \pmat{0 & 1 \\ 0 & 0}$.
אכן, הערכים הסינגוליים של
$A^2$
הם
$\prs{0,0}$
כי
$A^2 = 0$,
אבל הערכים הסינגולריים של
$A$
הם
$\prs{0,1}$
כי
$A^t A = \pmat{0 & 0 \\ 0 & 1}$.
\end{solution}

\begin{exercisechap}
יהי
$T \in \End_{\mbb{R}}\prs{V}$
עם ערכים סינגולריים
$\sigma_1, \ldots, \sigma_n$.
הראו כי
$\norm{T\prs{v}} \leq \norm{v} \cdot \max_{i \in [n]} \set{\sigma_i}$
לכל
$v \in V$.
\end{exercisechap}

\begin{exercisechap}
תהיינה
$A,B,U \in \Mat_n\prs{\mbb{F}}$
עבור
$U$
אורתוגונלית (אוניטרית) המקיימת
$B = U^* A U$,
ונניח כי
$A$
מוגדרת אי־שלילית.
הראו כי
$B$
מוגדרת אי־שלילית.
\end{exercisechap}

\begin{solution}
ראשית,
$B$
אורתוגונלית (אוניטרית) כמפכלה של כאלה.
כעת, לכל
$v \in V$
מתקיים
$\trs{Bv, v} = \trs{U^* A U v, v} = \trs{A \prs{U v}, U v}$
כאשר ביטוי זה הינו אי־שלילי כי
$A$
מוגדרת אי־שלילית.
\end{solution}

\begin{remark}
באותו אופן, מטריצה הדומה אורתוגונלית (אוניטרית) למטריצה מוגדרת
חיובית%
\slash%
אי־חיובית%
\slash%
שלילית הינה
חיובית%
\slash%
אי־חיובית%
\slash%
שלילית.
\end{remark}

נעבור כעת למשפט פירוק נוסף שנובע מהפירוק לערכים סינגולריים.

\begin{theorem}[פירוק פולארי לאופרטורים]
יהי
$T \in \End_{\mbb{F}}\prs{V}$
אופרטור על מרחב מכפלה פנימית סוף־מימדי. יש אופרטור אורתוגונלי (אוניטרי)
$U \in \End_{\mbb{F}}\prs{V}$
ואופרטור מוגדר אי־שלילית
$R \in \End_{\mbb{F}}\prs{V}$
עבורם
$T = UR$.

בנוסף, אם
$T$
הפיך, האופרטור
$R$
מוגדר חיובית.
\end{theorem}

\begin{theorem}[פירוק פולארי למטריצות]
תהי
$A \in \Mat_n\prs{\mbb{F}}$.
יש מטריצה
$U \in \Mat_n\prs{\mbb{F}}$
אורתוגונלית (אוניטרית) ומטריצה
$R \in \Mat_n\prs{\mbb{F}}$
מוגדרת אי־‏שלילית עבורן
$A = UR$.

בנוסף,
אם
$A$
הפיכה, המטריצה
$R$
מוגדרת חיובית.
\end{theorem}

\subsubsection{מציאת פירוק פולארי}

\begin{enumerate}
\item
כדי למצוא פירוק פולארי עבור מטריצות, ניעזר בפירוק הפולארי
$A = U \Sigma V^*$.
נשים לב כי
$\Sigma$
הינה מוגדרת אי־שלילית, וכדי להיעזר בכך נכתוב
\[\text{.} A = U V^* V \Sigma V^* = \prs{U V^*} \prs{V \Sigma V^*}\]
אז
$U V^*$
אורתוגונלית (אוניטרית) כמכפלת מטריצות אורתוגונליות (אוניטריות), ו־%
$V \Sigma V^*$
מוגדרת אי־שלילית כי היא דומה אוניטרית למטריצה אלכסונית אי־שלילית.
אם
$A$
הפיכה, גם
$A^* A$
הפיכה ולכן גם
$\Sigma = \sqrt{A^* A}$.
אז היא מוגדרת חיובית ולכן גם
$V \Sigma V^*$
מוגדרת חיובית.

\item
עבור אופרטור
$T \in \End_{\mbb{F}}\prs{V}$,
ניקח מייצגת לפי בסיס אורתונורמלי
$B$
ונכתוב
$\brs{T}_B = \tilde{U} \tilde{R}$
עבור
$\tilde{U}$
אורתוגונלי (אוניטרי) ועבור
$\tilde{R}$
מוגדר אי־שלילית. נסמן ב־%
$U \coloneqq \prs{\eta^B_B}^{-1}\prs{\tilde{U}}$
ו־%
$R \coloneqq \prs{\eta^B_B}^{-1}\prs{\tilde{R}}$
את האופרטורים המיוצגים על ידי
$\tilde{U}, \tilde{R}$
לפי הבסיס
$B$.

אז
$U$
אורתוגונלי (אוניטרי) כי
$\brs{U}_B = \tilde{U}$
כזה ו־%
$R$
מוגדר אי־שלילית (או מוגדר חיובית, אם
$T$
הפיך) כי
$\brs{R}_B = \tilde{R}$
כזה.
\end{enumerate}

\begin{exercisechap}
מיצאו את הפירוק הפולארי עבור האופרטור הבא.
\begin{align*}
T \colon \mbb{R}^3 &\to \mbb{R}^3 \\
\pmat{x \\ y \\ z} &\mapsto \pmat{z \\ 2x \\ 3y}
\end{align*}
\end{exercisechap}

\begin{solution}
מתקיים
\begin{align*}
\brs{T}_E &= \pmat{0 & 0 & 1 \\ 2 & 0 & 0 \\ 0 & 3 & 0} \\
\brs{T^*}_E &= \pmat{0 & 2 & 0 \\ 0 & 0 & 3 \\ 1 & 0 & 0} \\
\brs{T^* T}_E &= \pmat{4 & 0 & 0 \\ 0 & 9 & 0 \\ 0 & 0 & 1}
\end{align*}
ולכן הערכים הסינגולריים של
$T$
הם
$3,2,1$.

יש לנו בסיס אורתונורמלי
$B = \prs{e_2, e_1, e_3}$
של וקטורים עצמיים.
כדי לקבל את הבסיס השני, נפעיל את
$T$
על וקטורי
$B$
ונחלק בערכים הסינגולריים.
נקבל בסיס אורתונורמלי
\begin{align*}
\text{.} C &= \pmat{\frac{1}{3} T\prs{e_2}, \frac{1}{2} T\prs{e_1}, T\prs{e_3}}
= \prs{e_3, e_2, e_1}
\end{align*}
אז
\begin{align*}
\text{.} \brs{T}_E = W \Sigma V^*
\end{align*}
עבור
\begin{align*}
\Sigma &= \pmat{3&0&0\\0&2&0\\0&0&1} \\
V &= M^B_E = \pmat{0&1&0\\1&0&0\\0&0&1}\\
\text{.} W &= M^C_E = \pmat{0&0&1\\0&1&0\\1&0&0}
\end{align*}
\end{solution}

\begin{exercisechap}
תהי
$A \in \Mat_n\prs{\mbb{F}}$.
הראו כי יש
$U \in \Mat_n\prs{\mbb{F}}$
אורתוגונלית (אוניטרית) עבורה
$A = U \sqrt{A^* A}$.
\end{exercisechap}

\begin{solution}
ראינו כי
$A = U R$
עבור
$U = W V^*$
ועבור
$R = V \Sigma V^*$
כאשר
\begin{align*}
W &= M^C_E \\
V &= M^B_E \\
\Sigma &= \brs{T_A}^B_C
\end{align*}
מטריצות בפירוק לערכים סינגולריים
$A = W \Sigma V^*$.

כעת,
$V \Sigma V^*$
צמודה לעצמה (הרמיטית) כי
$\prs{V \Sigma V^*}^* = V \Sigma V^* = V \Sigma V^*$,
והערכים העצמיים שלה אי־שליליים כי היא דומה ל־%
$\Sigma$.
לכן היא מוגדרת אי־שלילית, ונותר להראות כי
$\prs{V \Sigma V^*}^2 = A^* A$.
כיוון ש־%
$\Sigma$
אלכסונית ממשית, מתקיים
$\Sigma^* = \Sigma$.
לכן
\begin{align*}
\prs{V \Sigma V^*}^2 &= V \Sigma^2 V^*
\\&= V \Sigma^* \Sigma V^*
\\&= M^B_E \brs{T_A^*}^C_B \brs{T_A}^B_C M^E_B
\\&= \brs{T_A^*}^C_E \brs{T_A}^E_C
\\&= \brs{T_A^* T_A}_E
\\ \text{.} \hphantom{\prs{V \Sigma V^*}^2} &= A^* A
\end{align*}

\end{solution}

\chapter{תבניות בילינאריות וריבועיות}

\section{תבניות בילינאריות}

\begin{definition}[תבנית בילינארית]
יהי
$V$
מרחב וקטורי. תבנית בילינארית
$f$
על
$V$
היא העתקה
$f \colon V \to V$
שהינה לינארית בשני הרכיבים.
\end{definition}

\begin{remark}
מעל
$\mbb{C}$
עוסקות לעתים בתבניות ססקווילינאריות ("אחת־וחצי לינאריות") במקום בתבניות בילינאריות. נדבר על אלו בהמשך.
\end{remark}

\begin{definition}[מטריצה מייצגת של תבנית בילינארית]
יהי
$V$
מרחב וקטורי סוף־מימדי עם בסיס
$B = \prs{v_1, \ldots, v_n}$,
ותהי
$f$
תבנית בילינארית על
$V$.
\emph{המטריצה המייצגת}
של
$f$
לפי
$B$
היא
\begin{align*}
\text{.} \brs{f}_B &= \pmat{f\prs{v_1, v_1} & \cdots & f\prs{v_1, v_n} \\ \vdots & \ddots & \vdots \\ f\prs{v_n,v_1} & \cdots & f\prs{v_n,v_n}}
\end{align*}
\end{definition}

\begin{proposition}
לכל
$u,v \in V$
מתקיים
\[\text{.} \brs{u}_B^t \brs{f}_B \brs{v}_B = f\prs{u,v}\]

בנוסף, אם
$\brs{u}_B^t A \brs{v}_B = f\prs{u,v}$
לכל
$u,v \in V$,
אז
$A = \brs{f}_B$.
\end{proposition}

\begin{proof}
נכתוב
\begin{align*}
u &= \sum_{i \in \brs{n}} \alpha_i v_i \\
v &= \sum_{j \in \brs{n}} \beta v_j
\end{align*}
ואז
\begin{align*}
\brs{u}_B^t \brs{f}_B \brs{v}_B &= \sum_{i,j \in \brs{n}} \alpha_i \beta_j \brs{v_i}_B^t \brs{f}_B \brs{v_j}_B
\\&= \sum_{i,j \in \brs{n}} \alpha_i \beta_j e_i^t \brs{f}_B e_j
\\&= \sum_{i,j \in \brs{n}} \alpha_i \beta_j f\prs{v_i, v_j}
\\&= f\prs{\sum_{i \in \brs{n}} \alpha_i v_i, \sum_{j \in \brs{n}} \beta_j v_j}
\\ \text{.} \hphantom{\brs{u}_B^t \brs{f}_B \brs{v}_B} &= f\prs{u,v}
\end{align*}

לבסוף, ניתן לקחת
$u = v_i, v = v_j$
ואז
$\brs{u}_B^t A \brs{v}_B = a_{i,j}$.
לכן אם
$\brs{u}_B^t A \brs{v}_B = f\prs{u,v}$
לכל
$u,v \in V$
נקבל כי
$A = \brs{f}_B$.
\end{proof}

\begin{corollary}
יהיו
$B,C$
שני בסיסים של אותו מרחב וקטורי סוף־מימדי
$V$,
ותהי
$f$
תבנית בילינארית על
$V$.
אז
\begin{align*}
\text{.} \brs{f}_B = \prs{M^B_C}^t \brs{f}_C M^B_C
\end{align*}
\end{corollary}

\begin{proof}
לכל
$u,v \in V$
מתקיים
\begin{align*}
\brs{u}_B^t \prs{M^B_C}^t \brs{f}_C M^B_C \brs{v}_B &=
\prs{M^B_C \brs{u}_B}^t \brs{f}_C M^B_C \brs{v}_B
\\&= \brs{u}_C^t \brs{f}_C \brs{v}_C
\\&= f\prs{u,v}
\end{align*}
לכן מהטענה נקבל שוויון.
\end{proof}

במקרה של אופרטור
$T$
על
$V$
הקשר בין
$\brs{T}_B, \brs{T}_C$
הוא דימיון. המסקנה מראה קשר אחר במקרה של תבניות בילינאריות, שמוביל להגדרה הבאה.

\begin{definition}[מטריצות חופפות]
מטריצות
$A,B \in \Mat_n\prs{\mbb{F}}$
נקראות
\emph{חופפות}
אם קיימת
$P \in \Mat_n\prs{\mbb{F}}$
\textbf{הפיכה}
עבורה
$B = P^t A P$.
\end{definition}

\begin{corollary}
המטריצות
$\brs{f}_B, \brs{f}_C$
המייצגות תבנית בילינארית לפי בסיסים שונים, הינן חופפות.
\end{corollary}

\begin{remark}
ניתן לשחזר את תבנית הבילינארית ממטריצה מייצגת שלה, ולמעשה ההעתקה
$f \mapsto \brs{f}_B$
הינה איזומורפיזם בין מרחב התבניות הבילינאריות והמרחב
$\Mat_n\prs{\mbb{F}}$.
\end{remark}

\begin{definition}[תבנית בילינארית סימטרית]
יהי
$V$
מרחב מכפלה פנימית ותהי
$f$
תבנית בילינארית על
$V$.
נגיד כי
$f$
\emph{סימטרית}
אם
$f\prs{u,v} = f\prs{v,u}$
לכל
$u,v \in V$.
\end{definition}

\begin{definition}
יהי
$V$
מרחב מכפלה פנימית ותהי
$f$
תבנית בילינארית על
$V$.
נגיד כי
$f$
\emph{מוגדרת חיובית לחלוטין}
אם
$f\prs{u,u} > 0$
לכל
$u \in V$.

נגדיר באופן דומה תבנית מוגדרת שלילית לחלוטין%
\slash%
אי־שלילית%
\slash%
אי־חיובית.
\end{definition}

\begin{exercisechap}
תהיינה
$A,B,P \in \Mat_n\prs{\mbb{R}}$
כאשר
$P$
הפיכה ומתקיים
$B = P^t A P$.

הוכיחו או הפריכו את הטענות הבאות.
\begin{enumerate}
\item $\det\prs{A} = \det\prs{B}$.
\item ל־%
$A,B$
יש אותם ערכים עצמיים.
\item $\rank\prs{A} = \rank\prs{B}$.
\item $A$
הפיכה אם ורק אם
$B$
הפיכה, וכאשר זה מתקיים
$A^{-1}, B^{-1}$
חופפות.
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
\item מתקיים
\[\det\prs{B} = \det\prs{P^t A P} = \det\prs{P^t} \det\prs{A} \det\prs{P}\]
ולכן יש שוויון אם ורק אם
$\det\prs{P^t} \det\prs{P} = 1$.
אבל,
$\det\prs{P^t} = \det\prs{P}$
ולכן זה מתקיים אם ורק אם
$\det\prs{P} \in \set{\pm 1}$.
זה לא חייב להיות המצב. למשל, נוכל לקחת
$A = I_n, B = 4I_n, P = 2I_n$.

\item הדוגמא הקודמת מראה שהערכים העצמיים לא נשמרים.

\item הדרגה נשמרת כי
$P^t, P$
הפיכות.

\item נניח כי
$A$
הפיכה. אז
$B$
הפיכה כי הדרגות שלהן שוות.
נשים לב כי
\[B^{-1} = \prs{P^t A P}^{-1} = P^{-1} A^{-1} \prs{P^t}^{-1}\]
ועבור
$\tilde{P} = \prs{P^t}^{-1}$
נקבל
$B^{-1} = \tilde{P}^t A^{-1} \tilde{P}$.
\end{enumerate}
\end{solution}

\begin{exercisechap}
תהי
\begin{align*}
    g\prs{v,w} = v_1 w_1 - v_2 w_2
\end{align*}
תבנית בילינארית על
$V \coloneqq \mbb{R}^2$.

\begin{enumerate}
    \item מיצאו את כל האיזומטריות
    של התבנית
    $g$.
    כלומר, מיצאו כל
    $T \in \End_{\mbb{R}}\prs{V}$
    עבורן
    $f\prs{T\prs{v}, T\prs{w}} = f\prs{v,w}$.
    
    \item התבנית
    $g$
    אינה חיובית, ולכן אין לנו מושג של אורך. אבל, עדיין אפשר להסתכל על
    $g\prs{v,v}$
    ולחשוב עליו כאנלוגי לריבוע של האורך.
    מיצאו את כל הוקטורים
    $v \in V$
    עבורם
    $g\prs{v,v} = 1$.
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
    \item
    תהי
    $T \in \End_{\mbb{R}}\prs{V}$
    איזומטריה של
    $g$
    ונכתוב
    $\brs{T}_E = \pmat{a & b \\ c & d}$.
    אז
    \begin{align*}
        a^2 - c^2 &= g\prs{\pmat{a\\c}, \pmat{a\\c}} = g\prs{T\prs{e_1}, T\prs{e_1}} = g\prs{e_1, e_1} = 1 \\
        b^2 - d^2 &= g\prs{\pmat{b\\d}, \pmat{b\\d}} = g\prs{T\prs{e_2}, T\prs{e_2}} = g\prs{e_2, e_2} = -1 \\
        \text{.} ab - cd &= g\prs{\pmat{a\\c}, \pmat{b\\d}} = g\prs{T\prs{e_1}, T\prs{e_2}} = g\prs{e_1, e_2} = 0
    \end{align*}
    עבור
    \begin{align*}
        \sinh\prs{x} \coloneqq \frac{e^x - e^{-x}}{2} \\
        \text{,}\cosh\prs{x} \coloneqq \frac{e^x + e^{-x}}{2}
    \end{align*}
    ידוע שמתקיים
    $\cosh^2\prs{x} - \sinh^2\prs{x} = 1$.
    כיוון ש־%
    $\sinh, \cosh$
    פונקציות על, נוכל לכתוב
    $a = \cosh\prs{\theta}$
    ואז
    $c = \sinh\prs{\theta}$.
    באותו אופן,
    $b = \cosh\prs{\rho}$
    ואז
    $d = -\sin\prs{\rho}$.
    אז מהמשוואה השלישית ניתן לבדוק כי בהכרח
    $\rho = \theta$
    ולכן מתקיים
    \[\text{.} \brs{T}_E = \pmat{\cosh\prs{\theta} & -\sinh\prs{\theta} \\ \sinh\prs{\theta} & \cosh\prs{\theta}}\]
    
    \item עבור
    $v \in V$
    מתקיים
    $g\prs{v,v} = 1$
    אם ורק אם
    $v_1^2 - v_2^2 = 1$
    אם ורק אם
    $v_2 = \pm \sqrt{v_1^2 - 1}$.
    הפתרונות
    $\pmat{v_1 \\ v_2}$
    יהוו היפרבולה במישור.
\end{enumerate}
\end{solution}

\pagebreak

\begin{exercisechap}
\begin{enumerate}
    \item תהי
\[\text{.} A = \pmat{2 & 1 & 2 \\ 1 & 2 & 1 \\ 2 & 1 & 2} \in \Mat_3\prs{\mbb{Z}/5\mbb{Z}}\]
מיצאו מטריצה
$P \in \Mat_3\prs{\mbb{Z}/5\mbb{Z}}$
הפיכה
עבורה
$P^t A P$
אלכסונית.

\item האם יכולנו לקחת מטריצה
$P'$
אחרת שתיתן תשובה מתאימה?

\item האם יש מטריצה
$Q \in \Mat_3\prs{\mbb{Z}/5\mbb{Z}}$
הפיכה עבורה
$Q^t A Q = I_3$?

\item האם יש מטריצה
$Q \in \Mat_3\prs{\mbb{Z}/5}$
הפיכה עבורה
$Q^t B Q = I_3$
כאשר
$B = \pmat{2 & 1 & 2 \\ 1 & 1 & 0 \\ 2 & 0 & 1}$?
\end{enumerate}
\end{exercisechap}

\begin{solution}
\begin{enumerate}
    \item 
ניזכר שמטריצה הפיכה
$P$
הינה כפל של מטריצות אלמנטריות. כפל משמאל במטריצה אלמנטרית
$E$
מתאים לפעולת דירוג על השורות, וכפל ב־%
$E^t$
מתאים לפעולת דירוג זהה על העמודות.

לכן, ננסה לדרג את
$A$
למטריצה אלכסונית כאשר בכל שלב נבצע פעולת דירוג שורה ולאחריה פעולת דירוג עמודה מתאימה.

נעשה זאת.

\begin{align*}
    A &= \pmat{2 & 1 & 2 \\ 1 & 2 & 1 \\ 2 & 1 & 2}
    \\&\xrightarrow{R_2 \mapsto R_2 + 2 R_1}
    \pmat{2 & 1 & 2 \\ 0 & 4 & 0 \\ 2 & 1 & 2}
    \\&\xrightarrow{C_2 \mapsto C_2 + 2 C_1}
    \pmat{2 & 0 & 2 \\ 0 & 4 & 0 \\ 2 & 0 & 2}
    \\&\xrightarrow{R_3 \mapsto R_3 - R_1}
    \pmat{2 & 0 & 2 \\ 0 & 4 & 0 \\ 0 & 0 & 0}
    \\&\xrightarrow{C_3 \mapsto C_3 - C_1}
    \pmat{2 & 0 & 0 \\ 0 & 4 & 0 \\ 0 & 0 & 0}
\end{align*}

נקבל כי
\[P^t = \pmat{1 & 0 & 0 \\ 0 & 1 & 0 \\ -1 & 0 & 1} \pmat{1 & 0 & 0 \\ 2 & 1 & 0 \\ 0 & 0 & 1} = \pmat{1 & 0 & 0 \\ 2 & 1 & 0 \\ -1 & 0 & 1}\]
מקיימת את הנדרש, ולכן ניקח
\[\text{.} P = \pmat{1 & 2 & -1 \\ 0 & 1 & 0 \\ 0 & 0 & 1}\]

\item כן. למשל, יכולנו קודם להחליף את השורות הראשונה והשלישית, ולקבל
\[\prs{P'}^t = P^t \pmat{0 & 0 & 1 \\ 0 & 1 & 0 \\ 1 & 0 & 0} = \pmat{-1 & 0 & 1 \\ 2 & 1 & 0 \\ 1 & 0 & 0} \neq P^t\]
ואז
$P' \neq P$.

\item קיבלנו
$P^t A P = \diag\prs{2,4,0}$
וזאת אינה מטריצה מדרגה מלאה. דרגה נשמרת תחת חפיפת מטריצות, ולכן לא יתכן שיש
$Q$
כנדרש.

\item ננסה דירוג לפי שורה ועמודה.
\begin{align*}
    B &= \pmat{2 & 1 & 2 \\ 1 & 1 & 0 \\ 2 & 0 & 1}
    \\&\xrightarrow{R_3 \mapsto R_3 - R_1}
    \pmat{2 & 1 & 2 \\ 1 & 1 & 0 \\ 0 & 4 & 4}
    \\&\xrightarrow{C_3 \mapsto C_3 - C_1}
    \pmat{2 & 1 & 0 \\ 1 & 1 & 4 \\ 0 & 4 & 4}
    \\&\xrightarrow{R_2 \mapsto R_2 + 2 R_1}
    \pmat{2 & 1 & 0 \\ 0 & 3 & 4 \\ 0 & 4 & 4}
    \\&\xrightarrow{C_2 \mapsto C_2 + 2 C_1}
    \pmat{2 & 0 & 0 \\ 0 & 3 & 4 \\ 0 & 4 & 4}
    \\&\xrightarrow{R_3 \mapsto R_3 + 2 R_2}
    \pmat{2 & 0 & 0 \\ 0 & 3 & 4 \\ 0 & 0 & 2}
    \\&\xrightarrow{C_3 \mapsto C_3 + 2 C_2}
    \pmat{2 & 0 & 0 \\ 0 & 3 & 0 \\ 0 & 0 & 2}
\end{align*}
כעת, נוכל לחלק איברים על האלכסון רק בריבוע, כיוון שיש לכפול גם את השורה וגם את העמודה באותו מספר. כיוון ש־%
$3$
אינו ריבוע ב־%
$\mbb{Z}/5\mbb{Z}$
לא נוכל לקבל ככה את מטריצת היחידה.
גם, הדטרמיננטה של המטריצה שקיבלנו היא
$2 \cdot 3 \cdot 2 \equiv 2$.
הדטרמיננטה של מטריצות חופפות נבדלת בכפל בריבוע, אך לא יתכן
$2 = a^2 \det\prs{I_3} = a^2$
כי
$2$
אינו ריבוע.

השיטה הזאת לא עובדת תמיד. יתכן מצב בו מטריצה אינה חופפת ליחידה אך כן בעלת דטרמיננטה שהינה ריבוע.
למשל, המטריצה
$\pmat{0 & 1 \\ 1 & 0} \in \Mat_3\prs{\mbb{Z}/5\mbb{Z}}$
כזאת.
\end{enumerate}
\end{solution}

\printbibliography
\end{document}
